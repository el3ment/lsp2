if(!window.NETSUITE_IS_LOADED){var isIE9=!1,isIE10=!1,isIE11=!1;function debugAlert(e){}function debugStartTimer(){}function debugGetTime(){}(function(e){var t=e.document,n=e.location,r=e.navigator,i=e.NS||{};e.NS=i,i.Core=function(){var i=0;return{getWindow:function(){return e},getDocument:function(){return t},getLocation:function(){return n},getNavigator:function(){return r},isUndefined:function(e){return typeof e=="undefined"},getURLParameter:function(e){var t=(new RegExp("[?&]"+e+"=([^&]*)")).exec(n.search);return t!=null?decodeURIComponent(t[1]):null},getUniqueId:function(){return++i}}}(),i.event=function(){function t(e,t){this.name=e,this.fn=t}function n(e,t,n){this.fn=e,this.condition=t,this.scope=n}function r(t,r,s,o,u){var a,f;e[t]||(e[t]={}),a=e[t],o=o||i.Core.getWindow(),r.nsEventGuid=r.nsEventGuid||i.Core.getUniqueId(),f=r,u&&(r=function(){delete a[r.nsEventGuid],f.apply(this,arguments)},r.nsEventGuid=f.nsEventGuid),a[r.nsEventGuid]=new n(r,s,o)}function s(e,n,r){return function(){var i=new t(e,n.fn);(!n.condition||n.condition.call(n.scope,i,r))&&n.fn.call(n.scope,i,r)}}function o(){return undefined}var e={};return{bind:function(e,t,n){r(e,t,null,n,!1)},once:function(e,t,n,i){r(e,t,n,i,!0)},dispatch:function(t,n,r,i){var u,a,f,l,c,h=0,p=0,d=0;if(e[t]){a=e[t],d=Object.keys(a).length;for(u in a)a.hasOwnProperty(u)&&(f=a[u],l=s(t,f,n),c=function(e){return function(){h++,h===d&&setTimeout(function(){var e=(p===d?r:i)||o;e()},0),e(),p++}}(l),setTimeout(c,0))}d===0&&r&&setTimeout(r,0)},dispatchImmediate:function(t,n,r,i){var o,u,a,f,l=!1;if(e[t]){u=e[t];for(o in u)if(u.hasOwnProperty(o))try{a=u[o],f=s(t,a,n),f()}catch(c){l=!0,console&&console.log(c)}}!l&&r?r():l&&i&&i()},unbind:function(t,n){n.nsEventGuid&&e[t]&&delete e[t][n.nsEventGuid]}}}(),i.event.type={FORM_INITED:"formInited",FORM_CHANGED:"formChanged",FORM_VALID:"formValid",PAGE_INIT_FINISHED:"pageInitFinished",FIELD_CHANGED:"fieldChanged"},i.form=function(){return i.Core.getWindow().ischanged=!1,i.Core.getWindow().isvalid=!0,{isInited:function(){return i.Core.getWindow().isinited===!0},setInited:function(e){typeof e=="boolean"&&this.isInited()!==e&&(i.Core.getWindow().isinited=e,i.event.dispatch(i.event.type.FORM_INITED,{value:e}))},isChanged:function(){return i.Core.getWindow().ischanged},setChanged:function(e){typeof e=="boolean"&&this.isChanged()!==e&&(i.Core.getWindow().ischanged=e,i.event.dispatch(i.event.type.FORM_CHANGED,{value:e}))},isValid:function(){return i.Core.getWindow().isvalid},setValid:function(e){typeof e=="boolean"&&this.isValid()!==e&&(i.Core.getWindow().isvalid=e,i.event.dispatch(i.event.type.FORM_VALID,{value:e}))},isEditMode:function(){return i.Core.getURLParameter("e")=="T"},isViewMode:function(){var e=i.Core.getURLParameter("id")||"-1";return!this.isEditMode()&&e!="-1"},isNewMode:function(){var e=i.Core.getURLParameter("id")||"-1";return!this.isEditMode()&&e=="-1"}}}()})(this),NS.Logger={debugValue:!1},Array.prototype.push||(Array.prototype.push=function(){var e=this.length;for(var t=0;t<arguments.length;t++)this[e+t]=arguments[t];return this.length});try{parentAccesible=typeof parent.encode!="undefined"}catch(e){parentAccesible=!1}function encode(e){return escape(e).replace(/\+/g,"%2B")}function alphafirst(e){var t=new RegExp("([A-Za-z].*)");return t.exec(e)!=null&&RegExp.$1==e}function stacktrace(){var e="stacktrace: ";for(var t=arguments.callee.caller;t!=null;t=t.caller){e+=getFuncName(t),e+=getFuncArgs(t)+"\n\n";if(t.caller==t)break}return e}function getFuncArgs(e){s="arguments: {";for(i=0;i<e.arguments.length;i++)typeof e.arguments[i]=="undefined"?s+="'undefined'":e.arguments[i]==null?s+="null":typeof e.arguments[i]=="string"?s+="'"+e.arguments[i].toString()+"'":s+=e.arguments[i].toString(),i<e.arguments.length-1&&(s+=",");return s+="}",s}function getFuncName(e){var t=e.toString();return t.indexOf("anonymous")>=0?t.length>100?t.substr(0,100)+"\n":t+"\n":(t=t.match(/function[^{]*/),t!==null&&(t=t[0]),t==null||t.length==0?"anonymous \n":t)}function scrollDiv(){document.getElementById("div__label")&&(document.getElementById("div__label").scrollLeft=document.getElementById("div__body").scrollLeft)}function getVisibleWindowHeight(){var e=window.parentAccesible&&typeof parent!="undefined"&&typeof parent.Ext!="undefined"&&parent.Ext.WindowMgr.getActive()!=null;return e?parent.Ext.WindowMgr.getActive().body.dom.contentWindow.innerHeight:jQuery(window).height()}function getDocumentClientHeight(){var e=window.parentAccesible&&typeof parent!="undefined"&&typeof parent.Ext!="undefined"&&parent.Ext.WindowMgr.getActive()!=null;return e?parent.Ext.WindowMgr.getActive().body.dom.contentWindow.innerHeight:window.innerHeight}function getDocumentClientWidth(){var e=window.parentAccesible&&typeof parent!="undefined"&&typeof parent.Ext!="undefined"&&parent.Ext.WindowMgr.getActive()!=null;return e?parent.Ext.WindowMgr.getActive().body.dom.contentWindow.innerWidth:window.innerWidth}function getDocumentHeight(){return window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientHeight!=0?document.documentElement.clientHeight:document.body.clientHeight}function getDocumentWidth(){return window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth&&document.documentElement.clientWidth!=0?document.documentElement.clientWidth:document.body.clientWidth}function getWindowPageXOffset(){return window.pageXOffset!==undefined?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function getWindowPageYOffset(){return window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}function getElementContentWidth(e){return e.offsetWidth-getRuntimeSize(e,"paddingLeft")-getRuntimeSize(e,"paddingRight")-getRuntimeSize(e,"borderLeftWidth")-getRuntimeSize(e,"borderRightWidth")-getRuntimeSize(e,"marginLeft")-getRuntimeSize(e,"marginRight")}function getElementContentHeight(e){return e.offsetHeight-getRuntimeSize(e,"paddingTop")-getRuntimeSize(e,"paddingBottom")-getRuntimeSize(e,"borderTopWidth")-getRuntimeSize(e,"borderBottomWidth")-getRuntimeSize(e,"marginTop")-getRuntimeSize(e,"marginBottom")}var ieDiffWidth=0,ieDiffHeight=0;function initOuter(){var e,t,n,r,i,s,o=800,u=600;document.all&&(n=document.body.offsetWidth,r=document.body.offsetHeight,window.resizeTo(o,u),i=document.body.offsetWidth-n,s=document.body.offsetHeight-r,e=o-i,t=u-s,ieDiffWidth=e-n,ieDiffHeight=t-r,window.resizeTo(e,t))}function outerWd(){return document.all?(ieDiffHeight==0&&initOuter(),document.body.offsetWidth+ieDiffWidth):window.outerWidth}function outerHt(){return document.all?(ieDiffHeight==0&&initOuter(),document.body.offsetHeight+ieDiffHeight):window.outerHeight}function onBeforePrint(){var e=document.getElementById("div__label");e!=null&&(e.style.width=null,e.style.height=null),e=document.getElementById("div__body"),e!=null&&(e.style.width=null,e.style.height=null),document.body.scroll="auto"}function onAfterPrint(){document.getElementById("resetdivwascalled")!=null&&resetDivSizes()}window.onbeforeprint=onBeforePrint,window.onafterprint=onAfterPrint;function getNavTreePaneDivID(){return"div__nav_tree"}function resetDivSizes(){if(typeof ignoreResetDivSizes!="undefined"&&ignoreResetDivSizes)return;if(document.getElementById("resetdivwascalled")==null){var e=document.createElement("input");e.type="hidden",e.value="T",e.id="resetdivwascalled",document.body.appendChild(e)}var t=document.getElementById("div__header"),n=document.getElementById("div__title"),r=document.getElementById("div__banner"),i=document.getElementById("div__alert"),s=document.getElementById("div__prelabel"),o=document.getElementById("div__label"),u=document.getElementById("div__body"),a=document.getElementById("div__nav"),f=document.getElementById("div__footer"),l=0,c=jQuery(".pt_container").get(0);c&&(l+=getHeight(c)+30);var h=0,p=jQuery(".uir_control_bar").get(0);p&&(l+=getHeight(p)+25);var d=document.getElementById("bannerContainer"),v=getHeight(d);v>0&&(v+=5);if(u==null)return;document.body.style.overflowY="hidden";if(f!=null){var m=f.childNodes;for(var g=0;g<m.length;g++){var y=m[g];if(y.tagName=="TABLE"){document.body.style.overflow=y.scrollWidth>document.body.clientWidth?"-moz-scrollbars-horizontal":"-moz-scrollbars-none";break}}}var b=getDocumentHeight()-10;b-=v+getHeight(t)+getHeight(f)+getHeight(n)+getHeight(r)+getHeight(s)+getHeight(o)+getHeight(i)+25+l,u.style.height=(b>0?b:0)+"px",u.clientWidth;var w=getDocumentWidth(),E=document.getElementById("_rptdata");if(a!=null){u.style.height=(b-u.offsetTop>0?b-u.offsetTop:0)+"px";var S=document.getElementById("div__nav_tree");S&&(S.style.height=(b-S.offsetTop>0?b-S.offsetTop:0)+"px"),E&&(w-=a.offsetWidth);var x=a.parentNode,T=0;while(x!=null){if(x.getAttribute("cellspacing")){T=x.getAttribute("cellspacing");break}x=x.parentNode}w-=4*T}u.style.width=Math.max(w-18,0)+"px",b=getDocumentHeight()-10,b-=v+getHeight(t)+getHeight(f)+getHeight(n)+getHeight(r)+getHeight(s)+getHeight(o)+getHeight(i)+25+l,u.style.height=(b>0?b:0)+"px";if(a!=null){u.style.height=(b-u.offsetTop>0?b-u.offsetTop:0)+"px";var S=document.getElementById("div__nav_tree");S&&(S.style.height=(b-S.offsetTop>0?b-S.offsetTop:0)+"px")}o!=null&&(o.style.width=u.clientWidth+"px",o.style.left=-document.getElementById("div__body").scrollLeft+"px");if(E){var N=document.getElementById("div__labtab");N.style.width=E.clientWidth+"px"}var C=!0,k,L;for(var g=0;g==0||document.getElementById("div__labcol"+g)!=null;g++){var A=document.getElementById("div__labcol"+g),O=document.getElementById("div__lab"+g);if(O!=null){var M=A.offsetWidth;C&&M>0&&(C=!1,M--),M>0&&(k=O,L=M),O.tagName=="TD"?O.style.width=M+"px":O.offsetParent.style.width=M+"px"}}k&&L>0&&(k.style.width=L-1+"px"),makeVisible(o),makeVisible(u),makeVisible(f);var _=document.getElementById("div__labend");_&&(_.style.width=u.offsetWidth-u.clientWidth+"px",o&&(_.style.height=o.offsetHeight+"px"),_.style.left=u.clientWidth-1+"px"),hideInvisibleRows()}function hideInvisibleRows(){var e=document.getElementById("squeezeBox");if(e==null)return;var t=e.getElementsByTagName("tr"),n=0;for(var r=0;r<t.length;r++)t[r].className=="labelRow"&&isValEmpty(t[r].getAttribute("squeezeBox"))&&(n+=t[r].offsetHeight+1,t[r].setAttribute("squeezeBox","T"));n>0&&(e.style.overflow="hidden",e.style.height=e.offsetHeight-n+(isIE?0:28)+"px")}function resizePopupWindow(){var e=document.getElementById("div__body");if(e==null)return;var t=getDocumentWidth()-10,n=getMaxContentWidth(e.getElementsByTagName("span")),r=getMaxContentWidth(e.getElementsByTagName("div")),i=Math.max(e.scrollWidth,Math.max(n,r));i>t&&window.resizeBy(i-t,0)}function getMaxContentWidth(e){var t=0;for(i=0;i<e.length;i++)e[i].scrollWidth>t&&(t=e[i].scrollWidth);return t}function getHeight(e){return e==null?0:e.offsetHeight?e.offsetHeight:0}function makeVisible(e){e!=null&&(e.style.visibility="visible")}function visible(e,t){e!=null&&(e.style.visibility=t?"inherit":"hidden")}function endsWith(e,t){return e!=null&&t!=null&&e.length>=t.length&&e.substr(e.length-t.length)==t}function checkzipcode(e,t){var n=e.value,r=t?6:5;return!onlydigits(e)||n.length!=r?(t?alert("Please enter a valid "+r+" digit Postal Code."):alert("Please enter a valid "+r+" digit Zip Code."),!1):!0}function splitIntoRows(e){return e!=null?e.length>0?e.split(String.fromCharCode(2)):new Array:null}function splitIntoCells(e){return e!=null?typeof e=="string"?e.split(String.fromCharCode(1)):e:null}function isempty(e,t){var n=e.value;return isValEmpty(n,t)}function checknotempty(e,t){if(!checkvalnotempty(e.value,"Please enter a value for {1}".replace("{1}",t))){try{e.focus(),e.select()}catch(n){}return!1}return!0}function amount_string(e){var t=Math.floor((e-Math.floor(e))*100+.5),n=t<10?"0"+t.toString():t.toString(),r=dollars_string(Math.floor(e));return r.charAt(0).toUpperCase()+r.substr(1)+"and "+n+"/100"}function format_rate(e,t){var n;if(isNaN(parseFloat(e)))n="";else{var r=get_precision();if(r>1||t){var i=e<0;i&&(e=-e);var s=Math.floor(e),o=Math.floor((e-s)*(t?10:100)+.5);if(e==s+o/(t?10:100)){o==(t?10:100)&&(s++,o=0);var u=t?o.toString():o<10?"0"+o.toString():o.toString();n=(i?"-":"")+s.toString()+"."+u+(t?"%":"")}else n=(i?"-":"")+e+(t?"%":"")}else if(r==1){var i=e<0;i&&(e=-e);var u=e.toString(),a=u.indexOf(".");a==-1?u=u.toString()+".0":a==0?u="0."+u.toString():a==u.length-1&&(u=u.toString()+"0"),n=(i?"-":"")+u}else if(r==0){var i=e<0;i&&(e=-e);var u=e.toString(),a=u.indexOf(".");a==0?u="0."+u.toString():a==u.length-1&&(u=u.substring(0,u.length-2)),n=(i?"-":"")+u}}return n}function get_precision(){var e=getFormElementViaFormName("main_form","currencyprecision"),t=2;if(e!=null){var n=parseFloat(e.value);isNaN(n)||(t=n)}return t}function round_currency(e,t,n){var r=t;r==null&&(r=get_precision());var i=e+"";if(e>1e10&&i.indexOf(".")>=0&&i.length-i.indexOf(".")-1<=r)return e;var s=Math.abs(e);return s=Math.floor(s*1e5+.5)/1e5+1e-6,factor=Math.pow(10,r),n==null||n=="OFF"?s=Math.floor(s*factor+.5)/factor:n=="UP"?s=Math.round(Math.ceil(Math.abs(e)*factor))/factor:n=="DOWN"&&(s=Math.round(Math.floor(Math.abs(e)*factor))/factor),s*=e>=0?1:-1,s==0?0:s}function round_float(e){return round_float_to_n_places(e,8)}function round_float_to_n_places(e,t){var n=e+"";if(n.indexOf(".")<0)return e;if(n.length-n.indexOf(".")-1<=t)return e;var r=Math.abs(e);r+=1e-14;var i=Math.pow(10,t);return r=Math.floor(r*i+.5)/i,r*=e>=0?1:-1,r==0?0:r}function pad_to_atleast_two_decimal_places(e){var t;if(e==null)t="";else{t=e.toString();var n=t.indexOf(".");n==-1?t+=".00":n==t.length-1?t+="00":n==t.length-2&&(t+="0"),n==0&&(t="0"+t)}return t}function pad_decimal_places(e,t){var n;if(e==null)n="";else{n=e.toString();var r=n.indexOf(".");t==0?e==0?n=0:r>-1&&(n=n.substring(0,r)):t==1?r==-1?n+=".0":r==n.length-1?n+="0":r==0&&(n="0"+n):(r==-1?n+=".00":r==n.length-1?n+="00":r==n.length-2&&(n+="0"),r==0&&(n="0"+n))}return n}function format_currency(e,t){if(isNaN(e))return"";var n=getFormElementViaFormName("main_form","currencyprecision"),r=2;n!=null&&(r=parseFloat(n.value),isNaN(r)&&(r=2));var i;return t!=1?i=round_currency(e,r):i=e,i=pad_decimal_places(i,r),i}function format_currency2(e){if(isNaN(e))return"";var t;(e+"").indexOf(".")<0?t=e:t=round_float_to_n_places(e,8);var n=get_precision();return n==2&&(t=pad_to_atleast_two_decimal_places(t)),t}function format_percent(e){return typeof e=="string"&&(e=parseFloat(e)),e+(e==Math.floor(e)?".0%":"%")}function process_currency_field_value(e,t){if(t==null||t.indexOf("currency")==-1)return e;if(isValEmpty(e)||(""+e).indexOf(".")!=-1||isNaN(parseFloat(e)))return e;var n=t.indexOf("currency2")>=0?2:get_precision();return pad_decimal_places(""+e,n)}function parseCJKNumbers(e){var t=e.value;if(t==null)return null;var n=/[\uff01-\uff5e]/g,r=[],i,s=0;n.lastIndex=0;while((i=n.exec(t))!=null)i.index>s&&r.push(t.substring(s,i.index)),s=n.lastIndex,r.push(String.fromCharCode(i[0].charCodeAt(0)-65248));return s==0?t:(s<t.length&&r.push(t.substring(s)),r.join(""))}function validate_textfield_maxlen(e,t,n,r){if(e.value==null||e.value.length==0)return NS.form.setValid(!0),!0;var i=!0,s=null;if(r){var o=e.value.replace(/\r/g,"").replace(/\n/g,"\n ").length;o>t&&(n&&alert("You have exceeded the "+t+" character limit for this field. Please shorten your entry by "+(o-t)+" characters."),s=getIndexForSelection(e.value,t))}else{var u=analyzeUTF8(e.value,t);u&&(n&&alert("You have exceeded the length limit for this field. Please shorten your entry by "+u+" characters."),s=UTF8toUTF16index(e.value,t))}return s&&(window.focusedTextArea=e,setTimeout("try { setSelectionRange(window.focusedTextArea, "+s+", "+e.value.length+"); } catch (e) {}",0),i=!1),NS.form.setValid(i),i}function getIndexForSelection(e,t){var n=e.replace(/\r/g,""),r=0;for(var i=0;i<n.length;++i){var s=n.charCodeAt(i);s==10&&r++,r++;if(r>t)return i}return 0}function truncateStringInUnicode(e,t){var n=0,r=128,i=2048,s="";for(var o=0;o<e.length;o++){var u=e.charCodeAt(o);u<r?n+=1:u>=r&&u<i?n+=2:u>=i&&(n+=3),n<t&&(s+=e.charAt(o))}return s}function UTF8toUTF16index(e,t){e=e.replace(/\r/g,"");var n=0,r=128,i=2048;for(var s=0;s<e.length;++s){var o=e.charCodeAt(s);o==10?n+=2:o<r?n+=1:o<i?n+=2:n+=3;if(n>t)return s}return 0}function lengthInUTF8Bytes(e){return encodeURIComponent(e.replace(/\r/g,"")).replace(/%0A/g,"UU").replace(/%[A-F\d]{2}/g,"U").length}function analyzeUTF8(e,t){var n=lengthInUTF8Bytes(e),r=n-t;if(r>0){var i=n/e.length;return Math.round(r/i)}return 0}function searchMonth(e,t){var n=e.toLowerCase(),r=new Array;t?r=["january","february","march","april","may","june","july","august","september","october","november","december"]:r=["jan","feb","march","april","may","june","july","aug","sept","oct","nov","dec"];var i=0;for(var s=0;s<r.length();s++){i=n.indexOf(r[s],0);if(i>=0){i+=r[s].length;while(e.charAt(i)==" ")i++;return i}}return-1}function getTimeStartIdx(e){var t=0,n=0;window.dateformat=="DD de MONTH de YYYY"?(n=e.lastIndexOf("de",0),t=2):window.dateformat=="DD MONTH, YYYY"?(n=e.indexOf(",",0),t=2):window.dateformat=="DD-MONTH-YYYY"?(n=e.lastIndexOf("-",0),t=1):window.dateformat=="DD MONTH YYYY"?(n=searchMonth(e,!0),t=1):window.dateformat=="DD. Mon YYYY"?(n=searchMonth(e,!1),t=1):window.dateformat=="YYYY년 MM월 DD?"?(n=0,t=3):(n=0,t=1);for(var r=0;r<t;++r){n=e.indexOf(" ",n+1);if(n<0)break}return n}function extract_date_time(e,t){var n=new Array,r=trim(e),i=getTimeStartIdx(e);if(i>0){var s=r.substring(0,i),o=r.substring(i+1,r.length);return{validflag:!0,date:s,time:trim(o)}}return alert("Invalid date/time (miss spaces between date and time)"),{validflag:!1}}function validate_date(e,t){var n=NLDate_parseString(e,t),r;return n==null?r={validflag:!1}:r={validflag:!0,value:getdatestring(n)},r}function validate_time(e,t,n){var e=hhmmtotimestring(e),r;n?r=regexstringtotime(null,e,n):r=stringtotime(null,e);var i=!isNaN(r),s;return i?n?s=gettimewithsecondsstring(r,window.datetime_am_string,window.datetime_pm_string):s=gettimestring(r,window.datetime_am_string,window.datetime_pm_string):t&&alert("Invalid time value"),{validflag:i,value:s}}function validate_field(field,type,doalert,autoplace,minval,maxval,mandatory,separator){if(field.hasOwnProperty("validationLimit")){if(!(field.validationLimit>0))return!1;field.validationLimit--}NS.form.setValid(!1),type=type.toLowerCase();if(field.value==null||field.value.length==0)return mandatory?(doalert&&alert("Field must contain a value."),selectAndFocusField(field),NS.form.setValid(!1),!1):(NS.form.setValid(!0),!0);type!="text"&&type!="identifier"&&type!="identifieranycase"&&type!="address"&&type!="visiblepassword"&&!1&&(field.value=parseCJKNumbers(field));var validflag=!0;if(type=="url"){var val=trim(field.value.toLowerCase());val.indexOf("/")!=0&&val.indexOf("http://")!=0&&val.indexOf("https://")!=0&&val.indexOf("ftp://")!=0&&val.indexOf("file://")!=0&&(val.indexOf("://")!=-1?(doalert&&alert("Invalid url. Url must start with http://, https://, ftp://, or file://"),validflag=!1):field.value="http://"+trim(field.value));if(val.indexOf(" ")>0||val.indexOf("	")>0)doalert&&alert("Invalid url. Spaces are not allowed in the URL"),validflag=!1}else if(type=="currency"||type=="currency2"||type=="poscurrency"){var val=field.value.replace(/$/g,"");val=val.toLowerCase(),val.charAt(0)=="="?val=val.substr(1):val.substr(1).search(/[\+\-\*\/]/g)==-1&&(val=NLStringToNumber(val,!0)+"");if(val.substr(1).search(/[\+\-\*\/]/g)!=-1){window.groupseparator&&window.decimalseparator&&(val=val.replace(new RegExp("\\"+window.groupseparator,"g"),"").replace(new RegExp("\\"+window.decimalseparator,"g"),"."));var c=val.charAt(0);if(val.charAt(0)>="a"&&val.charAt(0)<="z")value="error";else{try{val=eval(val)}catch(e){val="error"}autoplace=!1}}numval=parseFloat(val);var totalDigitCount=getTotalDigitCount(val);if(isNaN(numval))doalert&&alert("Invalid currency value. Values must be numbers up to 999,999,999,999,999.99"),validflag=!1;else if(maxval!=null&&!isNaN(maxval)&&Math.abs(numval)>=maxval){if(doalert){var regex=new RegExp("(-?[0-9]+)([0-9]{3})"),preDecimal=(maxval-1).toString();while(regex.test(preDecimal))preDecimal=preDecimal.replace(regex,"$1,$2");alert("Invalid currency value. Values must be numbers up to "+preDecimal+".999999999999999")}validflag=!1}(type=="poscurrency"||minval==0)&&numval<0&&(doalert&&alert("Invalid currency value. Value can not be negative."),validflag=!1),validflag&&(autoplace&&window.decimalseparator&&field.value.indexOf(window.decimalseparator)==-1&&(numval/=100),type=="currency"||type=="poscurrency"?val=format_currency(numval):val=format_currency2(numval),isNLNumericOrCurrencyDisplayField(field)&&(val=NLNumberToString(val)),field.value=val)}else if(type=="date"){var ret=validate_date(field.value,doalert);validflag=ret.validflag,validflag&&(field.value=ret.value)}else if(type=="mmyydate"){var value;try{value=parseMMYYDateString(field.value)}catch(e){}if(value!=null&&value.month>=1&&value.month<=12&&value.year>1900&&value.year<2100){var dDate=validateDate(new Date(value.year,value.month-1),doalert);dDate?(field.value=getmmyydatestring(dDate,NLDate_short_months),validflag=!0):validflag=!1}else{var fmterr="MMYY, MMYYYY, ";window.dateformat=="DD-Mon-YYYY"?fmterr+="Mon-YY, Mon-YYYY":window.dateformat=="DD.MM.YYYY"?fmterr+="MM.YY, MM.YYYY":fmterr+="MM/YY, MM/YYYY",doalert&&alert("Invalid date value (must be "+fmterr+")"),validflag=!1}}else if(type=="mmdddate"){var value;try{value=parseMMDDDateString(field.value)}catch(e){}if(value!=null&&value.month>=0&&value.month<=11&&value.day>=1&&value.day<=31){var dDate=validateDate(new Date(1970,value.month,value.day),doalert);dDate?validflag=!0:(validflag=!1,doalert&&alert("Please enter a valid Start Date in MM/DD format."))}else doalert&&alert("Invalid date value (must be MM/DD)"),validflag=!1}else if(type=="ccexpdate"||type=="ccvalidfrom"){validflag=!0;var m=0,y=0;if(field.value.indexOf("/")!=-1){var dToday=new Date,Y=dToday.getFullYear(),M=dToday.getMonth()+1;Y<=999&&(Y+=1900);var c=field.value.split("/");onlydigits(c[0])&&(m=parseInt(c[0],10)),onlydigits(c[1])&&(y=parseInt(c[1],10)),m<1?m=1:m>12&&(m=12),y<100&&(y+=y>=70?1900:2e3),(type=="ccexpdate"&&(y<Y||y==Y&&m<M)||type=="ccvalidfrom"&&(y>Y||y==Y&&m>M))&&doalert&&alert("Notice: The credit card appears to be incorrect"),field.value=(m<10?"0":"")+m+"/"+y}else doalert&&(type=="ccexpdate"?alert("Please enter an expiration date in MM/YYYY format"):alert("Please enter a Valid From / Start Date in MM/YYYY format")),validflag=!1}else if(type=="ccnumber")validflag=field.value.length>4&&field.value.substring(0,field.value.length-4).replace(new RegExp("\\*","g"),"").length==0&&field.value.substring(field.value.length-4).replace(new RegExp("\\*","g"),"").length==4||checkccnumber(field);else if(type=="rate"||type=="ratehighprecision"){var numval,val=field.value,pctidx=val.lastIndexOf("%"),isPct=pctidx!=-1;isPct&&(val=val.substr(0,pctidx)),numval=NLStringToNumber(val,!0);if(isNaN(numval))doalert&&alert("Invalid number or percentage"),validflag=!1;else{autoplace&&!isPct&&val.indexOf(".")==-1&&(numval/=100);var numstr=format_rate(numval,isPct);if(isNLNumericOrCurrencyDisplayField(field)){numstr=NLNumberToString(numstr.replace("%",""));if(isPct&&numval<0&&numstr.indexOf("-")<0){var positiveNumberStr=NLNumberToString(format_rate(-numval,isPct).replace("%",""));numstr=numstr.replace(positiveNumberStr,positiveNumberStr+"%")}else numstr+=isPct?"%":""}field.value=numstr,validflag=!0}}else if(type=="integer"||type=="posinteger"||type=="float"||type=="posfloat"||type=="nonnegfloat"||type=="percent"){var numval,custrange=!1;if(minval!=null||maxval!=null||type=="percent")custrange=!0;var minclip=minval==null?type=="percent"?0:-Math.pow(2,32):minval,maxclip=maxval==null?type=="percent"?100:Math.pow(2,64):maxval,val=field.value.replace(/$/g,"");val=val.replace(/%/g,""),numval=NLStringToNumber(val,!0);if(type=="integer")numval=parseInt(numval,10);else if(type=="posinteger")numval=parseInt(numval,10),minclip=0;else if(type=="posfloat"||type=="nonnegfloat"||type=="float")val.indexOf(".")!=-1&&(numval=round_float(numval)),type=="posfloat"&&(minclip=0),type=="nonnegfloat"&&(minclip=-Number.MIN_VALUE);if(isNaN(numval)||custrange&&(numval>maxclip||numval<minclip)||!custrange&&(numval>=maxclip||numval<=minclip))doalert&&(type=="percent"?alert("Invalid percentage (must be between "+minclip+" and "+maxclip+")"):custrange==1?minval==null?alert("Invalid number (must be at most "+maxclip+")"):maxval==null?alert("Invalid number (must be at least "+minclip+")"):alert("Invalid number (must be between "+minclip+" and "+maxclip+")"):type=="posinteger"||type=="posfloat"?alert("Invalid number (must be positive)"):type=="nonnegfloat"?alert("Invalid: Please enter a number greater than or equal to 0."):type=="integer"||type=="float"?isNaN(numval)?alert("You may only enter numbers into this field"):alert("Illegal number: "+numval):alert("Invalid number (must be greater than -4.29B")),validflag=!1;else{var numberStr=numval+"",isPct=type=="percent";isPct&&(numberStr=format_percent(numval));if(isNLNumericOrCurrencyDisplayField(field)){numberStr=NLNumberToString(numberStr.replace("%",""));if(isPct&&numval<0&&numberStr.indexOf("-")<0){var positiveNumberStr=NLNumberToString(format_percent(-numval).replace("%",""));numberStr=numberStr.replace(positiveNumberStr,positiveNumberStr+"%")}else numberStr+=isPct?"%":""}field.value=numberStr,validflag=!0}}else if(type=="address"){var err="";field.value.length>999&&(err="Address too long (truncated at 1000 characters)",newval=field.value.substr(0,999)),err!=""&&(doalert&&alert(err),field.value=newval)}else if(type=="function"){field.value.indexOf("(")>0&&(field.value=field.value.substr(0,field.value.indexOf("(")));var val=field.value,re=/^[0-9A-Za-z_]+(\.[0-9A-Za-z_]+)*$/;re.test(val)||(doalert&&alert("The Function field must be a valid JavaScript function identifier"),validflag=!1)}else if(type=="time"||type=="timetrack"){var hours,minutes,re=/([0-9][0-9]?)?(:[0-9][0-9]+)?/,result=re.exec(field.value);if(result==null||result.index>0||result[0].length!=field.value.length)timeval=parseFloat(field.value),isNaN(timeval)?hours=-1:(hours=Math.floor(timeval),minutes=Math.floor((timeval-hours)*60+.5));else{RegExp.$1.length>0?hours=parseInt(RegExp.$1,10):hours=0;if(typeof RegExp.$2!="undefined"&&RegExp.$2.length>0){minutes=parseInt(RegExp.$2.substr(1),10);if(minutes>=60){var hours_delta=Math.floor(minutes/60);minutes-=hours_delta*60,hours+=hours_delta}}else minutes=0}hours>=0&&minutes>=0&&minutes<60?(field.value=hours+":"+(minutes<10?"0":"")+minutes,validflag=!0):(doalert&&alert("Invalid time value (must be hh:mm)"),validflag=!1)}else if(type=="timeofday"){var ret=validate_time(field.value,doalert,!1);validflag=ret.validflag,validflag&&(field.value=ret.value)}else if(type=="datetimetz"){var ret_date_time=extract_date_time(field.value,doalert);validflag=ret_date_time.validflag;if(validflag){var ret_date=validate_date(ret_date_time.date,doalert);validflag=ret_date.validflag;if(validflag){var ret_time=validate_time(ret_date_time.time,doalert,!0);validflag=ret_time.validflag,validflag&&(field.value=ret_date.value+"  "+ret_time.value)}}}else if(type=="visiblepassword")validflag=checkpassword(field.value,field.value,doalert);else if(type=="email")validflag=checkemail(field.value,!0,doalert);else if(type=="emails"){var bademails=new Array,validcount=0;separator||(separator=/[,;]/);var emails=field.value.split(separator);for(var j=0;j<emails.length;j++){var semail=trim(emails[j]);semail&&(checkemailvalue(semail,!1)?validcount+=1:bademails.push(emails[j]))}bademails.length>0?(validflag=!1,doalert&&alert("Invalid email(s) found: "+bademails.join("; "))):validcount<1&&(validflag=!1,doalert&&alert('No valid emails found in "'+field.value+'"'))}else if(type=="printerOffset"){var maxclip=2,minclip=-2,val=field.value;val=val.replace(/,/g,""),numval=parseFloat(val),isNaN(numval)||numval>=maxclip||numval<=minclip?(doalert&&(numval>=maxclip?alert("Invalid number (must be lower than "+maxclip+")."):numval<=minclip?alert("Invalid number (must be greater than "+minclip+")."):alert("Illegal number: "+numval)),validflag=!1):validflag=!0}else if(type=="metricPrinterOffset"){var maxclip=50,minclip=-50,val=field.value;val=val.replace(/,/g,""),numval=parseFloat(val),isNaN(numval)||numval>=maxclip||numval<=minclip?(doalert&&(numval>=maxclip?alert("Invalid number (must be lower than "+maxclip+")."):numval<=minclip?alert("Invalid number (must be greater than "+minclip+")."):alert("Illegal number: "+numval)),validflag=!1):validflag=!0}else if(type=="phone"||type=="fullphone"){var val=field.value;val.length!=0&&val.length<7&&(doalert&&alert("Phone number should have seven digits or more."),validflag=!1),validflag&&type=="fullphone"&&val.length!=0&&val.length<10&&(doalert&&alert("Please include the area code for phone number: "+val),validflag=!1);if(autoplace&&validflag){var extidx=val.search(/[A-Za-z]/),ext="";extidx>=0&&(ext=" "+val.substring(extidx),val=val.substring(0,extidx));var re=/^[0-9()-.\s]+$/;if(re.test(val)){var digits=val.replace(/[()-.\s]/g,""),phoneformat=window.phoneformat.replace(new RegExp("[360]","g"),String.fromCharCode(3));digits.length==7?field.value=phoneformat.replace(phoneformat.substring(0,phoneformat.indexOf("4")),"").replace("45"+String.fromCharCode(3),digits.substring(0,3)).replace("789"+String.fromCharCode(3),digits.substring(3))+ext:digits.length==10?field.value=phoneformat.replace("12"+String.fromCharCode(3),digits.substring(0,3)).replace("45"+String.fromCharCode(3),digits.substring(3,6)).replace("789"+String.fromCharCode(3),digits.substring(6))+ext:digits.length==11&&digits.substring(0,1)=="1"&&(field.value="1 "+phoneformat.replace("12"+String.fromCharCode(3),digits.substring(1,4)).replace("45"+String.fromCharCode(3),digits.substring(4,7)).replace("789"+String.fromCharCode(3),digits.substring(7))+ext)}}}else if(type=="color"){var val=field.value;val.substring(0,1)=="#"&&(val=val.substring(1));var re=/^[0-9ABCDEFabcdef]{6,}$/;val.length>6||!re.test(val)?(doalert&&alert("Color value must be 6 hexadecimal digits of the form: #RRGGBB.  Example: #FF0000 for red."),validflag=!1):field.value="#"+val}else if(type=="identifier"||type=="identifieranycase"){var val=field.value,re=/^[0-9A-Za-z_]+$/;re.test(val)?field.value=type=="identifier"?val.toLowerCase():val:(doalert&&alert('Identifiers can contain only digits, alphabetic characters, or "_" with no spaces'),validflag=!1)}else if(type=="application_id")validflag=/^([a-zA-Z][a-zA-Z0-9_]*)*$/.test(field.value),!validflag&&doalert&&alert('Application ID can contain only digits, alphabetic character or underscore "_" with no spaces. It should start with an alphabetic character.');else if(type=="package")validflag=/^([a-zA-Z][a-zA-Z0-9_]*)(\.([a-zA-Z0-9_]+))*$/.test(field.value),!validflag&&doalert&&alert('Package can contain only digits, alphabetic characters, underscore "_" or dot "." with no spaces. It should start with an alphabetic character and should not end with a dot.');else if(type=="furigana"){var val=field.value,re=/^[\u0020\u3000\u30A0-\u30FF\uFF61-\uFF9F]+$/;re.test(val)||(doalert&&alert("A non-katakana character has been entered."),validflag=!1)}else if(type=="urlcomponent"){var val=field.value.toLowerCase(),re=/^[a-z0-9\-]*$/;re.test(val)?field.value=val:(doalert&&alert("This field can contain only lower case letters, numbers and '-'."),validflag=!1)}return mandatory==1&&field.value.length==0&&(doalert&&alert("Field must contain a value."),validflag=!1),validflag?isNLNumericOrCurrencyDisplayField(field):selectAndFocusField(field),NS.form.setValid(validflag),validflag}function getTotalDigitCount(e){return e+="",e==""?0:(e=e.replace("-",""),e.indexOf(".")>0&&(e=e.replace(/0*?$/,"").replace(".","")),e.length)}function selectAndFocusField(e){if(isIE)try{e.focus(),e.select()}catch(t){}else setTimeout(function(){e.focus(),e.select()},50)}function validatePeriodRange(e,t){return getSelectIndex(t)<getSelectIndex(e)?(alert("Please enter a valid date range. The From date must precede the To date."),!1):!0}function setSelectionRange(e,t,n){if(e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(r){}}else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i.select()}}NLDate_months=["January","February","March","April","May","June","July","August","September","October","November","December"],NLDate_months.push(""),NLDate_short_months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],NLDate_short_months.push("");function nlGetFullYear(e){return window.navigator!=null&&window.navigator.appName=="Netscape"&&e.getFullYear=="undefined"?e.getYear():e.getFullYear()}function nlSetFullYear(e,t){window.navigator!=null&&window.navigator.appName=="Netscape"&&e.setFullYear=="undefined"&&e.setYear(t),e.setFullYear(t)}var year_char_cn="年",month_char_cn="月",day_char_cn="日",weekday=new Array(7);weekday[0]="Sunday",weekday[1]="Monday",weekday[2]="Tuesday",weekday[3]="Wednesday",weekday[4]="Thursday",weekday[5]="Friday",weekday[6]="Saturday";function getdatestring(e,t){var n;return typeof t!="undefined"?n=t:typeof window.dateformat!="undefined"?n=window.dateformat:n="MM/DD/YYYY",n=n.replace("YYYY",nlGetFullYear(e)),n=n.replace("MM",e.getMonth()+1),n=n.replace("DD",e.getDate()),n=n.replace(/month/i,NLDate_months[e.getMonth()]),n=n.replace(/mon/i,NLDate_short_months[e.getMonth()]),n.indexOf("EEYY")==0?n=n.replace("EEYY",get_japanese_imperial_era(e)+get_japanese_imperial_year(e)):n.indexOf("EYY")==0&&(n=n.replace("EYY",get_short_japanese_imperial_era(e)+get_japanese_imperial_year(e))),n}var heisei_start_date=new Date(1989,0,8),shouwa_start_date=new Date(1926,11,25),taishou_start_date=new Date(1912,6,30),meiji_start_date=new Date(1867,1,3);function get_japanese_imperial_era(e){return e>=heisei_start_date?"平成":e>=shouwa_start_date?"昭和":e>=taishou_start_date?"大正":"明治"}function get_short_japanese_imperial_era(e){return e>=heisei_start_date?"H":e>=shouwa_start_date?"S":e>=taishou_start_date?"D":"M"}function get_japanese_imperial_year(e){return e>=heisei_start_date?nlGetFullYear(e)-1988:e>=shouwa_start_date?nlGetFullYear(e)-1925:e>=taishou_start_date?nlGetFullYear(e)-1911:nlGetFullYear(e)-1867}function get_gregorian_year(e,t){return t=="平成"||t=="H"?e+1988:t=="昭和"||t=="S"?e+1925:t=="大正"||t=="D"?e+1911:e+1867}function getdefaultformatdatestring(e){return e.getMonth()+1+"/"+e.getDate()+"/"+nlGetFullYear(e)}function gettimestring(e,t,n){return gettimestringwithformat(e,t,n,window.timeformat)}function gettimestringwithformat(e,t,n,r){var i=e.getHours();typeof t=="undefined"&&(t=window.datetime_am_string,n=window.datetime_pm_string);var s=i<12?t:n;r.indexOf("HH24")<0&&(i%=12,i==0&&(i=12));var o=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),u=r;return u=u.replace("24",""),u=u.replace("fmHH",i),u=u.replace("fmMI",o),r.indexOf("HH24")<0&&(u=u.replace("am",s)),u}function gettimewithsecondsstring(e,t,n){var r=e.getHours();typeof t=="undefined"&&(t=window.datetime_am_string,n=window.datetime_pm_string);var i=r<12?t:n;window.timeformatwithseconds.indexOf("HH24")<0&&(r%=12,r==0&&(r=12));var s=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),o=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),u=window.timeformatwithseconds.replace(/fm/g,"");return u=u.replace("24",""),u=u.replace("HH",r),u=u.replace("MI",s),u=u.replace("SS",o),window.timeformatwithseconds.indexOf("HH24")<0&&(u=u.replace("am",i)),u}function getdatetimestring(e){return getdatestring(e)+" "+gettimestring(e)}function getdatetimetzstring(e){return getdatestring(e)+" "+gettimewithsecondsstring(e)}function getmmyydatestring(e,t){return window.dateformat=="DD-Mon-YYYY"?t[e.getMonth()]+"-"+nlGetFullYear(e):window.dateformat=="DD.MM.YYYY"?e.getMonth()+1+"."+nlGetFullYear(e):window.dateformat=="DD/MM/YYYY"?e.getMonth()+1+"/"+nlGetFullYear(e):window.dateformat=="YYYY/MM/DD"?e.getMonth()+1+"/"+nlGetFullYear(e):e.getMonth()+1+"/"+nlGetFullYear(e)}function parseMMYYDateString(e){var t,n;if(!/^[0-9-\/\.]+$/.test(e)){var r=e.split(/[\/-]/);if(r.length!=2)return null;n=getMonthIndex(r[0]),t=parseInt(r[1],10)}else{var i=e.split(/[\.\/-]/);if(i.length==1){var s=e.length;n=parseInt(e.substr(0,2-s%2),10),t=parseInt(e.substr(2-s%2),10)}else n=parseInt(i[0],10),t=parseInt(i[1],10)}return t<50?t+=2e3:t<100&&(t+=1900),{year:t,month:n}}function parseMMDDDateString(e){var t,n,r=e.split(/[\/]/);return r.length!=2?null:(n=parseInt(r[0],10)-1,t=parseInt(r[1],10),{month:n,day:t})}function stringtodate(e,t,n,r){var i,s,o,u,a,f,l,c,h=e;t==null&&(typeof window.dateformat!="undefined"?t=window.dateformat:t="MM/DD/YYYY");var p=e.length,d,v=4,m=n?null:new Date;if(h.length>0)if(t=="MM/DD/YYYY"){i=h.split("/");if(i.length<3)return m;s=parseInt(i[0],10)-1,o=parseInt(i[1],10),u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+2}else if(t=="DD/MM/YYYY"){i=h.split("/");if(i.length<3)return m;o=parseInt(i[0],10),s=parseInt(i[1],10)-1,u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+2}else if(t=="DD-Mon-YYYY"){i=h.split("-");if(i.length<3)return m;o=parseInt(i[0],10),s=getMonthIndex(i[1])-1,u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+2}else if(t=="DD.MM.YYYY"){i=h.split(".");if(i.length<3)return m;o=parseInt(i[0],10),s=parseInt(i[1],10)-1,u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+2}else if(t=="DD-MONTH-YYYY"){i=h.split("-");if(i.length<3)return m;o=parseInt(i[0],10),s=arrayIndexOf(NLDate_months,i[1],!0),u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+2}else if(t=="YYYY/MM/DD"){i=h.split("/");if(i.length<3)return m;d=i[2].split(" ")[0],o=parseInt(d,10),s=parseInt(i[1],10)-1,u=parseInt(i[0],10),p=i[1].length+d.length+v+2}else if(t=="YYYY-MM-DD"){i=h.split("-");if(i.length<3)return m;d=i[2].split(" ")[0],o=parseInt(d,10),s=parseInt(i[1],10)-1,u=parseInt(i[0],10),p=i[1].length+d.length+v+2}else if(t=="EEYY年MM月DD日"){a=h.indexOf(year_char_cn),f=h.indexOf(month_char_cn),l=h.indexOf(day_char_cn);if(a<0||f<0||l<0)return m;o=parseInt(h.substring(f+1,l),10),s=parseInt(h.substring(a+1,f),10)-1,c=h.substring(0,2),u=get_gregorian_year(parseInt(h.substring(2,a),10),c),p=l+1}else if(t=="YYYY年MM月DD日"){a=h.indexOf(year_char_cn),f=h.indexOf(month_char_cn),l=h.indexOf(day_char_cn);if(a<0||f<0||l<0)return m;o=parseInt(h.substring(f+1,l),10),s=parseInt(h.substring(a+1,f),10)-1,u=parseInt(h.substring(0,a),10),p=l+1}else if(t=="EYY.MM.DD"){i=h.split(".");if(i.length<3)return m;d=i[2].split(" ")[0],o=parseInt(d,10),s=parseInt(i[1],10)-1,c=i[0].substring(0,1),u=get_gregorian_year(parseInt(i[0].substring(1,i[0].length),10),c),p=i[0].length+i[1].length+d.length+2}else if(t=="DD. MON YYYY"){i=h.split(" ");if(i.length<3)return m;o=parseInt(i[0].substring(0,i[0].length-1),10),s=arrayIndexOf(NLDate_short_months,i[1]),u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+2}else if(t=="DD de MONTH de YYYY"){i=h.split(" de ");if(i.length<3)return m;o=parseInt(i[0],10),s=getMonthIndex(i[1])-1,u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+8}else if(t=="YYYY년 MM월 DD일"){i=h.split(" ");if(i.length<3)return m;o=parseInt(i[2].substring(0,i[2].length-1),10),s=parseInt(i[1].substring(0,i[1].length-1),10)-1,u=parseInt(i[0].substring(0,i[0].length-1),10),p=v+i[1].length+i[2].length+5}else if(t=="DD MONTH YYYY"){i=h.split(" ");if(i.length<3)return m;o=parseInt(i[0],10),s=arrayIndexOf(NLDate_months,i[1],!0),u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+2}else if(t=="DD MONTH, YYYY"){i=h.split(" ");if(i.length<3)return m;o=parseInt(i[0],10),s=arrayIndexOf(NLDate_months,i[1].substring(0,i[1].length-1),!0),u=parseInt(i[2].substring(0,v),10),p=i[0].length+i[1].length+v+2}if(!isvalidyearmonthday(u,s,o))return m;var g,y=e.substring(p);return y!=null&&y.length>0?r=="datetimetz"?g=regexstringtotime(e.substring(0,p),y,!0):r=="datetime"||r=="timeofday"?g=regexstringtotime(e.substring(0,p),y,!1):g=stringtotime(e.substring(0,p),y):g=new Date(u,s,o),u<50?nlSetFullYear(g,u+2e3):u<100&&nlSetFullYear(g,u+1900),g}function isvalidyearmonthday(e,t,n){return isNaN(e)||e<0||isNaN(t)||t<0||t>11||isNaN(n)||n<1||n>31?!1:!0}function trimstring(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function regexstringtotime(e,t,n){var r=e!=null?stringtodate(e):new Date;if(t!=null&&(new String(t)).length!=0&&(new String(t)).search(/\S/)>=0){var i,s,o;i=NaN,s=NaN,o=NaN;var u=null;t=trimstring(t);var a={"HH:MI:SS am":{rcase:0,hend:":",mend:":",send:" "},"HH-MI-SS am":{rcase:0,hend:"-",mend:"-",send:" "},"HH24:MI:SS":{rcase:0,hend:":",mend:":",send:null},"HH24-MI-SS":{rcase:0,hend:"-",mend:"-",send:null},"amHH時MI分SS秒":{rcase:1,hend:"時",mend:"分",send:"秒"},"amHH点MI分SS秒":{rcase:1,hend:"点",mend:"分",send:"秒"},"amHH시MI분SS초":{rcase:1,hend:"시",mend:"분",send:"초"},"HH24時MI分SS秒":{rcase:1,hend:"時",mend:"分",send:"秒"},"HH24点MI分SS秒":{rcase:2,hend:"点",mend:"分",send:"秒"},"HH24시MI분SS초":{rcase:2,hend:"시",mend:"분",send:"초"},"HH:MI am":{rcase:0,hend:":",mend:" ",send:null},"HH-MI am":{rcase:0,hend:"-",mend:" ",send:null},"HH24:MI":{rcase:0,hend:":",mend:null,send:null},"HH24-MI":{rcase:0,hend:"-",mend:null,send:null},"amHH時MI分":{rcase:1,hend:"時",mend:"分",send:null},"amHH点MI分":{rcase:1,hend:"点",mend:"分",send:null},"amHH시MI분":{rcase:1,hend:"시",mend:"분",send:null},"HH24時MI分":{rcase:2,hend:"時",mend:"分",send:null},"HH24点MI分":{rcase:2,hend:"点",mend:"分",send:null},"HH24시MI분":{rcase:2,hend:"시",mend:"분",send:null}};format=n?window.timeformatwithseconds.replace(/fm/g,""):window.timeformat.replace(/fm/g,""),format=trimstring(format),u=a[format];var f,l=null,c=null,h=null,p=null;if(u!=null){switch(u.rcase){case 0:f=/^(\d+)(\D)(\d+)((\D)(\d+))?\s*(am|pm)?/.exec(t),f[0]!=null&&(i=parseInt(f[1],10),c=f[2],s=parseInt(f[3],10),h=f[5],n&&f[4]!=null?o=parseInt(f[6],10):o=0,l=f[7]);break;case 1:f=/^(am|pm)(\d+)(\D)(\d+)(\D)((\d+)(\D))?/.exec(t),f[0]!=null&&(i=parseInt(f[2],10),c=f[3],s=parseInt(f[4],10),h=f[5],n&&f[6]!=null?(o=parseInt(f[7],10),p=f[8]):o=0,l=f[1]);break;case 2:f=/^(\d+)(\D)(\d+)(\D)((\d+)(\D))?/.exec(t),f[0]!=null&&(i=parseInt(f[1],10),c=f[2],s=parseInt(f[3],10),h=f[4],n&&f[5]!=null?(o=parseInt(f[6],10),p=f[7]):o=0)}if(isNaN(i)||isNaN(s)||isNaN(o)||i>=24||i<0||s>=60||s<0||o>=60||o<0)return NaN;if(c!=u.hend||n&&h!=null&&h!=u.mend||p!=null&&p!=u.send)return NaN;if(l!=null){var d=l.toLowerCase()==window.datetime_pm_string;!d&&i==12?i=0:d&&i<12&&(i+=12)}r.setHours(i,s,o,0)}else r=NaN}return r}function stringtotime(e,t){var n=e!=null?stringtodate(e):new Date;if(t!=null&&(new String(t)).length!=0&&(new String(t)).search(/\S/)>=0){var r,i,s,o,u,a;format=window.timeformat.replace(/fm/g,"");if(format=="HH:MI am"||format=="HH-MI am"||format=="HH24:MI"||format=="HH24-MI"){var f=/^\s*(\d+)[-:](\d+)\s*(.*)/.exec(t);if(!f)return NaN;r=parseInt(f[1],10),i=parseInt(f[2],10),format.substring(6)=="am"&&(o=f[3].toLowerCase()==window.datetime_pm_string,!o&&r==12?r=0:o&&r<12&&(r+=12))}else if(format=="amHH時MI分"||format=="amHH点MI分"||format=="amHH시MI분"){u=t.indexOf("時"),u<0&&(u=t.indexOf("点")),u<0&&(u=t.indexOf("시"));var l=0;o=!1,t.indexOf(window.datetime_am_string)==0?l=window.datetime_am_string.length:t.indexOf(window.datetime_pm_string)==0&&(l=window.datetime_pm_string.length,o=!0),r=parseInt(t.substring(l,u)),!o&&r==12?r=0:o&&r<12&&(r+=12),i=parseInt(t.substring(u+1,t.length-1))}else if(format=="HH24時MI分"||format=="HH24点MI分"||format=="HH24시MI분")u=t.indexOf("時"),u<0&&(u=t.indexOf("点")),u<0&&(u=t.indexOf("시")),r=parseInt(t.substring(0,u)),i=parseInt(t.substring(u+1,t.length-1));if(isNaN(r)||isNaN(i)||r>=24||r<0||i>=60||i<0||s>=60||s<0)return NaN;n.setHours(r,i,0,0)}return n}function hhmmtotime(e){return stringtotime(null,hhmmtotimestring(e))}function hhmmtotimestring(e){var t=e,n,r;window.datetime_am_string.charAt(0)==window.datetime_pm_string.charAt(0)?re=new RegExp("^[0-9]{1,4}("+window.datetime_am_string+"|"+window.datetime_pm_string+")*$","i"):re=new RegExp("^[0-9]{1,4}(["+window.datetime_am_string.charAt(0)+"|"+window.datetime_pm_string.charAt(0)+"]?)$","i");if(re.test(t)){var i="";RegExp.$1&&(window.datetime_am_string.charAt(0)==window.datetime_pm_string.charAt(0)?i=RegExp.$1.toLowerCase()==window.datetime_pm_string?window.datetime_pm_string:window.datetime_am_string:i=RegExp.$1.toLowerCase().charAt(0)==window.datetime_pm_string.charAt(0)?window.datetime_pm_string:window.datetime_am_string);if(t.length<3||t.length==3&&RegExp.$1){var s=RegExp.$1?t.substring(0,t.length-1):t;n=parseInt(s,10)==0?12:parseInt(s,10)>12?parseInt(s,10)%12:s,r=0;var o=RegExp.$1?i:parseInt(t,10)>11?window.datetime_pm_string:window.datetime_am_string}else if(t.length==3||t.length==4&&RegExp.$1){var s=t.substring(0,1)=="0"?"12":t.substring(0,1);n=parseInt(s,10);var u=RegExp.$1?t.substring(1,3):t.substring(1);r=parseInt(u,10);var o=RegExp.$1?i:window.datetime_am_string}else{var s=t.substring(0,2);n=parseInt(s,10)==0?12:parseInt(s,10)>12?parseInt(s,10)%12:s;var u=RegExp.$1?t.substring(2,4):t.substring(2);r=parseInt(u,10);var o=parseInt(t.substring(0,2),10)>11?window.datetime_pm_string:window.datetime_am_string;o=RegExp.$1?i:o}o==window.datetime_am_string&&n==12?n=0:o==window.datetime_pm_string&&n!=12&&(n=parseInt(n)+12);var a=new Date;a.setHours(n,r,0,0),t=gettimestring(a,window.datetime_am_string,window.datetime_pm_string)}return t}function adddays(e,t){var n=new Date(e.getTime()+86400*t*1e3);return n.getHours()!=e.getHours()&&(e.getHours()>0&&n.getHours()<e.getHours()||e.getHours()==0&&n.getHours()==23?n.setTime(n.getTime()+36e5):n.setTime(n.getTime()-36e5)),e.setTime(n.getTime()),e}function daysBetween(e,t){return get_julian_date(t)-get_julian_date(e)}function monthsBetween(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())}function isDOWIM(e,t){return t>=1&&t==1+Math.floor((e.getDate()-1)/7)||(t==-1||t==5)&&daysBetween(e,addmonths(new Date(e.getFullYear(),e.getMonth(),1),1))<=7}function isLeapYear(e){return e%4==0&&(e%100!=0||e%400==0)}MONTH_LENGTH=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]];function getMonthLength(e,t){return MONTH_LENGTH[isLeapYear(e)?1:0][t]}function setDateComponents(e,t,n,r){var i=new Date(e);return typeof r!="boolean"&&(r=!1),addmonths(i,t),setDate(i,n,r),i}function addmonths(e,t){if(t!=0){var n=nlGetFullYear(e),r=e.getDate(),i=e.getMonth()+t;i<0?(i+=1,n=n+Math.ceil(i/12)-1,nlSetFullYear(e,n),i=11+i%12):i>11&&(n+=Math.floor(i/12),nlSetFullYear(e,n),i%=12),eom=getMonthLength(n,i),r>eom&&e.setDate(eom),e.setMonth(i)}return e}function addhours(e,t,n){var r=new Date(e.getTime()+3600*t*1e3);return e.setTime(r.getTime()),n&&(e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)),e}function setDate(e,t,n){if(n){var r=getMonthLength(nlGetFullYear(e),e.getMonth());t=Math.min(r,t)}e.setDate(t)}m_j_d=[[0,31,59,90,120,151,181,212,243,273,304,334],[0,31,60,91,121,152,182,213,244,274,305,335]];function getMonthJulian(e,t){return m_j_d[isLeapYear(e)?1:0][t]}var j_d=new Array;j_d[1970]=0,j_d[1971]=365,j_d[1972]=730,j_d[1973]=1096,j_d[1974]=1461,j_d[1975]=1826,j_d[1976]=2191,j_d[1977]=2557,j_d[1978]=2922,j_d[1979]=3287,j_d[1980]=3652,j_d[1981]=4018,j_d[1982]=4383,j_d[1983]=4748,j_d[1984]=5113,j_d[1985]=5479,j_d[1986]=5844,j_d[1987]=6209,j_d[1988]=6574,j_d[1989]=6940,j_d[1990]=7305,j_d[1991]=7670,j_d[1992]=8035,j_d[1993]=8401,j_d[1994]=8766,j_d[1995]=9131,j_d[1996]=9496,j_d[1997]=9862,j_d[1998]=10227,j_d[1999]=10592,j_d[2e3]=10957,j_d[2001]=11323,j_d[2002]=11688,j_d[2003]=12053,j_d[2004]=12418,j_d[2005]=12784,j_d[2006]=13149,j_d[2007]=13514,j_d[2008]=13879,j_d[2009]=14245,j_d[2010]=14610,j_d[2011]=14975,j_d[2012]=15340,j_d[2013]=15706,j_d[2014]=16071,j_d[2015]=16436,j_d[2016]=16801,j_d[2017]=17167,j_d[2018]=17532,j_d[2019]=17897,j_d[2020]=18262,j_d[2021]=18628,j_d[2022]=18993,j_d[2023]=19358,j_d[2024]=19723,j_d[2025]=20089,j_d[2026]=20454,j_d[2027]=20819,j_d[2028]=21184,j_d[2029]=21550,j_d[2030]=21915;function get_julian_date(e){return j_d[e.getFullYear()]+getMonthJulian(e.getFullYear(),e.getMonth())+e.getDate()-1}function getMonthIndex(e){var t=-1;e=e.toUpperCase();for(var n=0;n<NLDate_short_months.length;n++)if(NLDate_short_months[n].toUpperCase()==e){t=n+1;break}if(t!=-1)return t;for(var n=0;n<NLDate_months.length;n++)if(NLDate_months[n].toUpperCase()==e){t=n+1;break}if(t!=-1)return t;var r="JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC";return t=(r.indexOf(e)+3)/3,t}function _hhmm_to_mins(e){return e.hrs*60+e.mins}function round_hhmm_nearest(e,t,n){var r=round_hhmm_up(e,t,n),i=round_hhmm_down(e,t,n);return orig_mins=_hhmm_to_mins({hrs:e,mins:t}),up_mins=_hhmm_to_mins(r),down_mins=_hhmm_to_mins(i),up_mins-orig_mins>orig_mins-down_mins?i:r}function round_hhmm_up(e,t,n){t+=t%n>0?n-t%n:0;if(t>=60){var r=Math.floor(t/60);t-=r*60,e+=r}return{hrs:e,mins:t}}function round_hhmm_down(e,t,n){return t-=t>0?t%n:0,{hrs:e,mins:t}}function round_hhmm(e,t,n){if(e=="")return e;var r=/^([0-9]+?):([0-9]+)$/,i=r.exec(e);if(i==null){i=format_hhmm(e);if(i==null)return e}var s=parseFloat(i[1]),o=parseFloat(i[2]),u;if(n=="UP")u=round_hhmm_up(s,o,t);else if(n=="DOWN")u=round_hhmm_down(s,o,t);else{if(n!="NEAR")throw n+" is not vald direction: [UP,DOWN,NEAREST]";u=round_hhmm_nearest(s,o,t)}return u.mins<10&&(u.mins="0"+u.mins),u.hrs+":"+u.mins}function format_hhmm(e){var t,n,r=/([0-9][0-9]?)?(:[0-9][0-9]+)?/,i=r.exec(e);if(i==null||i.index>0||i[0].length!=e.length)timeval=parseFloat(e),isNaN(timeval)?t=-1:(t=Math.floor(timeval),n=Math.floor((timeval-t)*60+.5));else{RegExp.$1.length>0?t=parseInt(RegExp.$1,10):t=0;if(typeof RegExp.$2!="undefined"&&RegExp.$2.length>0){n=parseInt(RegExp.$2.substr(1),10);if(n>=60){var s=Math.floor(n/60);n-=s*60,t+=s}}else n=0}if(t>=0&&n>=0&&n<60)return[e,t,n]}function hhmmtofloat(e){if(e==null||e=="")return 0;var t=/^([0-9]+?):([0-9]+)$/,n=t.exec(e);if(n==null){n=format_hhmm(e);if(n==null)return 0}var r=parseFloat(n[1]),i=parseFloat(n[2]);return 60*r+i}function createTDWindow(e){var t=screen.width*.35,n=screen.height*.3;if(t<150||n<150)t=150,n=150;var r=screen.width-(t+20),i=screen.height-(n+60);window.open(e,"test","scrollbars=yes,width="+t+",height="+n+",left="+r+",top="+i)}function DoFieldFocus(e){if(e==null)return;var t;for(t=0;t<e.elements.length;t++){var n=e.elements[t];if(n.type=="text"||n.type=="select-one"||n.type=="checkbox"){n.focus();return}}}function clearMultiSelect(e){if(isNLMultiDropDown(e))getMultiDropdown(e).removeAll();else if(e.type=="select-multiple")for(i=e.length-1;i>=0;i--)e.options[i].selected=!1;else e.value="",e.form.elements[e.name+"_display"]!=null&&(e.form.elements[e.name+"_display"].value="")}function getnamevaluelisttext(e,t,n){if(e.length==0)return"";var r=e.split(String.fromCharCode(4)),i="";for(var s=0;s<r.length;s++){var o=r[s].split(String.fromCharCode(3)),u=o.length==5?o[4]:o[3];if(u!=null&&u.length>0||n==1)isValEmpty(i)||(i+=t),i+=o[2]+": "+u}return i}function getnamevaluelistdata(e){if(e.length==0)return"";var t=e.split(String.fromCharCode(4)),n="";for(var r=0;r<t.length;r++){r>0&&(n+=String.fromCharCode(4));var i=t[r].split(String.fromCharCode(3)),s=i.length>3?i[3]:"";n+=i[0]+String.fromCharCode(3)+s}return n}function getnamevaluelistvalue(e,t){if(e.length==0)return null;var n=e.split(String.fromCharCode(4));for(var r=0;r<n.length;r++){var i=n[r].split(String.fromCharCode(3));if(i[0].toLowerCase()==t.toLowerCase())return i[3]}return null}function getnamevaluelistdisplayvalue(e,t){if(e.length==0)return null;var n=e.split(String.fromCharCode(4));for(var r=0;r<n.length;r++){var i=n[r].split(String.fromCharCode(3));if(i[0].toLowerCase()==t.toLowerCase())return i.length==5?i[4]:i[3]}return null}function setnamevaluelistvalue(e,t,n){if(e.length==0)return"";var r=e.split(String.fromCharCode(4));for(var i=0;i<r.length;i++){var s=r[i].split(String.fromCharCode(3));if(s[0].toLowerCase()==t.toLowerCase()){s[3]=n,r[i]=s.join(String.fromCharCode(3));break}}return r.join(String.fromCharCode(4))}function syncnamevaluelist(e){var t=e.form.elements[e.name+"_display"];t.value=getnamevaluelisttext(e.value,"\n",!0),t.onchange&&t.onchange()}function syncpopupmachinefield(e,t,n,r){e==null?nlapiSetFieldValue(t,r):n!=null?nlapiSetLineItemValue(e,t,n,r):nlapiSetCurrentLineItemValue(e,t,r)}function NLNameValueList_onKeyPress(e,t,n){var r=getEventKeypress(e);if(r==32){var i=document.getElementById(t+"_helper_"+n);i&&i.click&&i.click()}return!0}function synclist(e,t,n){if(isNLDropDown(e)){var r=getDropdown(e);if(r!=null){var i=r.getIndexForValue(t);r.setIndex(i,!0),n&&(r.setDefaultIndex(i),e.setAttribute("defaultValue",t))}}else if(e.type=="select-one"){for(var s=0;s<e.length;s++)if(e.options[s].value==t){e.selectedIndex=s,n&&(e.options[s].defaultSelected=!0,e.setAttribute("defaultValue",t));break}}else e.value=t,n&&e.setAttribute("defaultValue",t)}function syncpopup(e,t,n,r){var i;if(isNLDropDown(e)){var s=getDropdown(e),o=s.getIndexForValue(t);s.setIndex(o,!0),r&&s.setDefaultIndex(o)}else if(isNLMultiDropDown(e)){var s=getMultiDropdown(e);s.setValues(t)}else if(e.type=="select-one"||e.type=="select-multiple"){for(i=0;i<e.length;i++)if(e.options[i].value==t){e.selectedIndex=i,r&&(e.options[i].defaultSelected=!0);break}}else if(isPopupSelect(e)){e.value=t,r&&(e.defaultValue=t);var u=e.form.elements[e.name+"_display"];t!=null&&t.length>0||n!=null&&n.length>0?typeof n!="undefined"&&n!=null&&(u.value=n,u.style.color="#000000",r&&(u.defaultValue=n)):e.getAttribute("onlyAllowExactMatch")==null&&(u.value=u.type=="text"?_popup_help:_mult_popup_help,u.style.color="#999999")}else e.value=t,r&&(e.defaultValue=t)}function syncmultiselectlist(e,t,n,r){clearMultiSelect(e),typeof t!="string"&&!isArray(t)&&(t=""+t);if(isNLMultiDropDown(e)){typeof t!="string"&&(t=t.join(String.fromCharCode(5)));var i=getMultiDropdown(e);i.setValues(t,r)}else if(e.type!="select-multiple"){e.form.elements[e.name].value=t,n=emptyIfNull(n);var s=n.indexOf(String.fromCharCode(5))!=-1?String.fromCharCode(5):"\n",o=e.form.elements[e.name+"_labels"];o!=null&&(o.value=isValEmpty(t)?"":n.split(s).join(String.fromCharCode(5)));var u=e.form.elements[e.name+"_display"];u!=null&&e.getAttribute("onlyAllowExactMatch")==null&&(u.value=n?n.split(s).join("\n"):_mult_popup_help)}else{typeof t=="string"&&(t=t.split(String.fromCharCode(5)));for(var a=0;a<t.length;a++)for(var f=0;f<e.length;f++)e.options[f].value==t[a]&&(e.options[f].selected=!0)}}function syncradio(e,t,n){var r,i;for(r=0;r<e.length;r++)i=e[r].value==t,e[r].checked=i,n&&(e[r].defaultChecked=i)}function getlisttext(e,t,n){if(isNLDropDown(e))return getDropdown(e).getTextForValue(t);if(e.type!="select-one"&&!n)return"";for(var r=0;r<e.length;r++)if(e.options[r].value==t)return e.options[r].text;return""}function getmultiselectlisttext(e,t,n){n||(n="<br>");if(isNLMultiDropDown(e))return getMultiDropdown(e).getSelectedTextFromValues(t,n);if(e.type!="select-multiple")return"";var r=t.split(String.fromCharCode(5)),i="";for(var s=0;s<r.length;s++)s>0&&(i+=n),i+=getlisttext(e,r[s],!0);return i}function getradiotext(e,t){var n;for(n=0;n<e.length;n++)if(e[n].value==t)return e[n].textValue;return""}function getRadioValue(e){var t="";typeof e.length=="undefined"&&(e=e.ownerDocument.getElementsByName(e.name));for(var n=0;n<e.length;n++)if(e[n].checked==1){t=e[n].value;break}return t}function getSelectedRadio(e){var t=null;typeof e.length=="undefined"&&(e=e.ownerDocument.getElementsByName(e.name));for(var n=0;n<e.length&&t==null;n++)t=e[n].checked?e[n]:null;return t}function getSelectValue(e){var t;return e.type!=null&&e.type=="select-one"?t=e.options.length==0||e.selectedIndex==-1||e.selectedIndex>=e.options.length?"":e.options[e.selectedIndex].value:isMultiSelect(e)?t=getMultiSelectValues(e):isNLDropDown(e)?t=getDropdown(e).getValue():isNLMultiDropDown(e)?t=getMultiDropdown(e).getSelectedValues():t=e.value,t}function getSelectValueArray(e){var t;if(e.type=="select-one"||e.type=="select-multiple"){t=new Array(e.length);for(var n=0;n<e.length;n++)t[n]=e.options[n].value}else isNLDropDown(e)?t=getDropdown(e).valueArray:isNLMultiDropDown(e)&&(t=getMultiDropdown(e).valueArray);return t}function getIndexForValue(e,t){var n=-1;if(e.type=="select-one"||e.type=="select-multiple"){for(var r=0;r<e.length;r++)if(e.options[r].value==t){n=r;break}}else isNLDropDown(e)?n=getDropdown(e).getIndexForValue(t):isNLMultiDropDown(e)&&(n=getMultiDropdown(e).getIndexForValue(t));return typeof n=="undefined"&&(n=-1),n}function getSelectTextForValue(e,t){var n=getSelectValueArray(e),r;for(r=0;r<n.length;r++)if(n[r]==t)return getSelectTextAtIndex(e,r);return null}function getSelectTextArray(e){var t;if(e.type=="select-one"||e.type=="select-multiple"){t=new Array(e.length);for(var n=0;n<e.length;n++)t[n]=e.options[n].text}else isNLDropDown(e)?t=getDropdown(e).textArray:isNLMultiDropDown(e)&&(t=getMultiDropdown(e).textArray);return t}function getSelectText(e,t){var n=getSelectValue(e);return e.type=="select-one"?e.options.length==0||e.selectedIndex==-1||e.selectedIndex>=e.options.length?null:e.options[e.selectedIndex].text:isNLDropDown(e)?getDropdown(e).getText():isMultiSelect(e)||isPopupMultiSelect(e)?getMultiSelectText(e,null,t):isPopupSelect(e)?isValEmpty(n)?"":getFormElement(e.form,e.name+"_display").value.replace(/\s$/,""):isDisplayOnlySelect(e)?getInlineTextValue(document.getElementById(e.name+"_displayval")):e.text}function setSelectValue(e,t){if(window.virtualBrowser)e.value=t;else if(isNLDropDown(e)){var n=getDropdown(e),r=n.getIndexForValue(t);if(r==null)return!1;n.setIndex(r,!0),n.isOpen&&n.setCurrentCellInMenu(n.divArray[r])}else if(isNLMultiDropDown(e)){var n=getMultiDropdown(e),r=n.getIndexForValue(t);if(r==null)return!1;n.setIndex(r)}else{if(e.type=="select-one"){var i=e.options;for(var s=0;s<i.length;s++)if(i[s].value==t)return e.selectedIndex=s,!0;return!1}if(e.type=="select-multiple"){var o=e.options,u=!1;for(var s=0;s<o.length;s++)o[s].selected=o[s].value==t,u=u||o[s].value==t;return u}e.value=t;if(t.length==0&&isPopupSelect(e)){var a=e.form.elements[e.name+"_display"];a.value=a.type=="text"?_popup_help:_mult_popup_help,a.style.color="#999999"}}return!0}function addMultiSelectValue(e,t,n){if(isNLMultiDropDown(e)){var r=getMultiDropdown(e),i=r.getIndexForValue(t);r.addIndex(i)}else if(e.type=="select-multiple"){var s=e.options;for(var o=0;o<s.length;o++)s[o].value==t&&(s[o].selected=!0)}else{var u=e.value.split(String.fromCharCode(5));for(var o=0;o<u.length;o++)if(u[o]==t)return;e.form.elements[e.name+"_display"].style.color="#000000";if(u.length==0||u[0].length==0)e.value=t,e.form.elements[e.name+"_display"].value=n,e.form.elements[e.name+"_labels"].value=n;else{e.value+=String.fromCharCode(5)+t,e.form.elements[e.name+"_labels"].value+=String.fromCharCode(5)+n;var a=e.form.elements[e.name+"_display"].value.split(/\n|\r/);a.length==u.length?e.form.elements[e.name+"_display"].value+="\n"+n:(a[u.length]=n,e.form.elements[e.name+"_display"].value=a.join("\n"))}}}function getCurrentMultiSelectUserInputValue(e){var t=getSelectedTextRange(e)[0],n=e.value.substr(0,t),r=Math.max(n.lastIndexOf("\n"),n.lastIndexOf("\r"))+1,i=e.value.substr(t).search(/\n|\r/);return i=i==-1?e.value.length:t+i,userEnteredValue=e.value.substring(r,i),userEnteredValue}function getSelectValueForText(e,t){var n=getSelectTextArray(e),r;for(r=0;r<n.length;r++)if(n[r]==t)return getSelectValueAtIndex(e,r);return null}function deleteAllSelectOptions(e,t){isNLDropDown(e)?getDropdown(e,t).deleteAllOptions():isNLMultiDropDown(e)?getMultiDropdown(e,t).deleteAllOptions():e.type=="select-one"||e.type=="select-multiple"?e.options.length=0:e.form.elements[e.name+"_display"]!=null&&(e.form.elements[e.name+"_display"].value="",e.value="")}function deleteOneSelectOption(e,t,n){if(isNLDropDown(e))getDropdown(e).deleteOneOption(t,n);else if(isNLMultiDropDown(e))getMultiDropdown(e).deleteOneOption(t);else if(e.type=="select-one"||e.type=="select-multiple"){var r=e.options;for(var i=0;i<r.length;i++)r[i].value==t&&(r[i]=null)}else e.form.elements[e.name+"_display"]!=null&&(e.form.elements[e.name+"_display"].value="",e.value="")}function getSelectIndex(e,t){return isNLDropDown(e)?getDropdown(e,t).getIndex():e.selectedIndex}function setSelectIndex(e,t){if(isNLDropDown(e))return getDropdown(e).setIndex(t,!0);if(isNLMultiDropDown(e))return getMultiDropdown(e).setIndex(t);e.selectedIndex=t}function setMultiSelectValues(e,t){syncmultiselectlist(e,t)}function getMultiSelectValues(e,t){var n=null;if(isMultiSelect(e))if(isNLMultiDropDown(e))n=getMultiDropdown(e).getSelectedValues();else{n="";for(var r=0;r<e.length;r++)e.options[r].selected&&(n+=(n==""?"":String.fromCharCode(5))+e.options[r].value)}else n=e.value;return t?isValEmpty(n)?[]:n.split(String.fromCharCode(5)):n}function getMultiSelectText(e,t,n){var r="",i=n?String.fromCharCode(5):", ";if(isMultiSelect(e)){i=t?"\n":i;if(isNLMultiDropDown(e))r=getMultiDropdown(e).getSelectedText(i);else{var s,o=0;for(s=0;s<e.length;s++)e.options[s].selected&&(r+=(o++==0?"":i)+e.options[s].text)}}else isPopupMultiSelect(e)?(r=getFormElement(e.form,e.name+"_labels").value,r!=null&&i!=String.fromCharCode(5)&&(r=r.replace(new RegExp(String.fromCharCode(5),"g"),i))):r=e.text;return n?isValEmpty(r)?[]:r.split(i):r}function updateMultiSelectValue(e,t,n,r,s){e.value=n,s.value=r;var o=r.split(String.fromCharCode(5)),u="",a=0;for(i=0;i<o.length;i++)u+=(a==0?"":"\n")+o[i],a++;t.value=u}function addSelectOption(e,t,n,r,i,s,o){if(isNLDropDown(t)){var u=getDropdown(t,s);if(u==null)return;u.addOption(n,r,o);if(i!==!1){var o=u.getIndexForValue(r);u.setIndex(o,!0)}}else if(isNLMultiDropDown(t)){var u=getMultiDropdown(t,s);if(u==null)return;u.addOption(n,r,i,o)}else{var a=e.createElement("OPTION");a.text=n,a.value=r;if(isIE)typeof o=="undefined"&&(o=t.length),t.add(a,o);else{var f=null;typeof o!="undefined"&&o>=0&&o<t.length&&(f=t.options[o]),t.add(a,f)}i!==!1&&(a.selected=!0,isIE&&(t.selectedIndex=o))}}function setSelectOptionText(e,t,n,r){if(isNLDropDown(e)){var i=getDropdown(e,r);i.setOptionText(t,n)}else if(e.type=="select-one"||e.type=="select-multiple"){var s=e.options;for(var o=0;o<s.length;o++)s[o].value==t&&(s[o].text=n)}}function getCascadedStyle(e,t,n){if(e.currentStyle)return e.currentStyle[t];if(window.getComputedStyle){if(e.nodeType!=1)return null;var r=window.getComputedStyle(e,"");if(r)return r.getPropertyValue(n)}return null}function isFocusable(e){return e==null||typeof e.type=="undefined"&&!isNLDropDownSpan(e)||e.type=="hidden"||e.disabled||e.type=="button"?!1:elementIsFocusable(e)}function elementIsFocusable(e){while(e!=null){var t=getCascadedStyle(e,"visibility","visibility"),n=getCascadedStyle(e,"display","display");if(n=="none"||t=="hidden"||t=="hide")return!1;e=e.parentNode}return!0}function NLIsButton(e){if(e)if(e.tagName=="BUTTON"||e.tagName=="INPUT"&&(e.type=="submit"||e.type=="button"||e.type=="reset"))return!0;return!1}function NLIsSubmitButton(e){return e&&e.tagName=="INPUT"&&e.type=="submit"?!0:!1}function NLDisableButton(e,t){e.disabled=t;if(e.className.indexOf("nlbutton")>=0||e.className.indexOf("bgbutton")>=0||e.className.indexOf("nlinlineeditbutton")>=0)e.className=e.className.split("Disabled")[0]+(t?"Disabled":"");if(e.className.indexOf("bntBgT")>=0&&e.name){var n=document.getElementById("tr_"+e.name);n&&n.className&&(t?n.className.indexOf("Dis")<0&&(n.className=n.className+"Dis"):n.className=n.className.replace("Dis",""))}}function NLInvokeButton(e){if(e){if(e.disabled)return;e.click()}}function NLAddButtonDisabledMessage(e,t,n){var r=document.getElementById(e),i=document.getElementById(t);if(r==null||i==null)return;var s=findGlobalPosX(r),o=findGlobalPosY(r),u=r.offsetWidth,a=r.offsetHeight,f=document.createElement("div");f.style.position="absolute",f.style.left=s+"px",f.style.top=o+"px",f.style.width=u+"px",f.style.height=a+"px",f.style.background="#000000",f.style.opacity="0",f.style.zindex="100",attachEventHandler("mouseover",f,function(){nlShowMessageTooltip(i,n)}),attachEventHandler("mouseout",f,function(){closePopup()}),attachEventHandler("click",f,function(){i.disabled||i.onClick()}),r.appendChild(f)}function getSubmitButton(e,t){var n=document.getElementsByName(e);for(var r=0;r<n.length;r++){var i=n[r];if(NLIsSubmitButton(i)&&(t==null||t==i.value))return i}return null}function isDisplayOnlySelect(e){return e!=null&&e.type=="hidden"&&document.getElementById(e.name+"_displayval")!=null}function isPopupSelect(e){return e!=null&&e.type=="hidden"&&getFormElement(e.form,e.name+"_display")!=null&&getFormElement(e.form,e.name+"_display").type=="text"}function isPopupMultiSelect(e){return e!=null&&e.type=="hidden"&&getFormElement(e.form,e.name+"_display")!=null&&getFormElement(e.form,e.name+"_display").type=="textarea"&&getFormElement(e.form,e.name+"_labels")!=null}function NLPopupSelect_setExactMatchQuery(e,t){e.setAttribute("exactMatchQuery",t?"T":"F")}function NLPopupSelect_getExactMatchQuery(e){return e.getAttribute("exactMatchQuery")=="T"}function isSelect(e){return e!=null&&(e.type=="select-one"||isNLDropDown(e))}function isNLDropDown(e){return e.className&&e.className.indexOf("nldropdown")>=0}function isNLDropDownSpan(e){return e!=null&&e.tagName=="SPAN"&&window.getDropdown!=null&&getDropdown(e)!=null}function isMultiSelect(e){return e!=null&&(isNLMultiDropDown(e)||e.multiple||e.type=="select-multiple")}function isNLMultiDropDown(e){return e!=null&&e.getAttribute&&!isValEmpty(e.getAttribute("nlmultidropdown"))}function isRichTextEditor(e){return e!=null&&window.getHtmlEditor!=null&&getHtmlEditor(e.name)!=null}function isRichTextEditorUnregisteredSafe(e){return e==null?!1:e.className!=null&&e.className.indexOf("rteditor")!=-1}function isSummaryField(e){return e.className&&e.className.indexOf("nlsummary")>=0}function resetlist(e){if(e!=null)if(e.type=="select-one"||e.type=="select-multiple"){var t;for(t=0;t<e.length;t++)if(e.options[t].defaultSelected){e.selectedIndex=t;return}e.selectedIndex=0}else isNLDropDown(e)?getDropdown(e).resetDropDown():isNLMultiDropDown(e)?getMultiDropdown(e).resetDropDown():(e.value=e.defaultValue,e.form.elements[e.name+"_display"].value=e.form.elements[e.name+"_display"].defaultValue)}function setFieldFocus(e){isSelect(e)||isMultiSelect(e)||isPopupSelect(e)||isPopupMultiSelect(e)?setSelectFocus(e):window.getHtmlEditor!=null&&window.getHtmlEditor(e.name)!=null?window.getHtmlEditor(e.name).setFocus():isFocusable(e)&&e.focus()}function setSelectFocus(e,t){e!=null&&(e.type=="select-one"||e.type=="select-multiple"?isFocusable(e)&&e.focus():isNLDropDown(e)?isFocusable(getDropdown(e,t).getContainer())&&getDropdown(e,t).setFocus():isNLMultiDropDown(e)?isFocusable(getMultiDropdown(e,t).getContainer())&&getMultiDropdown(e,t).setFocus():isFocusable(e.form.elements[e.name+"_display"])&&e.form.elements[e.name+"_display"].focus())}function restoreSelectToOriginalValue(e,t){if(e!=null)if(e.type=="select-one"||e.type=="select-multiple"){var n=e.getAttribute("valuewhenrendered");n!=null&&n.length>0&&setSelectValue(e,n)}else isNLDropDown(e)&&getDropdown(e,t).restoreToOriginalValue()}function getSelectValueAtIndex(e,t){if(e!=null){if(e.type=="select-one"||e.type=="select-multiple")return e.options!=null&&e.options.length>t?e.options[t].value:null;if(isNLDropDown(e))return getDropdown(e).getValueAtIndex(t);if(isNLMultiDropDown(e))return getMultiDropdown(e).getValue(t)}}function getSelectTextAtIndex(e,t){if(e!=null){if(e.type=="select-one"||e.type=="select-multiple")return e.options!=null&&e.options.length>t?e.options[t].text:null;if(isNLDropDown(e))return getDropdown(e).getTextAtIndex(t);if(isNLMultiDropDown(e))return getMultiDropdown(e).getText(t)}}function setNLCheckboxValue(e,t){if(!e)return;typeof t=="string"?e.checked=t=="T":e.checked=t,NLCheckboxOnChange(e)}function getNLCheckboxValue(e){if(!e)return;return e.checked}function getNLCheckboxSpan(e){var t=e.parentNode;return t&&t.nodeName=="SPAN"&&t.className&&t.className.indexOf("checkbox")==0?t:null}function setNLCheckboxDisabled(e,t){if(!e||e.type!="checkbox")return;var n="checkbox"+(t?"_disabled":"")+(e.checked?"_ck":"_unck");e.disabled=t;var r=getNLCheckboxSpan(e);r&&(r.className=n)}function setNLCheckboxReadOnly(e,t){if(!e||e.type!="checkbox")return;var n="checkbox"+(t?"_read":"")+(e.checked?"_ck":"_unck");e.readonly=t;var r=getNLCheckboxSpan(e);r.className=n}function NLCheckboxOnClick(e){var t=e.className,n=null;for(var r=0;r<e.childNodes.length;r++)if(e.childNodes[r].type=="checkbox"){n=e.childNodes[r];break}if(!n||n.disabled)return;n.type=="checkbox"&&n.checked?(e.className=e.className.replace("_ck","_unck"),n.checked=!1):(e.className=e.className.replace("_unck","_ck"),n.checked=!0),n.focus();var i=n.checked;n.onclick&&n.onclick();var s=n.checked;i!=s?e.className=t:n.onchange&&n.onchange()}function NLCheckboxOnChange(e){if(!e)return;var t=getNLCheckboxSpan(e);t&&(e.checked?t.className=t.className.replace("_unck","_ck"):t.className=t.className.replace("_ck","_unck"))}function NLCheckboxSetParentState(e,t){if(!e)return;var n=getNLCheckboxSpan(e);n&&(t?n.className=n.className.replace("_unck","_ck"):n.className=n.className.replace("_ck","_unck"))}function NLCheckboxOnKeyPress(e){return window.event&&(e=getEvent(e),e.keyCode==32&&e.srcElement&&(e.srcElement.onclick&&e.srcElement.onclick(),NLCheckboxSetParentState(e.srcElement,!e.srcElement.checked))),!0}function getNLSummaryFieldContent(e){if(!isSummaryField(e))return"";var t=e.document?e.document:document,n=t.getElementById(e.id+"_val");return n&&n.parentNode?n.parentNode.innerHTML:""}function setNLSummaryFieldTextValue(e,t){if(!isSummaryField(e))return"";var n=e.document?e.document:document,r=n.getElementById(e.id+"_val");r&&(r.innerHTML=t)}function getNLSummaryFieldTextValue(e){if(!isSummaryField(e))return"";var t=e.document?e.document:document,n=t.getElementById(e.id+"_val");return n?n.innerHTML:""}function setNLSummaryFieldDisabled(e,t){if(!isSummaryField(e))return;e.disabled=t;var n=e.document?e.document:document,r=n.getElementById(e.name+"_helper_popup");r!=null&&(r.style.visibility=t?"hidden":"inherit")}function isNLNumericOrCurrencyDisplayField(e){return e?!isNumericField(e)&&!isCurrencyField(e)?!1:e.name.indexOf("_formattedValue")>0:!1}function getNLNumericOrCurrencyDisplayField(e){if(!e)return null;var t=e.name+"_formattedValue";return findNLNumericFieldByName(e,t)}function getNLNumericOrCurrencyValueField(e){if(!e)return null;var t=e.name.replace("_formattedValue","");return findNLNumericFieldByName(e,t)}function findNLNumericFieldByName(e,t){if(!e.form){var n=e.ownerDocument.getElementsByName(t);for(var r=0;r<n.length;r++)if(n[r].parentNode==e.parentNode)return n[r];return e.ownerDocument.getElementById(t)}return e.form.elements[t]}function isCurrencyField(e){if(!e)return!1;var t="";return typeof e.getAttribute!="undefined"&&(t=e.getAttribute("dataType")),t=="currency"||t=="poscurrency"||t=="currency2"?!0:!1}function setNLCurrencyValue(e,t){e.value=t;var n=getNLNumericOrCurrencyDisplayField(e);if(!n)return;n.value=NLNumberToString(t)}function isNumericField(e){if(!e)return!1;var t="";return typeof e.getAttribute!="undefined"&&(t=e.getAttribute("dataType")),t=="float"||t=="posfloat"||t=="nonnegfloat"||t=="integer"||t=="posinteger"||t=="rate"||t=="ratehighprecision"||t=="percent"?!0:!1}function setNLNumericValue(e,t){e.value=t;var n=getNLNumericOrCurrencyDisplayField(e);if(!n)return;n.value=NLNumberToString(t)}function setNLNumericOrCurrencyFieldDisabled(e,t){var n=getNLNumericOrCurrencyDisplayField(e);if(!n)return;n.disabled=t}function getNLNumericOrCurrencyFieldDisabled(e){var t=getNLNumericOrCurrencyDisplayField(e);return t?t.disabled:!1}function setDefaultOrNotRequired(e,t){setRequired(e,t?getRequired(e):!1)}function hasAttribute(e,t){return isNLDropDown(e)?getDropdown(e).hasAttribute(t):isNLMultiDropDown(e)?getMultiDropdown(e).hasAttribute(t):window.getHtmlEditor!=null&&getHtmlEditor(e.name)!=null?getHtmlEditor(e.name).hasAttribute(t):(e.getAttribute("flags")&t)!=0}function disableField(e,t){if(e==null)return;if(!isSelect(e)&&e.length>1){for(var n=0;n<e.length;n++)e[n].type=="radio"&&disableField(e[n],t);return}if(isSelect(e)||isPopupSelect(e)||isMultiSelect(e)||isPopupMultiSelect(e))disableSelect(e,t);else if(window.getHtmlEditor!=null&&getHtmlEditor(e.name)!=null)getHtmlEditor(e.name).setDisabled(t);else if(NLIsButton(e))NLDisableButton(e,t);else if(e.type=="checkbox")setNLCheckboxDisabled(e,t);else if(isSummaryField(e))setNLSummaryFieldDisabled(e,t);else if(isNumericField(e)||isCurrencyField(e))setNLNumericOrCurrencyFieldDisabled(e,t);else{e.disabled=t;var r=e.document?e.document:document,i=r.getElementById(e.name+"_helper_calendar");i!=null&&(i.style.visibility=t?"hidden":"inherit")}}function getFieldDisabled(e){if(e==null)return;if(!isSelect(e)&&e.length>1){for(var t=0;t<e.length;t++)if(e[t].type=="radio")return e[t].disabled}else{if(!(isSelect(e)||isPopupSelect(e)||isMultiSelect(e)))return window.getHtmlEditor!=null&&getHtmlEditor(e.name)!=null?getHtmlEditor(e.name).disabled:isNumericField(e)||isCurrencyField(e)?getNLNumericOrCurrencyFieldDisabled(e):e.disabled;if(e.type=="select-one"||e.type=="select-multiple")return e.disabled;if(isNLDropDown(e))return getDropdown(e,window).disabled;if(isNLMultiDropDown(e))return getMultiDropdown(e,window).disabled;if(isPopupSelect(e))return getFormElement(e.form,e.name+"_display").disabled}return!1}function setFieldReadOnly(e,t){e!=null&&e.type=="textarea"&&(e.readOnly=t)}function isDisplayOnlyField(e){if(e==null)return;return isDisplayOnlySelect(e)?!0:e.type=="hidden"&&document.getElementById(e.name+"_val")!=null?!0:!1}function setOptionsFromMachineField(machine_name,field_name,selectObject,alternate_label,test_field,test_value){deleteAllSelectOptions(selectObject,window);var doc=window.document,mch=eval(machine_name+"_machine");addSelectOption(doc,selectObject,"","",!0,window);var bNewOptions=!1;for(var i=1;i<=getLineCount(machine_name);i++){if(mch.getMachineIndex()==i||test_field!=null&&getEncodedValue(machine_name,i,test_field)!=test_value)continue;bNewOptions=!0,addSelectOption(doc,selectObject,getEncodedValue(machine_name,i,alternate_label!=null?alternate_label:field_name+"_display"),getEncodedValue(machine_name,i,field_name),!1,window)}return bNewOptions}function getSyncFunctionName(fldname,machine){var syncFuncName="Sync"+fldname;if(machine!=null){var machSyncFunc=syncFuncName+machine;if(eval("window."+machSyncFunc)!=null)return machSyncFunc}return syncFuncName}function safeSetDocumentLocation(e){try{document.location=e}catch(t){}}function addParamToURL(e,t,n,r){return e==null?null:(e.length&&e.charAt(e.length-1)=="#"&&(e=e.substring(0,e.length-1)),e.length&&e.indexOf("#")>-1&&(e=e.substring(0,e.indexOf("#"))),isValEmpty(t)?e:(r==1&&(e=removeParamFromURL(e,t)),addNextParamPrefixToURL(e)+t+"="+emptyIfNull(n)))}function addNextParamPrefixToURL(e){return e+(e.indexOf("?")==-1?"?":"&")}function removeParamFromURL(e,t){var n="&",r=e.indexOf("&"+t+"=");r==-1&&(r=e.indexOf("?"+t+"="),n="?");if(r!=-1){var i=e.indexOf("&",r+1);return e.substring(0,r)+(i>0?n=="?"?"?"+e.substr(i+1):e.substr(i):"")}return e}function formEncodeURLParams(e){var t="";for(var n in e)t+=(isValEmpty(t)?"":"&")+escape(n)+"="+escape(emptyIfNull(e[n]));return t}function previewMedia(e,t,n){t&&(e=e.substr(e.lastIndexOf("/")+1));var r="/core/media/previewmedia.nl?id="+e;preview(r,"prevmedia")}function previewTemplate(e,t){var n="/app/crm/common/merge/previewtemplate.nl?id="+e;isValEmpty(t)||(n=addParamToURL(n,"entity",t)),preview(n,"previewtemplate")}function siteMedia(e,t,n){t&&(e=e.substr(e.lastIndexOf("/")+1));var r="/app/site/media/sitemedia.nl?id="+e;preview(r,"sitemedia")}function preview(e,t){var n="location=no,width=600,height=500,menubar=yes,scrollbars=yes,resizable=yes",r=window.open(e,t,n);r.focus()}function getCookieVal(e){var t=document.cookie.indexOf(";",e);return t==-1&&(t=document.cookie.length),unescape(document.cookie.substring(e,t))}function GetCookie(e){var t=e+"=",n=t.length,r=document.cookie.length,i=0;while(i<r){var s=i+n;if(document.cookie.substring(i,s)==t)return getCookieVal(s);i=document.cookie.indexOf(" ",i)+1;if(i==0)break}return null}function getStickyTag(e){var t=GetCookie("stickytags");if(t!=null){var n=t.indexOf(","+e+":")+1;if(n>=1){var r=t.indexOf(",",n);return r<0&&(r=t.length),unescape(t.substring(n+e.length+1,r))}}return null}function addStickyTagToUrl(e,t){return e+(e.indexOf("?")>=0?"&t=":"?t=")+getStickyTag(t)}function redirectToStickyPage(e,t,n){var r=addStickyTagToUrl(e,t);try{typeof n=="number"?parent.frames[n].document.location=r:n?parent.document.location=r:document.location=r}catch(i){}}var SelectKeyPressMaxKeyPause=2e3;function SelectKeyPressHandler(e,t){return keyString=String.fromCharCode(getEventKeypress(e)).toUpperCase(),keyString>=" "&&keyString<="_"?(SelectKeyPressTimeoutID!=null&&window.clearTimeout(SelectKeyPressTimeoutID),SelectKeyPressTimeoutID=window.setTimeout("SelectKeyPressTimeout()",SelectKeyPressMaxKeyPause),SelectKeyPressTypedString+=keyString,t?SelectKeyPressTypedString.length==1?option=SelectKeyPressLookupFirst(e,SelectKeyPressTypedString):option=SelectKeyPressLookupNext(e,SelectKeyPressTypedString):option=SelectKeyPressLookupLinear(e,SelectKeyPressTypedString),setEventPreventDefault(e),option!=-1&&(getEventTarget(e).selectedIndex=option,getEventTarget(e).onchange()),!1):(SelectKeyPressTypedString="",!0)}var SelectKeyPressTypedString="";SelectKeyPressTimeoutID=null;function SelectKeyPressTimeout(){SelectKeyPressTypedString="",SelectKeyPressTimeoutID=null}function SelectKeyPressLookupFirst(e,t){select=getEventTarget(e),options=select.options,low=0,high=options.length;while(high-low>1)i=Math.floor((high+low)/2),t.charAt(0)<=options(i).text.charAt(0).toUpperCase()?high=i:low=i;while(high>0&&t.charAt(0)==options(high-1).text.charAt(0).toUpperCase())--high;return high<options.length&&t.charAt(0)==options(high).text.charAt(0).toUpperCase()?high:-1}function SelectKeyPressLookupNext(e,t){select=getEventTarget(e),options=select.options,selIndex=select.selectedIndex;while(selIndex<options.length-1&&options(selIndex).text.toUpperCase()<t)++selIndex;return selIndex<options.length-1&&options(selIndex).text.substr(0,t.length).toUpperCase()==t?selIndex:-1}function SelectKeyPressLookupLinear(e,t){select=getEventTarget(e),options=select.options;for(i=0;i<options.length;++i)if(options(i).text.substr(0,t.length).toUpperCase()==t)return i;return-1}function disableFilter(e,t,n,r){getRadioValue(e)==t?(n.disabled=!0,r&&(r.disabled=!0)):(n.disabled=!1,r&&(r.disabled=!1))}function NLDate_parseString(e,t){var n=0,r=0,i=0,s=e,o="",u="",a,f,l,c=null;window.dateformat||(window.dateformat="MM/DD/YYYY");if(e=="")return new Date;if(window.dateformat=="MM/DD/YYYY")if(s.indexOf("/")!=-1){var h=s.split("/");onlydigits(h[0])&&(n=parseInt(h[0],10)),onlydigits(h[1])&&(r=parseInt(h[1],10)),r>1970?(u=i=r,r=1):(onlydigits(h[2])&&(i=parseInt(h[2],10)),u=h[2])}else{var p=s.length,d;d=s.substr(0,2-p%2),onlydigits(d)&&(n=parseInt(d,10)),d=s.substr(2-p%2,2),onlydigits(d)&&(r=parseInt(d,10)),d=s.substr(4-p%2),onlydigits(d)&&(i=parseInt(d,10)),u=d}else if(window.dateformat=="DD/MM/YYYY")if(s.indexOf("/")!=-1){var h=s.split("/");onlydigits(h[0])&&(r=parseInt(h[0],10)),onlydigits(h[1])&&(n=parseInt(h[1],10)),onlydigits(h[2])&&(i=parseInt(h[2],10)),u=h[2]}else{var p=s.length,d;d=s.substr(0,2-p%2),onlydigits(d)&&(r=parseInt(d,10)),d=s.substr(2-p%2,2),onlydigits(d)&&(n=parseInt(d,10)),d=s.substr(4-p%2),onlydigits(d)&&(i=parseInt(d,10)),u=d}else if(window.dateformat=="YYYY/MM/DD")if(s.indexOf("/")!=-1){var h=s.split("/");onlydigits(h[0])&&(i=parseInt(h[0],10)),onlydigits(h[1])&&(n=parseInt(h[1],10)),onlydigits(h[2])&&(r=parseInt(h[2],10)),u=h[0]}else{var p=s.length,d;d=s.substr(0,2-p%2),onlydigits(d)&&(i=parseInt(d,10)),d=s.substr(2-p%2,2),onlydigits(d)&&(n=parseInt(d,10)),d=s.substr(4-p%2),onlydigits(d)&&(r=parseInt(d,10)),u=d}else if(window.dateformat=="DD.MM.YYYY")if(s.indexOf(".")!=-1){var h=s.split(".");onlydigits(h[0])&&(r=parseInt(h[0],10)),onlydigits(h[1])&&(n=parseInt(h[1],10)),onlydigits(h[2])&&(i=parseInt(h[2],10)),u=h[2]}else{var p=s.length,d;d=s.substr(0,2-p%2),onlydigits(d)&&(r=parseInt(d,10)),d=s.substr(2-p%2,2),onlydigits(d)&&(n=parseInt(d,10)),d=s.substr(4-p%2),onlydigits(d)&&(i=parseInt(d,10)),u=parseInt(d,10)}else if(window.dateformat=="DD-Mon-YYYY")if(s.indexOf("-")!=-1){var h=s.split("-");onlydigits(h[0])&&(r=parseInt(h[0],10)),n=getMonthIndex(h[1]),onlydigits(h[2])&&(i=parseInt(h[2],10)),u=h[2]}else{var p=s.length,d;d=s.substr(0,1+p%2),onlydigits(d)&&(r=parseInt(d,10)),d=s.substr(1+p%2,3),n=getMonthIndex(d),d=s.substr(4+p%2),onlydigits(d)&&(i=parseInt(d,10)),u=d}else if(window.dateformat=="DD-MONTH-YYYY"){var v=s.split("-");onlydigits(v[0])&&(r=parseInt(v[0])),n=arrayIndexOf(NLDate_months,v[1],!0)+1,onlydigits(v[2])&&(i=parseInt(v[2]),u=i)}else if(window.dateformat=="YYYY-MM-DD"){var v=s.split("-");onlydigits(v[2])&&(r=parseInt(v[2])),onlydigits(v[1])&&(n=parseInt(v[1])),onlydigits(v[0])&&(i=parseInt(v[0]),u=i)}else if(window.dateformat=="EEYY年MM月DD日"){a=s.indexOf(year_char_cn),f=s.indexOf(month_char_cn),l=s.indexOf(day_char_cn),onlydigits(s.substring(f+1,l))&&(r=parseInt(s.substring(f+1,l))),onlydigits(s.substring(a+1,f))&&(n=parseInt(s.substring(a+1,f)));var m=s.substring(0,2);onlydigits(s.substring(2,a))&&(i=get_gregorian_year(parseInt(s.substring(2,a)),m),u=i)}else if(window.dateformat=="YYYY年MM月DD日")a=s.indexOf(year_char_cn),f=s.indexOf(month_char_cn),l=s.indexOf(day_char_cn),onlydigits(s.substring(f+1,l))&&(r=parseInt(s.substring(f+1,l))),onlydigits(s.substring(a+1,f))&&(n=parseInt(s.substring(a+1,f))),onlydigits(s.substring(0,a))&&(i=parseInt(s.substring(0,a)),u=i);else if(window.dateformat=="EYY.MM.DD"){v=s.split("."),onlydigits(v[2])&&(r=parseInt(v[2])),onlydigits(v[1])&&(n=parseInt(v[1]));var m=v[0].substring(0,1);onlydigits(v[0].substring(1,v[0].length))&&(i=get_gregorian_year(parseInt(v[0].substring(1,v[0].length)),m),u=i)}else window.dateformat=="DD. Mon YYYY"?(v=s.split(" "),onlydigits(v[0].substring(0,v[0].length-1))&&(r=parseInt(v[0].substring(0,v[0].length-1))),n=getMonthIndex(v[1]),onlydigits(v[2])&&(i=parseInt(v[2]),u=i)):window.dateformat=="DD de MONTH de YYYY"?(v=s.split(" de "),onlydigits(v[0])&&(r=parseInt(v[0])),n=arrayIndexOf(NLDate_months,v[1])+1,onlydigits(v[2])&&(i=parseInt(v[2]),u=i)):window.dateformat=="YYYY년 MM월 DD?"?(v=s.split(" "),onlydigits(v[2].substring(0,v[2].length-1))&&(r=parseInt(v[2].substring(0,v[2].length-1))),onlydigits(v[1].substring(0,v[1].length-1))&&(n=parseInt(v[1].substring(0,v[1].length-1))-1),onlydigits(v[0].substring(0,v[0].length-1))&&(i=parseInt(v[0].substring(0,v[0].length-1)),u=i)):window.dateformat=="DD MONTH YYYY"?(v=s.split(" "),onlydigits(v[0])&&(r=parseInt(v[0])),n=arrayIndexOf(NLDate_months,v[1],!0)+1,onlydigits(v[2])&&(i=parseInt(v[2]),u=i)):window.dateformat=="DD MONTH, YYYY"&&(v=s.split(" "),onlydigits(v[0])&&(r=parseInt(v[0])),n=arrayIndexOf(NLDate_months,v[1].substring(0,v[1].length-1),!0)+1,onlydigits(v[2])&&(i=parseInt(v[2]),u=i));return n==0||r==0?t&&(o==""&&(o=window.dateformat),alert("Invalid date value (must be "+window.dateformat+")")):(i==0&&!onlydigits(u)&&(i=(new Date).getFullYear()),n<1?n=1:n>12&&(n=12),r<1?r=1:r>31&&(r=31),i<100&&(i+=i>=70?1900:2e3),i<1e3&&(i*=10),i>9999&&(i=(new Date).getFullYear()),u=i,c=validateDate(new Date(i,n-1,r),t),c!=null&&(i!=nlGetFullYear(c)||n!=c.getMonth()+1||r!=c.getDate())&&(c=validateDate(new Date(i,n-1,r,12,30),t),c!=null&&(i!=nlGetFullYear(c)||n!=c.getMonth()+1||r!=c.getDate())&&(c=null))),c}function validateDate(e,t){return e.getTime()<-116366724e5&&(e=null,t&&alert("Invalid date value (must be on or after "+getdatestring(new Date(-116366724e5))+")")),e}var NLDate_pnDaysInMonths=new Array(31,28,31,30,31,30,31,31,30,31,30,31);function NLDate_getLastDayOfMonth(e){var t=e.getMonth(),n=NLDate_pnDaysInMonths[t];if(t==1){var r=e.getYear();(r%400==0||r%4==0&&r%100!=0)&&n++}return n}function setDisabledState(e,t){elem=document.getElementById(e);if(typeof elem.disabled!="undefined"){elem.disabled=!t;return}var n=document.getElementById(e).getElementsByTagName("INPUT");for(var r=0;r<n.length;r++)n[r].name.indexOf("_send")==-1&&(n[r].disabled=!t);var n=document.getElementById(e).getElementsByTagName("A");for(var r=0;r<n.length;r++)!t&&!n[r].disabled?(n[r].enabledonclick=n[r].onclick,n[r].onclick=new Function("return false;")):t&&n[r].enabledonclick!=null&&n[r].disabled&&(n[r].onclick=n[r].enabledonclick),n[r].disabled=!t}var NLAlertContext_CREDIT_CARD_NUMBERS_MUST_CONTAIN_BETWEEN_13_AND_20_DIGITS="Credit card numbers must contain between 13 and 20 digits.",NLAlertContext_CREDIT_CARD_NUMBERS_MUST_CONTAIN_ONLY_DIGITS="Credit card numbers must contain only digits.",NLAlertContext_EMAIL_ADDRESSES_MUST_MATCH="Email addresses must match.",NLAlertContext_NETSUITE_DOES_NOT_ACCEPT_EMAIL_ADDRESSES_WITH_QUOTATION_MARKS_COMMAS_COLONS_SPACES_OR_GREATER_THAN_OR_LESS_THAN_SIGNS="Please make sure there are no quotation marks, commas, colons, spaces, or greater than or less than signs.",NLAlertContext_PASSWORDS_DONT_MATCHN="Passwords don't match.\n",NLAlertContext_PASSWORDS_CANNOT_BE_EMPTYN="Passwords cannot be empty.\n",NLAlertContext_PASSWORDS_MUST_BE_AT_LEAST_1_CHARACTERS_LONGN="Passwords must be at least {1} characters long.",NLAlertContext_PASSWORDS_MUST_CONTAIN_AT_LEAST_ONE_LETTER_AZN="Passwords must contain at least one letter (A-Z).\n",NLAlertContext_PASSWORDS_MUST_CONTAIN_AT_LEAST_ONE_NUMBER_OR_SPECIAL_CHARACTERN="Passwords must contain at least one number or special character.\n",NLAlertContext_PASSWORDS_MAY_CONTAIN_ONLY_LETTERS_NUMBERS_AND_SPECIAL_CHARACTERSN="Passwords may contain only letters, numbers, and special characters.\n",NLAlertContext_OLD_AND_NEW_PASSWORDS_ARE_TOO_SIMILAR="Old and new passwords are too similar.",NLAlertContext_PASSWORD_MUST_NOT_BE_THE_SAME_AS_THE_EMAIL_ADDRESS="Password must not be the same as the email address",NLAlertContext_CREDIT_CARD_NUMBER_IS_NOT_VALID__PLEASE_CHECK_THAT_ALL_DIGITS_WERE_ENTERED_CORRECTLY="Credit card number is not valid.  Please check that all digits were entered correctly.",NLAlertContext_NETSUITE_DOES_NOT_ACCEPT_EMAIL_ADDRESSES_WITH_QUOTATION_MARKS_COMMAS_COLONS_SPACES_OR_GREATER_THAN_OR_LESS_THAN_SIGNS="Please make sure there are no quotation marks, commas, colons, spaces, or greater than or less than signs.",NLAlertContext_PLEASE_ENTER_A_VALID_EMAIL_ADDRESS="Please enter a valid email address.",NLValidationUtil_SIMPLE_EMAIL_PATTERN=/^[-a-z0-9!#$%&'*+/=?^_`{|}~]+(?:\.[-a-z0-9!#$%&'*+/=?^_`{|}~]+)*@(?:[a-z0-9]+(?:-+[a-z0-9]+)*\.)+(?:xn--[a-z0-9]+|[a-z]{2,16})$/i,NLAlertContext_THE_SPECFIED_ROUTING_NUMBER_FAILED_VALIDATION_FOR_ABA_ROUTING_NUMBERS="The specfied routing number failed validation for ABA Routing Numbers.",NLAlertContext_ABA_ROUTING_NUMBERS_MUST_BE_NINE_CHARACTERS="ABA Routing Numbers must be nine characters.";function isValEmpty(e){return e===null||e===undefined?!0:(e=new String(e),e.length==0||!/\S/.test(e))}function isHTMLValEmpty(e){return isValEmpty(e)?!0:(e=e.replace(/&nbsp;|<(?!NL)[^>]*>/gi,""),!/\S/.test(e))}function nvl(e,t){return e==null?t:e}function emptyIfNull(e){return e==null?"":e}function nullIfEmpty(e){return isValEmpty(e)?null:e}function trim(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function onlydigitsandchars(e){var t=new RegExp("([A-Za-z0-9]+)");return t.exec(e)!=null&&RegExp.$1==e}function onlydigits(e){return/^[0-9]+$/.test(e)}function isemptyorzero(e){var t=e,n=isValEmpty(t),r=t==0;return n||r}function isNewRecord(){var e=typeof nlapiGetField!=undefined&&nlapiGetField("id")!=null?nlapiGetFieldValue("id"):typeof document!=undefined&&document.forms.main_form.elements.id!=null?document.forms.main_form.elements.id:"";return isValEmpty(e)||e==-1}function isExistingRecord(){return!isNewRecord()}function getEditFlag(){return isExistingRecord()}function checkMandatoryFields(e,t,n,r){var i="";for(var s=0;s<e.length;s++){if(e[s]==null)continue;var o=n!=null?n[s]:e[s].value;if((new String(o)).indexOf(String.fromCharCode(3))!=-1){var u=o.split(String.fromCharCode(4));for(var a=0;a<u.length;a++){var f=u[a].split(String.fromCharCode(3));f[1]=="T"&&f[3].length==0&&(i+=(i.length?", ":"")+f[2])}continue}if(n!=null){if(r!=null&&!Machine_isMandatoryOnThisLine(r,e[s],nlapiGetCurrentLineItemIndex(r))||r==null&&!nlapiGetFieldMandatory(e[s]))continue;isValEmpty(o)&&(i+=(i.length?", ":"")+t[s])}else{if(!getRequired(e[s]))continue;isSelect(e[s])||isPopupSelect(e[s])?(o=getSelectValue(e[s]),isValEmpty(o)&&(i+=(i.length?", ":"")+t[s])):window.getHtmlEditor!=null&&getHtmlEditor(e[s].name)!=null?isValEmpty(e[s].value.replace("<DIV></DIV>",""))&&(i+=(i.length?", ":"")+t[s]):isempty(e[s])&&(i+=(i.length?", ":"")+t[s])}}return i}function checkUniqueFields(e,t,n){if(t==null||t.length==0)return null;for(var r=1;r<=nlapiGetLineItemCount(e)+1;r++){if(r==nlapiGetCurrentLineItemIndex(e))continue;var i=!0,s=!0;for(var o=0;o<t.length;o++){var u=t[o];isValEmpty(getEncodedValue(e,r,u))||(i=!1);if(getEncodedValue(e,r,u)!=nlapiGetCurrentLineItemValue(e,t[o])){s=!1;break}}if(i||!s)continue;var a=new Array;for(var f=0;f<t.length;f++)a.push(n[f]);return a}return null}function checkccnumber(fld){var cardnum=typeof fld!="string"?fld.value:nlapiGetFieldValue(fld);cardnum.length>0&&(cardnum=cardnum.replace(/ /gi,"")),cardnum.length>0&&(cardnum=cardnum.replace(/-/gi,""));if(cardnum.length<13||cardnum.length>20)return alert(NLAlertContext_CREDIT_CARD_NUMBERS_MUST_CONTAIN_BETWEEN_13_AND_20_DIGITS),!1;if(!onlydigits(cardnum))return alert(NLAlertContext_CREDIT_CARD_NUMBERS_MUST_CONTAIN_ONLY_DIGITS),!1;var no_digit=cardnum.length,oddoeven=no_digit&1,sum=0;for(var count=0;count<no_digit;count++){var digit=parseInt(cardnum.charAt(count),10);count&1^oddoeven||(digit*=2,digit>9&&(digit-=9)),sum+=digit}return sum%10!=0?(alert(NLAlertContext_CREDIT_CARD_NUMBER_IS_NOT_VALID__PLEASE_CHECK_THAT_ALL_DIGITS_WERE_ENTERED_CORRECTLY),!1):(eval(typeof fld!="string"?"fld.value = cardnum":"nlapiSetFieldValue(fld, cardnum, false)"),!0)}function setPreferredFields(e,t,n,r){if(getEncodedValue(e,r,t)=="T")for(var i=1;i<=getLineCount(e)+1;i++)i!=r&&getEncodedValue(e,i,t)=="T"&&(n==null||getEncodedValue(e,r,n)==getEncodedValue(e,i,n))&&setEncodedValue(e,i,t,"F");return!0}function escapeJSONChar(e){if(e=='"'||e=="\\")return"\\"+e;if(e=="\b")return"\\b";if(e=="\f")return"\\f";if(e=="\n")return"\\n";if(e=="\r")return"\\r";if(e=="	")return"\\t";var t=e.charCodeAt(0).toString(16);return t.length==1?"\\u000"+t:t.length==2?"\\u00"+t:t.length==3?"\\u0"+t:"\\u"+t}function escapeJSONString(e){var t=e.split("");for(var n=0;n<t.length;n++){var r=t[n];if(r=='"'||r=="\\"||r.charCodeAt(0)<32||r.charCodeAt(0)>=128)t[n]=escapeJSONChar(t[n])}return'"'+t.join("")+'"'}toJSON=function toJSON(e){if(e==null)return"null";if(e.constructor==String||e.constructor.name=="String")return escapeJSONString(e);if(e.constructor==Number||e.constructor.name=="Number")return e.toString();if(e.constructor==Boolean||e.constructor.name=="Boolean")return e.toString();if(e.constructor==Date||e.constructor.name=="Date")return'{javaClass: "java.util.Date", time: '+e.valueOf()+"}";if(e.constructor==Array||e.constructor.name=="Array"||e.length>=0){var t=[];for(var n=0;n<e.length;n++)t.push(toJSON(e[n]));return"["+t.join(", ")+"]"}var t=[];for(attr in e)e[attr]==null?t.push('"'+attr+'": null'):typeof e[attr]!="function"&&t.push(escapeJSONString(attr)+": "+toJSON(e[attr]));return"{"+t.join(", ")+"}"};function getQtyRate(e,t,n){var r=e.split(String.fromCharCode(5)),i,s=0,o;for(i=0;i<r.length;i+=2){if(t>=parseFloat(r[i])&&(i+2>=r.length||t<parseFloat(r[i+2]))){n&&t>0?(s+=(t-parseFloat(r[i]))*parseFloat(r[i+1]),o=s/t):o=r[i+1];break}n&&t>0&&(s+=(parseFloat(r[i+2])-parseFloat(r[i]))*parseFloat(r[i+1]))}return o}function parseFloatOrZero(e){var t=parseFloat(e);return isNaN(t)?0:t}function isValidUSZipCode(e){var t=/^\d{5}([\-]\d{4})?$/;return t.test(e)}function checkemail(e,t,n){return e=trim(e),checkemail2(e,e,t,n)}function checkemail2(e,t,n,r){var i=e;return i!=t?(alert(NLAlertContext_EMAIL_ADDRESSES_MUST_MATCH),!1):n&&i.length==0?!0:checkemailvalue(i,r)}function checkemailvalue(e,t){return t=!0,/\s|[,":<>]/.test(e)?(t&&alert(NLAlertContext_PLEASE_ENTER_A_VALID_EMAIL_ADDRESS+" "+NLAlertContext_NETSUITE_DOES_NOT_ACCEPT_EMAIL_ADDRESSES_WITH_QUOTATION_MARKS_COMMAS_COLONS_SPACES_OR_GREATER_THAN_OR_LESS_THAN_SIGNS),!1):NLValidationUtil_SIMPLE_EMAIL_PATTERN.test(e)?!0:(t&&alert(e+" "+NLAlertContext_PLEASE_ENTER_A_VALID_EMAIL_ADDRESS),!1)}function checkemailprefix(e){return/^[^@]+@[^@]*$/.test(e)&&!/\s|[,":<>]|[.][.]/.test(e)}function checkvalnotempty(e,t){return isValEmpty(e)?(t&&alert(t),!1):!0}function checkpassword(e,t,n,r,i,s,o){var u=r==1||r==null,a=getpassworderror(e,t,u,i,s,o);return a!=null?(n&&alert(a),!1):!0}function getpassworderror(e,t,n,r,i,s){var o=n==1||n==null,u=e;i==null&&(i=6),msg="",e!=t?msg+=NLAlertContext_PASSWORDS_DONT_MATCHN:o?(u.length<i&&(msg+=NLAlertContext_PASSWORDS_MUST_BE_AT_LEAST_1_CHARACTERS_LONGN.replace("{1}",String(i))),/[A-Za-z]/.test(u)||(msg+=NLAlertContext_PASSWORDS_MUST_CONTAIN_AT_LEAST_ONE_LETTER_AZN),/[0-9!@#$%^&*.:;~'`*",_|= \<\>\/\\\+\?\-\(\)\[\]\{\}]/.test(u)||(msg+=NLAlertContext_PASSWORDS_MUST_CONTAIN_AT_LEAST_ONE_NUMBER_OR_SPECIAL_CHARACTERN),/^[A-Za-z0-9!@#$%^&*.:;~'`*",_|= \<\>\/\\\+\?\-\(\)\[\]\{\}]+$/.test(u)||(msg+=NLAlertContext_PASSWORDS_MAY_CONTAIN_ONLY_LETTERS_NUMBERS_AND_SPECIAL_CHARACTERSN)):u.length==0&&(msg=NLAlertContext_PASSWORDS_CANNOT_BE_EMPTYN);if(msg.length==0&&r!=null){var a=r,f=0;for(var l=0;l<u.length;l++){var c=u.charAt(l);a.indexOf(c)==-1&&f++}f<2&&(msg=NLAlertContext_OLD_AND_NEW_PASSWORDS_ARE_TOO_SIMILAR)}return msg.length==0&&s!=null&&s==e&&(msg=NLAlertContext_PASSWORD_MUST_NOT_BE_THE_SAME_AS_THE_EMAIL_ADDRESS),msg.length>0?msg:null}function validate_AbaRoutingNumber(e){if(e==null||e.length==0)return NS.form.setValid(!0),!0;var t=9,n=!0,r="";e.length!=t&&(r=NLAlertContext_ABA_ROUTING_NUMBERS_MUST_BE_NINE_CHARACTERS,n=!1);var s=e,o=0;for(i=0;i<s.length;i+=3)o+=parseInt(s.charAt(i),10)*3+parseInt(s.charAt(i+1),10)*7+parseInt(s.charAt(i+2),10);return o!=0&&o%10==0?n=!0:(r=NLAlertContext_THE_SPECFIED_ROUTING_NUMBER_FAILED_VALIDATION_FOR_ABA_ROUTING_NUMBERS+"("+e+")",n=!1),r!=""&&alert(r),NS.form.setValid(n),n}function stringContainsCJKChar(e){if(e==null||e.length==0)return!1;var t=!1;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=12352&&r<=40959||r>=44032&&r<=55215){t=!0;break}}return t}function nlOpenWindow(e,t,n,r,i,s){return window.doPageLogging&&logStartOfRequest("popup"),isValEmpty(n)?window.open(e,t):isNaN(parseInt(n))?window.open(e,t,n):isIE?window.open(e,t,"scrollbars="+(s?"yes":"no")+",width="+Math.min(screen.availWidth,n)+",height="+Math.min(screen.availHeight-40,r)+",left="+Math.min(screen.availWidth-n,getObjectLeft(i))+",top="+Math.min(screen.availHeight-40-r,getObjectTop(i))+",resizable=yes"):window.open(e,t,"scrollbars="+(s?"yes":"no")+",width="+n+",height="+r+",resizable=yes")}function nlExtOpenDivWindow(e,t,n,r,i,s,o,u,a,f,l){var c="<div id='"+e+"_framediv'></div>";u!=null&&typeof u!="undefined"&&(c=u),f!=null&&typeof f!="undefined"&&(c=f+"<div style='width:100%;float:left;clear:left;' id='"+e+"_framediv'>");var h=null,p=null;a!=null&&typeof a!="undefined"&&(h=findGlobalPosX(a),p=findGlobalPosY(a));var d={title:s!=undefined?s:e,id:e,name:e,stateful:!1,modal:!0,autoScroll:!1,width:t,height:n,style:"background-color: #FFFFFF;",bodyStyle:"background-color: #FFFFFF;",resizable:!0,listeners:o,bodyCfg:{tag:"center",name:e+"_frame",id:e+"_frame",html:c,width:t+"px",height:n+"px",style:"border:none;background-color: #FFFFFF;"}};jQuery.extend(d,l);var v=new Ext.Window(d);return!isValEmpty(h)&&!isValEmpty(p)&&(v.x=h,v.y=p),v.show(),v.syncSize(),v}function nlOpenIframe(e,t,n){n||(n=new Object);var r=jQuery.Deferred(),i=t,s=jQuery("#"+i);return s.length==0&&(jQuery("<iframe/>",{id:i,tabindex:-1,style:"display: none",height:0,width:0}).appendTo("body"),s=jQuery("#"+i),n.onload&&s.on("onload",function(e,t){n.onload(t)}),s.load(function(){r.resolve(),jQuery(this).trigger("onload",[jQuery(this)])}),n.beforeclose&&s.on("beforeclose",function(e){n.beforeclose()})),s.load(r.resolve),s.data("iframeid",i),s.attr("src",e),r.promise()}function nlExtOpenWindow(e,t,n,r,i,s,o,u,a){e=addParamToURL(e,"ifrmcntnr","T",!0),u||(u={}),window.doPageLogging&&logStartOfRequest("extpopup");var f=null,l=null;a!=null&&typeof a!="undefined"&&(f=findPosX(a),l=findPosY(a));var c=new Ext.Window({title:o!=undefined?o:t,id:t,name:t,stateful:!1,modal:!0,autoScroll:s,width:parseInt(""+n)+20,height:parseInt(""+r)+30,style:"background-color: #FFFFFF;",bodyStyle:"background-color: #FFFFFF;",resizable:!0,listeners:u,bodyCfg:{tag:"iframe",name:t+"_frame",id:t+"_frame",src:e,width:n+4+"px",height:r+"px",style:"border: 0 none; background-color: #FFFFFF;"}});!isValEmpty(f)&&!isValEmpty(l)&&(c.x=f,c.y=l),c.show(),c.syncSize()}function getObjectLeft(e){var t=0;while(e!=null&&e!=document.body)t+=e.offsetLeft,e=e.offsetParent;return t+(isIE?window.screenLeft:window.screenX+window.outerWidth-window.innerWidth)}function getObjectTop(e){var t=0;while(e!=null&&e!=document.body)t+=e.offsetTop,e=e.offsetParent;if(isIE)return t+window.screenTop;var n=0;return typeof window.statusbar!="undefined"&&window.statusbar!=null&&window.statusbar.visible&&(n=20),t+window.screenY+window.outerHeight-window.innerHeight-n}function setFieldVisibility(e,t){var n=document.getElementById(e);visible(n,t)}function setLabelVisibility(e,t){var n=document.getElementById(e+"_lbl");visible(n,t)}function setFieldAndLabelVisibility(e,t){setLabelVisibility(e,t),setFieldVisibility(e,t)}function showLabel(e,t){var n=document.getElementById(e+"_lbl");if(t){var r=!!NS&&!!NS.UI&&!!NS.UI.Helpers&&!!NS.UI.Helpers.getClosestAncestorFromClass&&NS.UI.Helpers.getClosestAncestorFromClass(document.getElementById(e),"uir-field-wrapper");r&&display(r,t)}display(n,t)}function showHelperText(e,t){var n=document.getElementById(e+"_hlp");display(n,t)}function setLabel(e,t){var n=document.getElementById(e+"_lbl");if(n==null)return;var r=n,i=r.getElementsByTagName("A");i.length>0&&(r=i[0]),r.innerHTML=t}function getLabel(e){var t=document.getElementById(e+"_lbl");return t==null?null:t.getElementsByTagName("a")!=null&&t.getElementsByTagName("a").length==1?t.getElementsByTagName("a").item(0).innerHTML:t.innerHTML}function showFieldAndLabel(e,t){window.nlentryform&&window.nlentryform.trackFieldVisibility(e,t);var n=!!NS&&!!NS.UI&&!!NS.UI.Helpers&&!!NS.UI.Helpers.getClosestAncestorFromClass&&NS.UI.Helpers.getClosestAncestorFromClass(document.getElementById(e),"uir-field-wrapper");!n||display(n,t),showLabel(e,t),showField(e,t)}var ns_tabUtils=function(){function e(){return!1}function t(e){r(e,this.isEmpty(e))}function n(e){return jQuery("#"+e+":visible").length>0}function r(e,t){var n=document.getElementById(e+"_pane")!=null?"_pane":"lnk",r=ns_tabUtils.isTabAreaVisible(e+n);if(r!==t)return;var i=t?"none":"",s=["upperlt","uppermiddot","uppermid","upperrt","lt","lnkdot","lnk","rt","_umh"];for(var o=0;o<s.length;++o){var u=document.getElementById(e+s[o]);u!=null&&(u.style.display=i)}var u=document.getElementById(e+"_pane");u!=null?u.style.display=i:(u=document.getElementById(e+"_layer"),u!=null&&(u.style.display=i))}return{updateTabVisibility:t,isEmpty:e,isTabAreaVisible:n,hideTab:r}}();function setRichTextEditorValue(e,t,n){var r=getHtmlEditor(e.name);r!=null&&e==r.hddn?r.initialized?r.setValue(t,!0):r.on("initialize",function(){r.setValue(t,!0)}):n>0&&setTimeout(function(){setRichTextEditorValue(e,t,n-1)},200)}function setFormValue(e,t,n,r,i){if(e==null)return;if(e.type=="checkbox")setNLCheckboxValue(e,t);else if(e.type=="radio"||e.length>0&&e[0]!=null&&e[0].type=="radio")syncradio(e,t);else if(e.type=="select-one")synclist(e,t);else if(isNLDropDown(e))getDropdown(e).setValue(t,!0);else if(isMultiSelect(e))syncmultiselectlist(e,t,null,!0);else if(isRichTextEditorUnregisteredSafe(e))window.getHtmlEditor!=null&&setRichTextEditorValue(e,t,10);else if(e.nodeName=="INPUT"||e.nodeName=="TEXTAREA"||window.virtualBrowser){var s=t!=null&&t.join!=null&&(isPopupMultiSelect(e)||isArray(t))?t.join(String.fromCharCode(5)):t;isPopupSelect(e)?syncpopup(e,s,n):isPopupMultiSelect(e)?syncmultiselectlist(e,s,n,!0):isCurrencyField(e)?setNLCurrencyValue(e,t):isNumericField(e)?setNLNumericValue(e,t):(e.value=s==null?"":s,isDisplayOnlySelect(e)&&typeof n!="undefined"&&(document.getElementById(e.name+"_displayval").innerHTML=n!=null?n.replace(new RegExp(String.fromCharCode(5),"g"),"<BR>"):""))}else e.innerHTML=t;var o=e;(isNumericField(e)||isCurrencyField(e))&&getNLNumericOrCurrencyDisplayField(e)!=null&&(o=getNLNumericOrCurrencyDisplayField(e)),o.machine?o.machine.setFieldInputValue(e.name,t,r,n):o.uiform&&o.uiform.setFieldInputValue(e.name,t,r,n);if(r)try{i&&setSlavingAsync(!1),fireProperOnChange(e)}finally{setSlavingAsync(!0)}}function getFormValue(e,t){return e==null?null:e.type=="checkbox"?e.checked?"T":"F":e.type=="radio"||e.length>0&&e[0].type=="radio"?getRadioValue(e):e.type=="select-one"||isNLDropDown(e)?getSelectValue(e):isMultiSelect(e)?getMultiSelectValues(e,t):isRichTextEditor(e)?e.value:t&&e.value!=null&&isPopupMultiSelect(e)?e.value.split(String.fromCharCode(5)):e.value}function getParameter(e,t){if(typeof t=="undefined"||t==null)t=document;var n=new RegExp(".*[?&]"+e+"=([^&]*)"),r=n.exec(t.location.href.toString());return r!=null&&r.length>0?decodeURIComponent(r[1]):null}function getParam(e){return param=getParameter(e),param&&param.indexOf("#")>-1&&(param=param.substring(0,param.lastIndexOf("#"))),param}function getBooleanParameter(e){return getParameter(e)=="T"}function getParameterValuesArray(){var e=document.location.href.toString();if(e.indexOf("?")<0)return null;var t=e.substring(e.indexOf("?")+1).split("&"),n=new Array;for(var r=0;r<t.length;r++){var i=t[r].split("=");n[n.length]=i[0],n[n.length]=i.length>0?i[1]:null}return n}function getFormElement(e,t,n){var r=null;if(e!=null)if(t=="language"||!isBackend&&(t=="item"||t=="cash")){for(var i=0;i<e.elements.length;i++)if(e.elements[i].name==t){r=e.elements[i];break}}else n&&n=="inlinehtml"?r=document.getElementById(t+"_val"):e.elements!=null&&(r=e.elements[t]);return r}function getFormElementViaFormName(e,t){return getFormElement(document.forms[e],t)}var isBackend=!1,isIE=isBackend||!1,isIE11=!1,isNS=document.addEventListener?!0:!1;function findGlobalPosX(e,t){var n=0;if(document.getElementById||document.all){while(e.offsetParent)n+=e.offsetLeft,e=e.offsetParent;e.document!=null&&e.document.parentWindow!=null&&e.document.parentWindow.frameElement&&(n+=findGlobalPosX(e.document.parentWindow.frameElement))}else document.layers&&(n+=e.y);return n}function findGlobalPosY(e){var t=0;if(document.getElementById||document.all){while(e.offsetParent)t+=e.offsetTop,e=e.offsetParent;e.document!=null&&e.document.parentWindow!=null&&e.document.parentWindow.frameElement&&(t+=findGlobalPosY(e.document.parentWindow.frameElement))}else document.layers&&(t+=e.y);return t}function findAbsolutePosX(e){var t=0;if(document.getElementById||document.all)while(e.offsetParent)t+=e.offsetLeft,e.offsetParent!=document.body&&(t-=e.offsetParent.scrollLeft),e=e.offsetParent;else document.layers&&(t+=e.x);var n=window.parentAccesible&&!1;return n?parent.Ext.WindowMgr.getActive().x+t:t}function findAbsolutePosY(e){var t=0;if(document.getElementById||document.all)while(e.offsetParent)t+=e.offsetTop,e.offsetParent!=document.body&&(t-=e.offsetParent.scrollTop),e=e.offsetParent;else document.layers&&(t+=e.y);var n=window.parentAccesible&&!1;return n?parent.Ext.WindowMgr.getActive().y+t:t}function findPosX(e){var t=0,n=window.parentAccesible&&parent&&parent.Ext,r=n?parent.Ext.WindowMgr.getActive()!=null:!1;if(r&&(parent.Ext.isSafari||parent.Ext.isChrome))t=e.offsetParent.offsetLeft;else if(document.getElementById||document.all)while(e.offsetParent)t+=e.offsetLeft,e=e.offsetParent;else document.layers&&(t+=e.x);return t}function findPosY(e){var t=0;if(document.getElementById||document.all)while(e.offsetParent)t+=e.offsetTop,e=e.offsetParent;else document.layers&&(t+=e.y);return t}function getParentElementByTag(e,t){if(!e)return null;var n=t;while(n!=null){if(n.tagName.toLowerCase()==e.toLowerCase())return n;if(n==n.parentNode)break;n=n.parentNode}return null}function contains(e,t){var n=t;while(n!=null){if(n==e)return!0;n=n.parentNode}return!1}function fireProperOnChange(e,t){e!=null&&(t==null&&(t=window),e.getAttribute("onChangeFunc")?t.localEval(e.getAttribute("onChangeFunc").replace(/this/g,"document.forms."+e.form.name+"."+e.name)):e.type!="checkbox"&&e.type!="radio"||!e.onclick?e.onchange&&e.onchange():e.onclick())}function getInlineTextValue(e){if(typeof e=="undefined"||e==null)return"";var t="";return e.innerText?t=e.innerText:t=e.innerHTML.replace(/<br>/gi,"\n").replace(/(<([^>]+)>)/gi,""),t}function setInlineTextValue(e,t){if(e==null)return;e.innerHTML=t}function findUp(e,t){while(e!=null&&e.nodeName!=t)e=e.parentNode;return e}function getEvent(e){return typeof e!="undefined"&&e?e:typeof event!="undefined"&&event?event:null}function getEventKeypress(e){return e=getEvent(e),e.which?e.which:e.keyCode}function getEventAltKey(e){return e=getEvent(e),e&&typeof e.altKey!="undefined"?e.altKey:typeof event!="undefined"&&typeof event.altKey!="undefined"?event.altKey:!1}function getEventMacCommandKey(e){return e.metaKey}function getEventCtrlKey(e){return e=getEvent(e),e?e.ctrlKey:!1}function getEventShiftKey(e){return e=getEvent(e),e?e.shiftKey:!1}function getEventTarget(e){e=getEvent(e);if(e){if(e.srcElement)return e.srcElement;if(e.target)return e.target}return null}function getEventTargetType(e){return e=getEventTarget(e),e?e.type:null}function setEventPreventDefault(e){e=getEvent(e),e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}function setEventCancelBubble(e){e=getEvent(e),e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)}function restoreHtmlEditors(e){if(typeof NetSuite=="object"&&typeof NetSuite.RTEManager=="object"){var t=document.forms.main_form!=null&&document.forms.main_form.elements.nlapiVF!=null?document.forms.main_form.elements.nlapiVF.value:null;try{t!=null&&(document.forms.main_form.elements.nlapiVF.value=""),NetSuite.RTEManager.getMap().eachKey(function(t,n){var r=n.obj;(e==null||r.hddn.form==e)&&r.setValue(r.hddn.value)})}finally{t!=null&&(document.forms.main_form.elements.nlapiVF.value=t)}}}function nlFieldHelp(e,t,n){var r="/core/help/fieldhelp.nl?fld="+t+"&perm="+e,i="fieldhelp",s=350,o=150;if(n!=null)var u=Math.min(screen.availWidth-s,getObjectLeft(n)),a=Math.min(screen.availHeight-40-o,getObjectTop(n)+n.offsetHeight);var f=window[i];return typeof f=="undefined"||f==null||f.closed?f=window.open(r,i,"scrollbars="+(isIE?"no":"yes")+",width="+Math.min(screen.availWidth,s)+",height=50,left="+u+",top="+a+",resizable=yes"):(f.location=r,f.moveTo(u,a)),f.focus(),window[i]=f,!1}function dumpObj(e){for(var t in e){var n=t+": "+e[t];document.body.appendChild(document.createTextNode(n)),document.body.appendChild(document.createElement("BR"))}e.style&&(document.body.appendChild(document.createTextNode("STYLE:")),document.body.appendChild(document.createElement("BR")),dumpObj(e.style))}function NLAlert(e,t){alert(e)}var global_parseFloat=parseFloat;parseFloat=function(e){return e&&e.toString()==""?NaN:global_parseFloat(e)};function nsapiIsString(e){return typeof e=="string"||e instanceof String||nsapiInstanceOf(e,"String")}function nsapiInstanceOf(e,t){if(typeof e=="undefined"||e===null)return!1;var n=Object.prototype.toString.call(e);if(n.slice(8,-1)===t)return!0;if(typeof e.constructor=="undefined")return!1;if(typeof e.constructor.name!="undefined")return e.constructor.name===t;var r=/^function ([^( ]+)/.exec(e.constructor.toString());return!!r&&r[1]==t}function arrayIndexOf(e,t,n){for(var r=0;e!=null&&r<e.length;r++)if(t==e[r]||n&&t!=null&&e[r]!=null&&t.toLowerCase()==e[r].toLowerCase())return r;return-1}function arrayContains(e,t){return arrayIndexOf(e,t)>=0}function arrayAdd(e,t){arrayContains(e,t)||e.push(t)}function arrayRemove(e,t){var n=new Array;for(var r=0;r<e.length;r++)t!=e[r]&&n.push(e[r]);return n}function getArrayIntersection(e,t){var n=new Array;for(var r=0;r<e.length;r++)for(var i=0;i<t.length;i++)if(e[r]==t[i]){n[n.length]=e[r],t[i]=null;break}return n}function isArray(e){return e instanceof Array||nsapiInstanceOf(e,"Array")}function nsapiEveryElementIs(e,t){if(!isArray(e))return!1;for(var n=0;n<e.length;++n)if(!t(e[n]))return!1;return!0}function nsapiMap(e,t){var n=[];for(var r=0;r<e.length;++r)n.push(t(e[r]));return n}function nsapiIsSearchFilterExpression(e){return nsapiEveryElementIs(e,nsapiIsSearchFilterTerm)}function nsapiIsFlatSearchFilterList(e){return nsapiEveryElementIs(e,nsapiIsSearchFilterObject)}function nsapiIsSearchFilterTerm(e){return typeof e=="undefined"||!e?!1:nsapiIsString(e)?/not|and|or/i.test(e):nsapiIsSearchFilterArray(e)?!0:nsapiIsSearchFilterExpression(e)}function nsapiNormalizeFilters(e){return nsapiIsSearchFilter(e)?[e]:typeof e=="undefined"?null:e}function nsapiIsSearchFilter(e){return nsapiIsSearchFilterObject(e)||nsapiIsSearchFilterArray(e)}function nsapiIsSearchFilterObject(e){return e instanceof nlobjSearchFilter||nsapiInstanceOf(e,"nlobjSearchFilter")}function nsapiIsSearchFilterArray(e){return isArray(e)&&e.length>=3&&nsapiIsString(e[0])&&nsapiIsString(e[1])&&!/^not$/i.test(e[0])}function nsapiCheckSearchFilterExpression(e,t){nsapiAssertTrue(e===null||nsapiIsSearchFilterExpression(e),"SSS_INVALID_SRCH_FILTER_EXPR_OBJ_TYPE",t)}function nsapiCheckSearchFilterListOrExpression(e,t){nsapiAssertTrue(e===null||nsapiIsFlatSearchFilterList(e)||nsapiIsSearchFilterExpression(e),"SSS_INVALID_SRCH_FILTER_EXPR_OBJ_TYPE",t)}function format_message(e){var t=format_message.arguments.length,n=1;if(e.length>=3&&e.substring(0,3)=="@@@"){var r=e.substring(3).split(/\s*\|\|\s*/),i=0;t>=2&&(i=format_message.arguments[1],typeof i=="boolean"?i=i?0:1:typeof i=="string"&&(i=parseInt(i)),typeof i!="number"&&(i=0)),i>=r.length&&(i=0),e=r[i],n=2}else if(e.length>=2&&e.substring(0,2)=="@@")return"?";var s=format_message.arguments;return t==n+1&&format_message.arguments[n].constructor==Array&&(s=format_message.arguments[n],n=0,t=s.length),e.replace(/{(?:(\d+)|:)[^}]*}/g,function(e,r){var i=r?parseInt(r)-1+n:t;return i<t?s[i]:""})}function nlInsertCanvas(e){var t=document.getElementById(getCanvasId(e));t==null&&(t=document.createElement("IFRAME"),t.id=getCanvasId(e),t.src="javascript:false",t.scrolling="no",t.style.display="none",t.style.frameBorder="0",isIE&&(t.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)"),t.style.position="absolute",t.style.top="0px",t.style.left="0px",document.body.appendChild(t)),nlSyncCanvas(e),t.style.display="block"}function nlSyncCanvas(e){var t=document.getElementById(getCanvasId(e));if(t==null)return;t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px",t.style.top=e.style.top+"px",t.style.left=e.style.left+"px",t.style.zIndex=e.style.zIndex-1}function nlRemoveCanvas(e){var t=document.getElementById(getCanvasId(e));t!=null&&document.body.removeChild(t)}function getCanvasId(e){return e.id+"_canvas"}function findClassUp(e,t){while(e!=null&&e.className!=t&&e.classAlias!=t)e=e.parentNode;return e}function getScrollLeftOffset(e){var t=0,n;return e!=null&&(n=findClassUp(e,"scrollarea"))!=null?t=n.scrollLeft:(n=document.getElementById("div__body"))!=null&&(t=n.scrollLeft),t}function getScrollTopOffset(e){var t=0,n;return e!=null&&(n=findClassUp(e,"scrollarea"))!=null?t=n.scrollTop:(n=document.getElementById("div__body"))!=null&&(t=n.scrollTop),t}function removeAllChildren(e){while(e.childNodes[0])e.removeChild(e.childNodes[0])}function StringBuffer(){this.buffer=[]}StringBuffer.prototype.append=function(e){return this.buffer.push(e),this},StringBuffer.prototype.toString=function(){return this.buffer.join("")};function setObjectOpacity(e,t){var n=t.style;n.opacity=e/100,n.MozOpacity=e/100,n.filter="alpha(opacity="+e+")"}function fadeObjectOpacity(e,t,n,r){var s=Math.round(r/100),o=0;if(t>n)for(i=t;i>=n;i--)setTimeout(function(){setObjectOpacity(i,e)},o*s),o++;else if(t<n)for(i=t;i<=n;i++)setTimeout(function(){setObjectOpacity(i,e)},o*s),o++}function tellafriend(e,t,n,r,i,s,o){var u=escape(t)+",%0d%0a%0d%0a";u+=escape(n)+escape(location.hostname)+".%0d%0a%0d%0a",u+=escape(r)+escape(document.title)+".%0d%0a",u+=escape(i)+escape(o)+"%0d%0a",u+=escape(s)+escape(location.href)+"%0d%0a",location.href="mailto:?subject="+escape(e)+"&body="+u}function isLeftButtonDown(e){var t=!1,n=getEvent(e);if(isIE&&n.button==1||!isIE&&n.button==0)t=!0;return t}function isRightButtonDown(e){var t=!1,n=getEvent(e);return n.button==2&&(t=!0),t}function getSelectedTextRange(e){var t,n;if(document.all){var r=document.selection.createRange(),i=r.duplicate();i.moveToElementText(e),i.setEndPoint("EndToEnd",r),t=i.text.length-r.text.length,n=t+r.text.length}else t=e.selectionStart,n=e.selectionEnd;var i=new Array;return i[0]=t,i[1]=n,i}function insertTextAtCursor(e,t){e.focus();if(document.all){var n=document.selection.createRange();n.text=t,n.scrollIntoView(!0)}else{var r=e.selectionStart,i=e.selectionEnd;e.value=e.value.substring(0,r)+t+e.value.substring(i),e.selectionEnd=e.selectionStart+t.length,e.selectionStart=e.selectionEnd}}function setWindowChanged(e,t){e.NS.form.setChanged(t)}function escapeHTML(e){var t=document.createElement("div"),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML}function escapeHTMLAttr(e){var e=escapeHTML(e);return e.replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function getRuntimeSize(e,t){var n=getRuntimeStyle(e,t);return n?(n=n.replace("px",""),isNaN(n)?0:n*1):0}function getRuntimeStyle(e,t){var n=null;return typeof e=="string"&&(e=document.getElementById(e)),e==null?n:(window.getComputedStyle?n=document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle&&(n=e.currentStyle[t]),n=="auto"&&(t=="height"?n=e.offsetHeight:t=="width"&&(n=e.offsetWidth)),n)}function camelize(e){var t=e.split("-"),n=t.length;if(n==1)return t[0];var r=e.charAt(0)=="-"?t[0].charAt(0).toUpperCase()+t[0].substring(1):t[0];for(var i=1;i<n;i++)r+=t[i].charAt(0).toUpperCase()+t[i].substring(1);return r}function eval_js(sScript){sScript=sScript.replace(/^\s*<!--[\s\S]*?-->\s*$/gm,"");try{return eval(sScript)}catch(e){e instanceof SyntaxError}}var slave_machines=new Array;function process_slaving_result(e){var t=e.getBody(),n=t.split("<machine");for(var r=1;r<n.length;r++){var i=n[r].indexOf("name='")+6,s=n[r].substring(i,n[r].indexOf("'>",i));slave_machines[s]=n[r].substring(n[r].indexOf("'>")+2,n[r].lastIndexOf("</machine>"))}var o=n[0];eval_js(o),slave_machines=new Array}var process_slaving_result_original=process_slaving_result,performSlavingAsync=!0;function setSlavingAsync(e){performSlavingAsync=e}function getSlavingAsync(){return performSlavingAsync}function loadSlavingResults(e,t,n){var r=process_slaving_result;!t||(typeof t=="function"?r=function(){process_slaving_result.apply(this,arguments),t.apply(this,arguments)}:Object.prototype.toString.call(t)==="[object Array]"&&(r=function(e){var n=0;process_slaving_result.apply(this,arguments);while(n<t.length)t[n++].apply(this,arguments)}));if(typeof n=="undefined"||n===null)n=getSlavingAsync();nlXMLRequestURL(e,null,null,r,n)}function execute_js(e,t){eval_js(e.getBody()),t&&t()}function NLGetCurrentScriptFileHostName(){var e=document.getElementsByTagName("script");if(!e||e.length==0)return null;var t=e[e.length-1].src;if(!t)return null;var n=t.match(/^((http|https):\/\/)?[^\/]+/g);return n&&n.length>0&&(n=n[0]),n||(n=""),n}function NLLoadScriptInScriptTag(e,t,n){n||(n=document);var r=n.getElementById(t);if(!r){var i=n.getElementsByTagName("head")[0];r=n.createElement("script"),r.type="text/javascript",i.appendChild(r)}r.src=e}function loadXMLJSDoc(e,t){nlXMLRequestURL(e,null,null,function(e){execute_js(e,t)},!0)}function nlXMLRequestURL(e,t,n,r,i){var s=new NLXMLHttpRequest;r instanceof Function&&s.setResponseHandler(r);var o=s.requestURL(e,t,n,i);return o}function NLXMLHttpRequest(e){this.requestPending=!1,this.callbackFunc=null,this.ignoreResponseErrors=e;if(window.XMLHttpRequest)this.xmlrequest=new XMLHttpRequest;else try{this.xmlrequest=new ActiveXObject("Msxml2.XMLHTTP.4.0")}catch(t){this.xmlrequest=isOffline()?null:new ActiveXObject("Msxml2.XMLHTTP")}}NLXMLHttpRequest.prototype.setResponseHandler=function(e){this.callbackFunc=typeof e=="function"?e:null},NLXMLHttpRequest.prototype.requestURL=function(e,t,n,r,i){if(this.requestPending)return;this.requestPending=!0;var s;isValEmpty(i)?s=t!=null?"POST":"GET":s=i,this.xmlrequest.open(s,e,r!=null?r:!1);for(var o in n)this.xmlrequest.setRequestHeader(o,n[o]);this.xmlrequest.setRequestHeader("NSXMLHttpRequest","NSXMLHttpRequest");if(s=="POST"||s=="PUT")t instanceof String||typeof t=="string"||nsInstanceofDocument(t)?this.xmlrequest.setRequestHeader("Content-Type","text/xml; charset=UTF-8"):(t=formEncodeURLParams(t),this.xmlrequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"));var u=null;return r?(this.xmlrequest.onreadystatechange=this.handleResponse.bindAsEventListener(this),this.xmlrequest.send(t)):(this.xmlrequest.send(t),u=this.handleResponse()),u},NLXMLHttpRequest.prototype.handleResponse=function(){var e=null;if(this.xmlrequest.readyState==4){var t=this.xmlrequest.status,n=this.xmlrequest.responseText,r=new Array,i=this.xmlrequest.getAllResponseHeaders(),s=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/gm,"")},o=function(e){return e?(e=s.call(e),e&&e.indexOf("{")===0&&e.lastIndexOf("}")===e.length-1):!1};i=i.replace(/^\s+/,"").replace(/\s+$/,"").split("\n");for(var u=0;u<i.length;u++){var a=i[u].split(":"),f=a[0],l=r[f];l==null&&(l=new Array,r[f]=l),l[l.length]=a[1]}var c=null;if(n&&n.toLowerCase().indexOf("error")>=0){if(o(n)){if(n.indexOf('{"error"')>=0){var h=JSON.parse(n);c=new NLXMLResponseError(h.error.code,h.error.message)}}else if(n.indexOf("<onlineError>")>=0){var h=nsStringToXML(n);c=new NLXMLResponseError(nsSelectValue(h,"/onlineError/code"),nsSelectValue(h,"/onlineError/detail"),nsSelectValue(h,"/onlineError/id"))}else if(n.indexOf("<error>")>=0){var h=nsStringToXML(n);c=new NLXMLResponseError(nsSelectValue(h,"/error/code"),nsSelectValue(h,"/error/message"))}else if(n.indexOf("error code:")>=0&&n.indexOf("error message:")>=0&&t!=200){var h=n.split("\n");c=new NLXMLResponseError(h[0].substring("error code: ".length),h[1].substring("error message: ".length))}}else t!=200&&t!=206&&(c=new NLXMLResponseError("SERVER_RESPONSE_ERROR",n));try{if(c!=null&&this.callbackFunc==null&&!this.ignoreResponseErrors)throw c;e=new NLXMLResponse(t,n,r,c),this.callbackFunc!=null&&this.callbackFunc(e)}finally{this.requestPending=!1}}return e};function NLXMLResponse(e,t,n,r){this.code=e,this.body=t,this.headers=n,this.error=r,this.getCode=function(){return this.code},this.getBody=function(){return this.body},this.getError=function(){return this.error},this.getHeaders=function(){return this.headers}}function NLXMLResponseError(e,t,n){this.id=n,this.code=e,this.details=t,this.getId=function(){return this.id},this.getCode=function(){return this.code},this.getDetails=function(){return this.details}}function nsServerCall(e,t,n,r,i){var s=new NLJsonRpcClient(e);return s.sendRequest(t,n,r,i)}NLJsonRpcClient=function(e){e.indexOf("?")>0?e+="&jrr=T":e+="?jrr=T",this.serverURL=e,this.responseCallbackMap={}},NLJsonRpcClient.requestId=0,NLJsonRpcClient.prototype={sendRequest:function(e,t,n,r){r=r||"GET";var i={id:NLJsonRpcClient.requestId++,method:"remoteObject."+e,params:t||[]};n!=null&&(this.responseCallbackMap[i.id]=n);var s=new NLXMLHttpRequest;n!=null&&s.setResponseHandler(this.handleResponseAsync.bindAsEventListener(this));var o=this.serverURL,u=null;"GET"==r&&(o+="&jrid="+i.id,o+="&jrmethod="+i.method,i.params.length>0&&(o+="&jrparams="+encode(toJSON(i.params))));if("POST"==r||"GET"==r&&o.length>2083)o=this.serverURL,u=toJSON(i);var a=s.requestURL(o,u,null,n!=null?!0:!1);if(n==null){var f=this.getJsonRpcResponse(a);if(f.error)throw new NLXMLResponseError(f.error.code,f.error.trace,f.error.msg);a=f.result}return a},getJsonRpcResponse:function(nlXMLResponseObj){var jsonRpcResp=nlXMLResponseObj.getBody();return jsonRpcResp!=null&&(jsonRpcResp=jsonRpcResp.replace(/^\s*<!--[\s\S]*?-->\s*$/gm,"")),eval("jsonRpcResp = "+jsonRpcResp+";"),jsonRpcResp},handleResponseAsync:function(e){var t=this.getJsonRpcResponse(e),n=this.responseCallbackMap[t.id];this.responseCallbackMap[t.id]=null,n(t.result,t.error)}},typeof Function.prototype.bind!="function"&&(Function.prototype.bind=function(e){var t=this;return function(){t.apply(e,arguments)}}),Function.prototype.bindAsEventListener=function(e){var t=this;return function(n){t.call(e,n||window.event)}};function isOffline(){return window.isOLC!=null}function clone(e){if(typeof e!="object")return e;if(e==null)return e;var t=new Object;for(var n in e)t[n]=clone(e[n]);return t}function hoverEffectOnFocus(e){if(e.parentNode.className.indexOf("_focus")>=0)return;e.parentNode.className.indexOf("_roll")==-1?e.parentNode.className=e.parentNode.className+"_focus":e.parentNode.className=e.parentNode.className.replace("_roll","_focus")}function hoverEffectOnBlur(e){e.parentNode.className=e.parentNode.className.replace("_focus","")}function leftPadWithWrapping(e,t,n){t==null&&(t=""),e==null?e="":e=trim(e);if(n<=t.length)return t.substring(0,n);var r=t.length+e.length;if(r<=n)return t+e;var i=e.length-(r-n);return t+e.substring(0,i)+"\n"+leftPadWithWrapping(e.substring(i),t,n)}function nlFireEvent(e,t){var n="HTMLEvents";if(t=="click"||t.indexOf("mouse")==0)n="MouseEvents";var r=document.createEvent(n);return r.initEvent(t,!0,!0),!e.dispatchEvent(r)}function getOuterHTML(e){var t;return e?e.outerHTML?e.outerHTML:(t=document.createElement("div"),t.appendChild(e.cloneNode(!0)),t.innerHTML):null}function NLNumberToString(e,t){typeof t=="undefined"&&(t=window),str=e+"";if(t.groupseparator=="")return str;parts=str.split("."),integerPart=parts[0],decimalPart=parts.length>1?t.decimalseparator+parts[1]:"";var n=/(\d+)(\d{3})/;while(n.test(integerPart))integerPart=integerPart.replace(n,"$1"+t.groupseparator+"$2");return e<0&&t.negativeprefix!="-"?t.negativeprefix+integerPart.replace("-","")+decimalPart+t.negativesuffix:integerPart+decimalPart}function NLStringToNumber(e,t){if(isValEmpty(e))return"";if(e.indexOf("%")>=0)return NLStringToNumber(e.replace("%",""),t)+"%";window.groupseparator&&window.groupseparator!=""&&(e=e.replace(new RegExp("\\"+window.groupseparator,"g"),"")),window.negativeprefix!="-"&&e.indexOf(window.negativeprefix)==0&&(e="-"+e.replace(window.negativeprefix,"").replace(window.negativesuffix,"")),window.decimalseparator==","&&(e=e.replace(",","."));var n=parseFloat(e);if(isNaN(n))return NaN;if(t){var r=0,i=e.indexOf(".");i!=-1&&(r=e.length-i-1),n=n.toFixed(r)}return n}function NLStringToNormalizedNumberString(e){var t=e.indexOf(window.decimalseparator);return NLStringToNumber(e,t!=-1)+""}function showField(e,t){var n=document.getElementById(e);display(n,t);var r=!!NS&&!!NS.UI&&!!NS.UI.Helpers&&!!NS.UI.Helpers.getClosestAncestorFromClass&&NS.UI.Helpers.getClosestAncestorFromClass(document.getElementById(e),"uir-field-wrapper");t&&r&&display(r,t);if(n!=null){var i=n.parentNode;(i.nodeName=="LI"||i.nodeName=="TD"&&i.style.height=="22px")&&display(i,t)}}function display(e,t){e!=null&&(e.style.display=t?"":"none")}function isNLNumericOrCurrencyFieldRequired(e){var t=getNLNumericOrCurrencyDisplayField(e);return t?isRequiredFieldClassName(t):!1}function setNLNumericOrCurrencyFieldRequired(e,t){var n=getNLNumericOrCurrencyDisplayField(e);return n?doSetRequired(n,e.name,t):!1}function setRequired(e,t){if(isNLDropDown(e))getDropdown(e).setRequired(t);else if(isNLMultiDropDown(e))getMultiDropdown(e).setRequired(t);else if(window.getHtmlEditor!=null&&getHtmlEditor(e.name)!=null&&getHtmlEditor(e.name).setMandatory)getHtmlEditor(e.name).setMandatory(t);else if(e.form!=null&&e.form.elements[e.name+"_display"]!=null){typeof e.form.elements[e.name+"_display"].className=="undefined"&&(e.form.elements[e.name+"_display"].className="");var n=e.form.elements[e.name+"_display"].className,r=getRequired(e)?"inputreq":"input",i=t?"inputreq":"input";n.indexOf(r)<0?n=i+" "+n:n=n.replace(r,i),e.form.elements[e.name+"_display"].className=n,setFieldLabelRequired(e.id,t)}else{if(isNumericField(e)||isCurrencyField(e))return setNLNumericOrCurrencyFieldRequired(e,t);doSetRequired(e,e.id,t)}}function doSetRequired(e,t,n){typeof e.className=="undefined"&&(e.className="");var r=e.className,i=r.indexOf("inputrt")>=0,s="input"+(i?"rt":"")+(getRequired(e)?"req":""),o="input"+(i?"rt":"")+(n?"req":"");r.indexOf(s)<0?r=o+" "+r:r=r.replace(s,o),e.className=r,e.machine!=undefined&&(t=e.machine.name+"_"+t),setFieldLabelRequired(t,n)}function setFieldLabelRequired(e,t,n){if(e){e=e.replace("inpt_",""),e=e.replace("hddn_",""),e=e.replace("_fs","");var r=document.getElementById(e+"_fs_lbl");if(r){if(r.parentNode&&r.parentNode.firstChild!=r)return;if(n){var i=getParentElementByTag("form",r);if(i&&i!=n)return}var s=r.getElementsByTagName("label"),o;for(var u=0;u<s.length;u++)if(s[u].className=="uir-required-icon"){o=s[u];break}t&&!o?(o=document.createElement("label"),o.className="uir-required-icon",o.textContent="*",NS&&NS.UI&&NS.UI.Preferences&&NS.UI.Preferences.horizontalLabelsEnabled?r.insertBefore(o,r.firstChild):r.appendChild(o)):!t&&o&&r.removeChild(o)}}}function getRequired(e){return isNLDropDown(e)?getDropdown(e).getRequired():isNLMultiDropDown(e)?getMultiDropdown(e).getRequired():window.getHtmlEditor!=null&&getHtmlEditor(e.name)?getHtmlEditor(e.name).getMandatory():e.form!=null&&e.form.elements[e.name+"_display"]!=null?e.form.elements[e.name+"_display"].className!=null&&e.form.elements[e.name+"_display"].className.indexOf("inputreq")!=-1:(isNumericField(e)||isCurrencyField(e))&&e.name.indexOf("_formattedValue")==-1?isNLNumericOrCurrencyFieldRequired(e):isRequiredFieldClassName(e)}function isRequiredFieldClassName(e){return e.className!=null&&(e.className.indexOf("inputreq")!=-1||e.className.indexOf("inputrtreq")!=-1)}function disableSelect(e,t,n){if(e!=null){var r=n!=null?n.document:e.document!=null?e.document:window.document;if(e.type=="select-one"||e.type=="select-multiple")e.disabled=t;else if(isNLDropDown(e))getDropdown(e,n).setDisabled(t);else if(isNLMultiDropDown(e))getMultiDropdown(e,n).setDisabled(t);else{var i=e.form.elements[e.name+"_display"];i!=null&&(i.disabled=t);var s=r.getElementById(e.name+"_popup_list");s!=null&&(s.style.visibility=t?"hidden":"inherit");var o=r.getElementById(e.name+"_popup_search");o!=null&&(o.style.visibility=t?"hidden":"inherit");var u=r.getElementById(e.name+"_popup_all");u!=null&&(u.style.visibility=t?"hidden":"inherit")}var a=r.getElementById(e.name+"_popup_new");a!=null&&(a.style.visibility=t?"hidden":"inherit");var f=r.getElementById(e.name+"_popup_link");f!=null&&(f.style.visibility=t?"hidden":"inherit")}}var setLabelLegacy=setLabel;setLabel=function(e,t){setLabelLegacy(e,t);var n=document.getElementById(e+"_lbl_uir_label");if(n){var r=n.className,i="uir-label-empty";t.length>0?r=r.replace(i,""):r.indexOf(i)==-1&&(r+=" "+i),n.className=r}};function NLHideDiv(e){var t=document.getElementById(e);t.style.display="none"}function NLCreateCookie(e,t,n){var r="";if(n){var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3),r="; expires="+i.toGMTString()}document.cookie=e+"="+t+r+"; path=/"}function escapeJSChars(e){var t="";for(var n=0;n<e.length;n++){var r=e.substr(n,1);if(r=="'"||r=='"'||r=="\\")t+="\\";t+=r}return t}function expandOrCollapseRows(e,t,n){var r="/images/forms/plus.svg",i="/images/forms/minus.svg",s=document.getElementById(e+"row"+t+"collapse");if(!s)return;typeof n=="undefined"&&(n=s.src.indexOf(i)!=-1);for(var o=t+1;!document.getElementById(e+"row"+o+"collapse");o++){var u=document.getElementById(e+"row"+o);if(!u)break;u.style.display=n?"none":""}s.src=n?r:i}function expandOrCollapseAllRows(e,t){for(var n=0;document.getElementById(e+"row"+n);n++)expandOrCollapseRows(e,n,t)}var dummy,undefined;window.currentMenu=null,document.onmousemove=function(e){autoSuggestOnMouseMove(e),quickaddDraggerOnMouseMove(e),portletDraggerOnMouseMove(e),ddmOnMouseMove(e),dropdownOnMouseMove(e)},window.clickCount=0;function documentOnClickHandler(e){++window.clickCount,ddmOnClick(e),window.popup_onClickHandler&&window.popup_onClickHandler(e)}document.addEventListener?document.addEventListener("click",documentOnClickHandler,!1):document.attachEvent?document.attachEvent("onclick",documentOnClickHandler):document.onclick=documentOnClickHandler,document.onmousedown=function(e){quickaddDraggerOnMouseDown(e),portletDraggerOnMouseDown(e),dropdownOnMouseDown(e),NLPopupAutoSuggest_onMouseDown(e);if(window.divsToClose&&typeof window.divsToClose!="undefined"){for(var t=0;t<window.divsToClose.length;t++)document.getElementById(window.divsToClose[t]).style.display="none";window.divsToClose=null}},document.onmouseup=function(e){quickaddDraggerOnMouseUp(),portletDraggerOnMouseUp(),dropdownOnMouseUp(e),window.NLCalendar_onMouseUp&&NLCalendar_onMouseUp(e),window.NLMachine_onMouseUp&&NLMachine_onMouseUp(e),window.OrderedListOnMouseUp!=null&&window.OrderedListOnMouseUp(e)},document.onkeydown=function(e){return handleHotKeys(e),NLPopupAutoSuggest_onKeyDown(e),dropdownOnKeyDown(e)};function addDivToClose(e){typeof window.divsToClose!="Array"&&(window.divsToClose=new Array),window.divsToClose[window.divsToClose.length]=e}function handleHotKeys(e){if(getEventKeypress(e)==71&&getEventAltKey(e)){var t=document.getElementById("_searchstring");t!=null&&(t.focus(),t.select())}}function getMouseX(e){return getEvent(e).clientX}function getMouseY(e){return getEvent(e).clientY}function moveToolTip(e,t){var n=getToolTip(),r=parseInt(n.offsetWidth),i=document.body.clientWidth,s=getWindowPageXOffset();rightLimit=i-r,left=e-9,left>rightLimit&&(left=rightLimit),left<0&&(left=0),n.style.left=s+left+"px",n.style.top=t+document.body.scrollTop+5+"px"}function showToolTip(e,t,n){if(isValEmpty(e)&&isValEmpty(t))return;var r='<table border="0" width="250" cellspacing="0" cellpadding="0" bgcolor="#999999"><tr><td width="100%"><table border="0" width="100%" cellspacing="1" cellpadding="2" align="center">';isValEmpty(e)||(r+='<tr><td width="100%" class="bglt"><font class="smalltextb">'+e+"</font></td></tr>"),isValEmpty(t)||(r+='<tr><td width="100%" bgcolor="#FFFFFF"><font class="smalltext">'+t+"</font></td></tr>"),r+="</table></td></tr></table>";var i=getToolTip();i.movetooltip=n||isValEmpty(i.tooltipcontent)||i.tooltipcontent!=r,i.tooltipcontent=r,i.hidetooltiptimer!=null&&clearTimeout(i.hidetooltiptimer),i.showtooltiptimer=setTimeout(function(){i.movetooltip&&moveToolTip(lastX+20,lastY),i.innerHTML=i.tooltipcontent,i.style.visibility="visible"},500)}function stopToolTipHide(){var e=getToolTip();e.hidetooltiptimer!=null&&clearTimeout(e.hidetooltiptimer)}function hideToolTip(){var e=getToolTip();e.showtooltiptimer!=null&&clearTimeout(e.showtooltiptimer),e.tooltipcontent="",e.hidetooltiptimer=setTimeout(function(){e.tooltipcontent=null,e.style.visibility="hidden"},1e3)}function getToolTip(){var e=document.getElementById("NLToolTip");return e==null&&(e=document.createElement("DIV"),e.id="NLToolTip",e.style.position="absolute",e.style.width="250px",e.style.top="0px",e.style.left="0px",e.style.zIndex=4,e.style.visibility="hidden",document.body.appendChild(e)),e}window.menusAreOpen=!1,window.rolloverDelay=0;var m_multiButtons=new Array;function getNLMultiButtonByName(e){return m_multiButtons[e]}function NLMultiButton(e,t,n,r,s,o,u,a){var f=new Array;this.sName=e,m_multiButtons[e]=this,this.sTaskId=r,this.sPrimaryButtonName=s,this.bSecondary=o,this.bYellowBg=u,this.bBlueBg=!!a,this.bEnabled=!0;var l=0;for(i=0;i<t.length;i++)t[i][0]==n?this.nDefault=i:(f[l]=[t[i][0],"javascript:NLMultiButton_doAction('"+e+"', '"+t[i][1]+"');return false;",""],l++);this.sParams=f,this.pValues=t,this.nButtons=t.length;var c="submit",h=u?"pgBntY":"pgBntG";!a||(h+=" pgBntB"),this.sHTML='<table cellpadding=0 cellspacing=0 border=0 class="uir-multibutton" style="cursor:hand;margin-right:6px;"><tr class="'+h+'"><td><img src="/images/nav/ns_x.gif" class="bntLT" border=0 height="50%" width=3><img src="/images/nav/ns_x.gif" class="bntLB" border=0 height="50%" width=3></td><TD id="spn_'+e+'" nowrap class="bntBgB" valign="top" height=20><input onBlur="NLMultiButton_clearMultiButtonMenus();" onKeyDown="return getNLMultiButtonByName(\''+e+"').onKeyPress(event);\" onClick=\"getNLMultiButtonByName('"+e+'\').onMainButtonClick(this);return false;" id="btn_'+e+'" type="'+c+'" class="rndbuttoninpt bntBgT'+(o?"small":"")+'" style="vertical-align:middle;" value="'+n+"\" onKeyPress=\"setEventCancelBubble(event);\" onmousedown=\"this.setAttribute('_mousedown','T'); setButtonDown(true, "+(o?"true":"false")+", this);\" onmouseup=\"this.setAttribute('_mousedown','F'); setButtonDown(false, "+(o?"true":"false")+", this);\" onmouseout=\"if(this.getAttribute('_mousedown')=='T') setButtonDown(false, "+(o?"true":"false")+", this);\" onmouseover=\"if(this.getAttribute('_mousedown')=='T') setButtonDown(true, "+(o?"true":"false")+', this);"></td><td nowrap valign="top" class="bntBgB multiBnt" onMouseOut="NLMultiButton_onArrowMouseOut(\''+e+"')\" onMouseOver=\"NLMultiButton_onArrowMouseOver('"+e+"')\" onClick=\"getNLMultiButtonByName('"+e+'\').onDropDownClick(this, event);"><div style="padding: 2px 3px 0px 4px;" class="bntBgT"><img class="multiBntTri" height="12" border="0" width="8" src="/images/nav/ns_x.gif" alt="More Options"></div></td><td><img src="/images/nav/ns_x.gif" height="50%" class="bntRT" border=0 width=3><img src="/images/nav/ns_x.gif" height="50%" class="bntRB" border=0 width=3></td></tr></table>',this.toString=function(){return this.sHTML},this.writeInlineHTML=function(){document.write(sHTML)}}function NLMultiButton_clearMultiButtonMenus(){for(i in menus)menus[i].tabName!=null&&menus[i].tabName.indexOf("mulitibutton")>=0&&menus[i].close()}function NLMultiButton_getBackgroundImageHtml(e){return"background-image:url("+e+");"}NLMultiButton.prototype.onMainButtonClick=function(e){NLMultiButton_doAction(this.sName,this.pValues[this.nDefault][1])},NLMultiButton.prototype.setState=function(e){if(this.bEnabled==e)return;this.bEnabled=e;var t=document.getElementById("btn_"+this.sName);t.disabled=!e};function NLMultiButton_doAction(e,t){var n=document.forms.main_form,r;n&&n.elements[t]!=null?r=n.elements[t]:r=document.getElementById(t);if(r.type=="submit"&&e){var i=getNLMultiButtonByName(e);i.sTaskId&&i.sPrimaryButtonName&&i.pValues[i.nDefault][1]!=t&&(n.elements._multibtnstate_.value=i.sTaskId+":"+i.sPrimaryButtonName+":"+r.name)}r.click()}function NLMultiButton_openMenu(e){clearAllMenusExcept(e);var t=getNLMultiButtonByName(e);if(!t.bEnabled)return;var n=t.getMenu();n.setOpenMenuUpwardIfNotBelow(!0),n.setAllowArbitraryHtmlInMenuEntries(!0),n.showHide(!0)}function NLMultiButton_onArrowMouseOut(e){clearTimeout(window.rolloverDelay)}function NLMultiButton_onArrowMouseOver(e){window.rolloverDelay=setTimeout("NLMultiButton_openMenu('"+e+"')",100)}NLMultiButton.prototype.onKeyPress=function(e){if(!isIE)return!0;var t=getEventKeypress(e),n=this.getMenu();if(!n.isOpen&&t==40)n.open(null,!1),this.nSelected=0,n.setCurrentCellInMenu(n.getCellInMenuAt(this.nSelected));else if(n.isOpen){if(t==13)return setEventPreventDefault(e),n.getCurrentCellInMenu()&&n.getCurrentCellInMenu().onclick(),!1;if(t==40||t==38){this.nSelected+=t==38?-1:1;if(this.nSelected>=this.nButtons-1)this.nSelected=this.nButtons-2;else if(this.nSelected<0)return this.nSelected=0,n.close(),!1;n.setCurrentCellInMenu(n.getCellInMenuAt(this.nSelected))}}return!0},NLMultiButton.prototype.getMenu=function(){var e=this.menu;if(!e){var t=this.sName;e=this.menu=new NLMenu(t,this.sParams,0,null),menus[t]=e,menuTimers[e.tabName]=0,e.setScaleToLauncher(!0),e.setMenuCSSClass(this.bSecondary?"ddmDivButtonSec":this.bYellowBg?"ddmDivButtonY":"ddmDivButtonG"),e.setXandYoverride(4,-4),e.setCloseAction("getNLMultiButtonByName('"+t+"').onMenuClose();"),e.setAfterOpenAction("getNLMultiButtonByName('"+t+"').onAfterMenuOpen();"),this.imgbtn=document.getElementById("multibtnimg_"+t),this.btnMain=document.getElementById("btn_"+t)}return e},NLMultiButton.prototype.onDropDownClick=function(e,t){if(!this.bEnabled)return!0;setEventCancelBubble(t);var n=this.getMenu();return n.showHide(!0),!1},NLMultiButton.prototype.onMenuClose=function(){this.nSelected=-1},NLMultiButton.prototype.onAfterMenuOpen=function(){this.nSelected=0;var e=this.getMenu(),t=this.pValues,n=0;for(var r=0;r<t.length;r++)if(r!=this.nDefault){var i=document.getElementById(t[n][1]);e.getCellInMenuAt(n).firstChild.className=i.disabled?"ddmAnchorDisabled":"ddmAnchor",n++}};function NLDoMainFormButtonAction(e,t){var n=getNLMultiButtonByName("multibutton_"+e);if(n)t&&document.forms.main_form.elements["btn_"+n.sName].focus(),n.onMainButtonClick();else{var r=document.forms.main_form.elements[e];r&&(t&&r.focus(),r.click())}}function makeMenu(e,t,n,r){window.menuData==null&&(window.menuData=new Array),window.menuLevel==null&&(window.menuLevel=new Array),window.menuParent==null&&(window.menuParent=new Array),window.menuData[e]=t,window.menuLevel[e]=n,window.menuParent[e]=r}function ddmOnMouseMove(e){if(window.currentMenu!=null)return window.currentMenu.handleMouseMove(e)}function ddmOnClick(e){var t=getEventTarget(e),n=findClassUp(t,"ddmSpan");if(n==null){var r=findClassUp(t,"menuDiv");r==null&&clearAllMenusExcept("ALL_MENUS_PLEASE")}}var zoomPercent=["75","90","","125","150"],iZoomDefault=2,iZoomIndex=iZoomDefault;function getZoomFile(e){var t=e.lastIndexOf("."),n=e.substr(0,t)+zoomPercent[iZoomIndex]+e.substr(t);return n}function setMenuZoomFactor(e){e!=undefined&&(e<.9?iZoomIndex=0:e<1?iZoomIndex=1:e>1.25?iZoomIndex=4:e>1?iZoomIndex=3:iZoomIndex=2)}setMenuZoomFactor(1);var tdCounter=0,NLMENU_STYLE_PAGE=1,NLMENU_STYLE_ACTION=2,NLMENU_STYLE_PORTLET=3,NLMENU_STYLE_CUSTOMIZE=4;function NLMenu(e,t,n,r,i){this.tabName=e.substring(0,e.indexOf("_")),this.div=null,this.tableDiv=null,this.currentCell=null,this.isOpen=!1,this.level=n,this.parentMenu=r,this.name=e,this.values=t,this.span=document.getElementById("spn_"+this.name),this.overrideX=0,this.rightjustify=!1,this.overrideY=0,this.onCloseAction=null,this.onOpenAction=null,this.bHasImageTd=!1,this.sHelperText=null,i?this.nMenuStyle=i:this.nMenuStyle=NLMENU_STYLE_PAGE}var menus=new Object,menuTimers=new Array,friendlyDelay=0;function resetNavMenuTimer(e){clearTimeout(menuTimers[e])}function startTimer(e){menuTimers[e]=setTimeout("clearAllMenus(-100, '"+e+"');",500)}function clearAllMenus(e,t){clearTimeout(friendlyDelay);for(i in menus)menus[i].tabName==t&&menus[i].level>e&&menus[i].close()}function clearAllMenusExcept(e){for(i in menus)if(menus[i].tabName!=e){var t=document.getElementById(menus[i].tabName+"_nav_arrow");t!=null&&(t.className="menu_tri"),menus[i].close()}}function getAndOpenMenu(e,t,n){lastMenuRequestedParent=t;var r=getMenu(e);r&&(lastMenuRequestedParent=null,r.open(t,n))}function getMenuRoundedBottomTableRow(){var e,t,n,r,i,s,o,u;return e=document.createElement("tr"),t=document.createElement("td"),t.height=9,t.colSpan=2,e.appendChild(t),n=document.createElement("table"),n.heigth=9,n.width="100%",n.cellSpacing=0,n.cellPadding=0,n.border=0,t.appendChild(n),r=document.createElement("tbody"),n.appendChild(r),i=document.createElement("tr"),r.appendChild(i),s=document.createElement("td"),i.appendChild(s),u=document.createElement("img"),u.height=9,u.width=9,u.border=0,u.src="/images/icons/dashboard/portletelements/bottom_left.gif",s.appendChild(u),s=document.createElement("td"),s.height=9,s.width="99%",s.vAlign="bottom",i.appendChild(s),u=document.createElement("img"),u.height=9,u.style.width="100%",u.border=0,u.src="/images/icons/dashboard/portletelements/lower_gradient.gif",s.appendChild(u),s=document.createElement("td"),i.appendChild(s),u=document.createElement("img"),u.height=9,u.width=9,u.border=0,u.src="/images/icons/dashboard/portletelements/bottom_right.gif",s.appendChild(u),e}NLMenu.prototype.setXandYoverride=function(e,t){this.overrideX=e,this.overrideY=t},NLMenu.prototype.setHelperText=function(e){this.sHelperText=e},NLMenu.prototype.setCloseAction=function(e){this.onCloseAction=new Function(e)},NLMenu.prototype.setOpenAction=function(e){this.onOpenAction=new Function(e)},NLMenu.prototype.setAfterOpenAction=function(e){this.onAfterOpen=new Function(e)},NLMenu.prototype.setRightJustify=function(e){this.rightjustify=e},NLMenu.prototype.setScaleToLauncher=function(e){this.scaletolauncher=e},NLMenu.prototype.setMenuBackgroundColor=function(e){this.sMenuBackgroundColor=e},NLMenu.prototype.setMenuCSSClass=function(e){this.sOverrideClass=e},NLMenu.prototype.setAllowArbitraryHtmlInMenuEntries=function(e){this.bUseSpanForMenuEntry=e},NLMenu.prototype.setOpenMenuUpwardIfNotBelow=function(e){this.bOpenMenuUpwardsIfNotBelow=e};function NLMenu_addHelperTextRows(e,t,n){var r=document.createElement("TR"),i=document.createElement("TD");e.appendChild(r),r.appendChild(i),i.className="text",i.innerHTML=t,n&&(i.colSpan=2)}NLMenu.prototype.positionActionDiv=function(e,t){if(!e||!t)return;var n=!0;this.span&&this.span.id&&this.span.id.indexOf("secondary")>0&&(n=!1);var r=getWindowPageYOffset(),i=findAbsolutePosY(e)-r;i+e.offsetHeight+t.offsetHeight>getVisibleWindowHeight()&&!n?(t.style.top="auto",t.style.bottom=getHeight(this.span)-5+"px",e.className+=" ac_container_bot"):(t.style.top="-1px",t.style.bottom="auto",this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE?e.className=e.className+"_hover":e.className+=" ac_container")},NLMenu.prototype.openActionMenu=function(e,t){if(this.isOpen==1)return;if(this.level>0&&typeof e!="undefined"&&document.getElementById(e)==null)return;this.span||(this.span=document.getElementById("spn_"+this.name)),clearTimeout(friendlyDelay);var n=!0;this.onOpenAction!=null&&(n=!1,this.onOpenAction()),this.div=document.getElementById("div_"+this.name);if(this.div.firstChild){(this.nMenuStyle==NLMENU_STYLE_ACTION||this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE)&&this.positionActionDiv(this.span,this.div),this.div.style.visibility="visible",this.level==0&&(window.menusAreOpen=!0),this.div.style.zIndex=50,this.isOpen=!0,this.onAfterOpen&&this.onAfterOpen();return}this.div.onmouseover=new Function("resetNavMenuTimer('"+this.tabName+"');"),t&&(this.div.onmouseout=new Function("startTimer('"+this.tabName+"');"));var r=document.createElement("table");r.cellSpacing=0,r.cellPadding=0,r.border=0;var i=document.createElement("tbody"),s=document.createElement("tr"),o=document.createElement("td"),u=document.createElement("img");u.border=0,u.src="/images/nav/ns_x.gif",u.style.height="4px",u.style.width="1px",u.style.display="block";var a=document.createElement("table");a.className="ac_table",this.div.appendChild(r),r.appendChild(i),i.appendChild(s),s.appendChild(o),o.appendChild(a),o=document.createElement("td"),o.className="acSideShadow",o.appendChild(u),s.appendChild(o),u=document.createElement("img"),u.border=0,u.src="/images/nav/ns_x.gif",u.style.height="4px",u.style.width="1px",u.style.display="block",s=document.createElement("tr"),i.appendChild(s),o=document.createElement("td"),o.className="acLBotShadow",s.appendChild(o),o.appendChild(u),o=document.createElement("td"),o.className="acRBotShadow",s.appendChild(o),o.appendChild(u);var f=document.createElement("tbody");a.appendChild(f),a.cellSpacing=2,a.cellPadding=0;var l=new Array,c=0,h,p,d,v,m,g,y,b,w,E,S,x,T,N=!1,C=!1;for(h=0;h<this.values.length;h++){m=this.values[h][0],y=this.values[h][1],g=this.values[h][2],x=this.values[h][3],T=this.values[h][4],g.length>0&&(N=!0),x!=null&&x.length>0?this.bHasImageTd=!0:this.bHasImageTd=!1;var k=m=="ddmSeperator",L=y=="ADMI_HEADING";L&&(C=!0),p=document.createElement("tr"),f.appendChild(p),d=document.createElement("td"),d.id="nl"+ ++tdCounter,S=document.createElement("a"),S.className="ddmAnchor",this.nMenuStyle!=NLMENU_STYLE_CUSTOMIZE&&(S.onclick=new Function("return false;")),L?d.className="ac_text_heading":d.className="ac_text",d.onmouseover=new Function("clearTimeout(friendlyDelay); clearAllMenus("+this.level+", '"+this.tabName+"');");if(y.length>0&&!k&&!L){var y=this.values[h][1],A=y;S.href=y;if(this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE)S.href=A;else{var O=this.values[h][4];y.substring(0,y.indexOf(":")).toLowerCase()=="javascript"?(y=y.substring(y.indexOf(":")+1),y.charAt(0)=="/"&&(S.href=y,S.onclick="",y="",S.style.display="block")):y="try { "+(O?"window.open(":"window.location = ")+"'"+y+"'"+(O?")":"")+"; } catch (e) { if(console) console.log(e.message); }",d.onclick=new Function("clearAllMenusExcept('clear all'); "+y)}}txt=document.createElement("span"),T&&T.length>0?txt.className=T:txt.className="ac_text_pad",txt.innerHTML=m;if(!k){d.appendChild(S);if(this.bHasImageTd)if(x.charAt(0)=="<")S.innerHTML=x;else{var M=document.createElement("img");M.border=0,M.src=x,M.height=14,M.width=18,S.appendChild(M),M.style.verticalAlign="bottom"}L&&(txt.className="ac_heading_pad",S.style.fontWeight="bold",S.style.color="#666666"),S.appendChild(txt),p.appendChild(d)}else if(k){E=document.createElement("tr"),f.appendChild(E);var _=document.createElement("td");E.appendChild(_),_.style.height="4px";var D=document.createElement("div");D.className="ac_separator",_.appendChild(D);var P=document.createElement("img");P.src="/images/nav/stretch.gif",P.style.height="3px",D.appendChild(P)}}if(this.nMenuStyle==NLMENU_STYLE_ACTION||this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE){var H=parseInt(getRuntimeStyle(a,"width"));H<120?a.style.width="130px":a.style.width=H+30+"px"}isIE&&(this.nMenuStyle==NLMENU_STYLE_PORTLET?(this.div.style.left="-16px",this.div.style.top=0):this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE&&(this.div.style.top="3px"));var B=0,j=this.span,F=this.span;this.level==0&&(window.menusAreOpen=!0),this.div.style.zIndex=50,(this.nMenuStyle==NLMENU_STYLE_ACTION||this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE)&&this.positionActionDiv(this.span,this.div),this.isOpen=!0,this.onAfterOpen&&this.onAfterOpen()},NLMenu.prototype.open=function(e,t){if(this.isOpen==1)return;if(this.level>0&&typeof e!="undefined"&&document.getElementById(e)==null)return;this.span||(this.span=document.getElementById("spn_"+this.name)),clearTimeout(friendlyDelay),this.onOpenAction!=null&&this.onOpenAction();var n=!1;this.level>0&&(n=!0,clearAllMenus(this.level-1,this.tabName));if(document.getElementById("div_"+this.name))return;this.div=document.createElement("div"),this.div.className="menuDiv";if(this.sOverrideClass)this.div.className=this.sOverrideClass;else{var r=document.createElement("div");r.className="menuLeftDiv",n&&(r.style.background="",r.style.paddingLeft=0);var i=document.createElement("div");i.className="menuRightDiv";var s=document.createElement("div");s.className="menuBottomDiv";var o=document.createElement("div");o.className="menuTableDiv",this.tableDiv=o,r.appendChild(i),i.appendChild(s),s.appendChild(o),this.div.appendChild(r)}this.div.id="div_"+this.name,this.div.onmouseover=new Function("resetNavMenuTimer('"+this.tabName+"');"),t&&(this.div.onmouseout=new Function("startTimer('"+this.tabName+"');"));var u=document.createElement("table");u.className="menuInnerTable",this.tableDiv?this.tableDiv.appendChild(u):this.div.appendChild(u);var a=document.createElement("tbody");u.appendChild(a),u.cellSpacing=1,u.cellPadding=4,this.sMenuBackgroundColor&&(u.style.backgroundColor=this.sMenuBackgroundColor);var f=new Array,l=0,c,h,p,d,v,m,g,y,b,w,E,S,x=!1,T=!1;for(c=0;c<this.values.length;c++){v=this.values[c][0],g=this.values[c][1],m=this.values[c][2],S=this.values[c][3],m.length>0&&(x=!0),S!=null&&S.length>0&&(this.bHasImageTd=!0);var N=v=="ddmSeperator",C=g=="ADMI_HEADING";C&&(T=!0),h=document.createElement("tr"),a.appendChild(h),p=document.createElement("td"),T&&!C&&(p.style.paddingLeft="20px"),p.id="nl"+ ++tdCounter,E=document.createElement("a"),E.className="ddmAnchor",E.onclick=new Function("return false;");if(m.length>0){p.className="ddmTextHasChild";var k="clearTimeout(friendlyDelay); var timeout = "+(this.level==0?250:0)+"; friendlyDelay = setTimeout(\"getAndOpenMenu('"+m+"','"+p.id+"',"+(t?"true":"false")+')",timeout)';p.onmouseover=new Function(k)}else p.className="ddmText",p.onmouseover=new Function("clearTimeout(friendlyDelay); clearAllMenus("+this.level+", '"+this.tabName+"');");if(g.length>0&&!N&&!C){var g=this.values[c][1];E.href=g;var L=this.values[c][4];g.substring(0,g.indexOf(":")).toLowerCase()=="javascript"?g=g.substring(g.indexOf(":")+1):g="try { "+(L?"window.open(":"window.location = ")+"'"+g+"'"+(L?")":"")+"; } catch (e) { if(console) console.log(e.message); }",p.onclick=new Function("clearAllMenusExcept('clear all'); "+g)}var A=null;this.bUseSpanForMenuEntry?(A=document.createElement("span"),A.innerHTML=v):A=document.createTextNode(v),(g==null||g.length<1)&&m.length>0&&(u.style.width="165px",f[l]=document.createElement("span"),f[l].className="menuChildIcon",f[l].id=this.tabName+"_arrow_"+c,p.appendChild(f[l]),l++,E.style.paddingRight="10px");if(!N){p.appendChild(E);if(this.bHasImageTd)if(S.charAt(0)=="<")E.innerHTML=S;else{var O=document.createElement("img");O.border=0,O.src=S,O.height=14,O.width=18,O.style.marginRight="5px",E.appendChild(O)}E.appendChild(A),C&&(E.style.fontWeight="bold",E.style.color="#666666"),h.appendChild(p)}if(N||C){w=document.createElement("tr"),a.appendChild(w);var M=document.createElement("td");M.style.padding="0",M.style.margin="0",w.appendChild(M),M.style.height="3px",this.bHasImageTd&&(M.colSpan=2);var _=document.createElement("div");_.className="menuSeparator",M.appendChild(_)}this.sHelperText!=null&&c==this.values.length-1&&NLMenu_addHelperTextRows(a,this.sHelperText,this.bHasImageTd)}var D=0,P=this.span,H=this.span;document.body.appendChild(this.div);if(n){P=this.div,e!=null&&(H=document.getElementById(e));if(this.level>0){var B=getMenu(this.tabName+"_d1");B!=null&&B.isOpen&&B.div!=null&&(D+=B.div.offsetWidth+B.div.offsetLeft)}if(this.level>1&&this.parentMenu!=null){var F=getMenu(this.parentMenu);F!=null&&F.isOpen&&F.div!=null&&(D+=F.div.offsetWidth)}D-=this.level*4}var I=parseInt(getRuntimeStyle(u,"width"));l>0&&x&&(u.style.width=I+5+"px");var q=P?P.getBoundingClientRect().left:event.x,R=q,U=document.body.scrollLeft;this.rightjustify&&(q+=this.span.offsetWidth-this.div.offsetWidth),n?q=D+1:q-=10;if(this.rightjustify&&q<R)this.div.style.left=R+"px";else if(q+this.div.offsetWidth<getDocumentWidth()+U)this.div.style.left=q+this.overrideX+"px";else{var z=q+this.div.offsetWidth-(getDocumentWidth()+U);this.div.style.left=q-z+"px"}var W=findClassUp(this.span,"scrollarea"),X=0;W!=null&&(X=W.scrollTop);var V=H?findAbsolutePosY(H):event.y;if(H){var $=getWindowPageYOffset();V+H.offsetHeight+this.div.offsetHeight>getDocumentHeight()+X+$?this.bOpenMenuUpwardsIfNotBelow?V=findAbsolutePosY(H)-this.div.offsetHeight+3:V=getDocumentHeight()-this.div.offsetHeight+5+X+$:V+=H.offsetHeight}if(n){var J=28;V-=J}V=V+5+this.overrideY-X,this.div.offsetHeight>getDocumentClientHeight()-20&&(V=5),this.div.style.top=V+"px",this.level==0&&(window.menusAreOpen=!0),this.div.style.zIndex=1500;var K=isIE?3:2,Q=isIE?19:17;if(l>0&&this.level==0)for(j=0;j<f.length;j++)f[j].style.left=I-Q+"px";this.scaletolauncher&&this.div.offsetWidth<this.span.offsetWidth&&(this.div.style.width=this.span.offsetWidth+"px",u.style.width="100%"),isIE&&nlInsertCanvas(this.div),this.isOpen=!0,this.onAfterOpen&&this.onAfterOpen()},NLMenu.prototype.close=function(){if(!this.isOpen)return;this.level==0&&(window.menusAreOpen=!1);if(this.nMenuStyle==NLMENU_STYLE_ACTION||this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE){this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE?this.span.className=this.span.className.replace("_hover",""):this.span.className="uir-action-button",this.div.style.visibility="hidden",this.isOpen=!1,this.currentCell!=null&&this.currentCell.className!="ddmTextSeperator"&&this.currentCell.className!="ac_text_heading"&&(this.currentCell.className="ac_text");return}if(this.nMenuStyle==NLMENU_STYLE_PORTLET){this.div.style.visibility="hidden",this.isOpen=!1,this.currentCell!=null&&this.currentCell.className!="ddmTextSeperator"&&this.currentCell.className!="ac_text_heading"&&(this.currentCell.className="ac_text"),this.onCloseAction!=null&&this.onCloseAction();return}nlRemoveCanvas(this.div),document.body.removeChild(this.div),this.currentCell=null,this.div=null,this.isOpen=!1,this.onCloseAction!=null&&this.onCloseAction()},NLMenu.prototype.getCellInMenuAt=function(e){return this.div.firstChild.rows[e].cells[0]},NLMenu.prototype.getCurrentCellInMenu=function(){return this.currentCell},NLMenu.prototype.setCurrentCellInMenu=function(e){if(!this.isOpen)return;this.currentCell!=null&&this.currentCell.className!="ddmTextSeperator"&&this.currentCell.className!="ac_text_heading"&&(this.nMenuStyle==NLMENU_STYLE_ACTION||this.nMenuStyle==NLMENU_STYLE_PORTLET||this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE?this.currentCell.className="ac_text":this.currentCell.className="ddmText"),e!=null&&e.className!="ddmTextSeperator"&&e.className!="ac_text_heading"&&(this.nMenuStyle==NLMENU_STYLE_ACTION||this.nMenuStyle==NLMENU_STYLE_PORTLET||this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE?e.className="ac_text_sel":e.className="ddmTextOver"),this.currentCell=e==null?this.div.firstChild.rows[0].cells[0]:e},NLMenu.prototype.getIndex=function(e){for(i=0;i<this.values.length;i+=2)if(this.values[i]==e)return i/2;return 0},NLMenu.prototype.showHide=function(e){return clearAllMenusExcept(this.tabName),this.becomeCurrent(),this.nMenuStyle==NLMENU_STYLE_ACTION||this.nMenuStyle==NLMENU_STYLE_PORTLET||this.nMenuStyle==NLMENU_STYLE_CUSTOMIZE?this.openActionMenu(null,e):this.open(null,e),!0},NLMenu.prototype.handleMouseMove=function(e){if(!this.isOpen)return;var t=getEventTarget(e);while(t!=null){if(t.className!=null&&(t.className=="ddmText"||t.className=="ddmTextHasChild"||t.className=="ddmTextSeperator"||t.className=="ac_text_heading"||t.className=="ac_text")){this.setCurrentCellInMenu(t);break}t=t.parentNode}},NLMenu.prototype.becomeCurrent=function(){window.currentMenu!=this&&(window.currentMenu=this)};function loadDelayedScriptReference(e,t){var n=document.getElementById("nmdscript"+e);if(n==null||n.src!=null&&n.src.length!=0)return!1;lastMenuRequested=t;var r=n._actualsrc;return n.src=r,!0}function loadDelayedNMD(e,t){lastMenuRequested=t;var n=document.createElement("script");n.setAttribute("type","text/javascript");var r,i;if("cneg21_d1"==t)r="/core/elements/compound/NLRecentMenu.nl?t="+getStickyTag("RECENTRECORDS"),i="nmdscript-21";else if("cneg6_d1"==t)r="/core/elements/compound/NLShortcutMenu.nl?t="+getStickyTag("RECENTRECORDS"),i="nmdscript-6";else if(t.indexOf("_recentreports")>0){var s=t.indexOf("neg")==1?"-":"",o=t.substring(s=="-"?4:1,t.indexOf("_"));r="/core/elements/compound/NLRecentReports.nl__t="+getStickyTag("RECENTREPORTS")+"&sections="+s+o+".nlqs",i="nmdscriptcneg9_recentreports"}else"cRR_d1"==t?(r="/core/elements/compound/NLRoleMenu.nl?t="+getStickyTag("ROLEMENU"),i="nmdscript-RR"):(r="/app/center/NLNavMenuData.nl__t="+getStickyTag("NAVMENUS")+"&sections="+e+".nlqs",i="nmdscript"+e);return n.setAttribute("src",r),n.setAttribute("id",i),document.getElementsByTagName("head")[0].appendChild(n),!0}function getMenu(e,t){var n=menus[e];if(n==null){if(!menuDataExists(e))return loadDelayedNMD(e,e),null;n=new NLMenu(e,window.menuData[e],window.menuLevel[e],window.menuParent[e],t),menus[e]=n;if(n.level==0){var r=0;menuTimers[n.tabName]=r}}return n}function menuDataExists(e){return!isOffline()&&(window.menuData==null||window.menuData[e]==null||window.menuData[e].length<1)?!1:!0}function deleteMenu(e){var t=menus[e];t!=null&&(menus[e]=null)}var lastMenuRequested=null,lastMenuRequestedParent=null;function openLastMenuRequested(){try{var e=lastMenuRequested;lastMenuRequested=null;if(e==null||!menuDataExists(e))return!1;var t=lastMenuRequestedParent;if(t==null)return getMenu(e).showHide(!0);lastMenuRequestedParent=null;if(document.getElementById(t)!=null)return getMenu(e).open(t,!1)}catch(n){console&&console.log(n.message)}}function showMenu(e,t,n,r,i){try{if(!window.loadcomplete)return isNaN(r)&&(r=0),r++,setTimeout(function(){showMenu(e,t,n,r,i)},1e3*r+1),!1;var s=document.getElementById(e);if(s!=null){var o=s.id.substring(4,s.id.length);return!!window.menuData&&window.menuData[o]!=null||n==null?menuDataExists(o)?(lastMenuRequested=null,getMenu(o,i).showHide(t)):!1:loadDelayedNMD(n,o)}}catch(u){console&&console.log(u.message)}}function setNLMenuBackground(e,t){var n=document.getElementById(e);if(n!=null){var r=n.parentNode,i=n.parentNode.previousSibling,s=n.parentNode.nextSibling;t?(r.className=r.className.replace("bgofftab","bghovertab"),i&&i.className&&(i.className=i.className.replace("bgofftab","bghovertab"),i.className=i.className.replace("bgtabrborder","bgtabrborder_s")),s&&s.className&&(s.className=s.className.replace("bgtabrborder","bgtabrborder_s"))):(r.className=r.className.replace("bghovertab","bgofftab"),i&&i.className&&(i.className=i.className.replace("bghovertab","bgofftab"),i.className=i.className.replace("bgtabrborder_s","bgtabrborder")),s&&s.className&&(s.className=s.className.replace("bgtabrborder_s","bgtabrborder")))}}function setPortletMenuBackground(e,t){var n=document.getElementById(e);n!=null&&(t?n.firstChild.className=n.firstChild.className.replace("portletIconMenu","portletIconMenuSel"):n.firstChild.className=n.firstChild.className.replace("portletIconMenuSel","portletIconMenu"))}var currentDropdown=null,dropdownCounter=0;window.dropdownloadtime=0;function initializeDropdown(e){var t=new Date,n=e.data("name"),r=e.data("options"),i=e.data("default-option"),s=e.data("settings"),o=["",""],u="",a,f,l,c=["","",""];dropdownCounter++;var h=n+dropdownCounter;e.nextAll("input").eq(0).attr("id","inpt_"+h),e.nextAll("input").eq(1).attr("id","hddn_"+h),e.nextAll("input").eq(2).attr("id","indx_"+h),e.nextAll(".ddarrowSpan").children("img").attr("id","inpt_"+h+"_arrow");if(r.length>0){o=[];for(a=0;a<r.length;a++){f=r[a];var p=f.text.indexOf("&")>-1?unEscapeHtml(f.text):f.text;o.push(p),o.push(f.value),p.length>=c[0].length&&(c[0]=p,c.sort(function(e,t){return e.length==t.length?0:e.length>t.length?1:-1}))}u=getLongestRenderedString(c)}return l=new NLDropdown(n,h,o,i,e.get(0).ownerDocument,s.flags,s.width,s.minWidth,u),s.mandatory&&l.setRequired(!0),e.attr("data-initialized","T"),window.dropdownloadtime+=(new Date).getTime()-t.getTime(),l}function getLongestRenderedString(e){var t=0,n="",r=document.createElement("div");r.style.display="none",r.style.position="absolute";for(var i=0;i<e.length;i++){var s=e[i];if(widthCache[s]){widthCache[s]>t&&(t=widthCache[s],n=s);continue}var o=getTextWidthDiv();o.innerHTML=s==" "?"&nbsp;":s,r.appendChild(o)}return r.style.display="",document.body.appendChild(r),NS.jQuery(r).find("div").each(function(){var e=this.offsetWidth,r=this.textContent;widthCache[r]=e,e>t&&(t=e,n=r)}),document.body.removeChild(r),n}function initializeMultiDropdown(e){var t=e.data("name"),n=e.data("options"),r=e.data("selected"),i=e.data("settings"),s=e.next("input"),o=["",""],u=[],a,f,l,c;dropdownCounter++;var h=t+dropdownCounter;s.attr("id","hddn_"+h).attr("nlmultidropdown",h);if(n.length>0){o=[];for(f=0;f<n.length;f++)l=n[f],o.push(l.text.indexOf("&")>-1?unEscapeHtml(l.text):l.text),o.push(l.value)}for(f=0;f<r.length;f++)u.push(n[r[f]].value);return a=u.join(String.fromCharCode(5)),c=new NLMultiDropdown(t,h,o,a,i.flags,i.width,i.height,e.get(0).ownerDocument),i.mandatory&&c.setRequired(!0),e.attr("data-initialized","T"),c}function initializeDropdowns(e){e.find(".ns-dropdown[data-initialized='F']").each(function(){initializeDropdown(jQuery(this))}),e.find(".ns-multi-dropdown[data-initialized='F'][data-lazy='F']").each(function(){initializeMultiDropdown(jQuery(this))})}function unEscapeHtml(e){if(e==null)return null;if(e.length==0)return"";var t=document.createElement("a");t.innerHTML=e+"\n";var n=t.firstChild;n!=null&&n.nodeName!="#text"&&(n=n.firstChild);if(n!=null){var r=n.data;return r.charAt(r.length-1)==" "&&(r=r.substr(0,r.length-1)),r}return""}function dropdownOnMouseDown(e){if(!window.loadcomplete||!NS.form.isValid())return!0;var t=getEventTarget(e);if(isNLMultiDropDown(t)){var n=t.getAttribute("nlmultidropdown");getMultiDropdownFromNameC(n).handleMouseDown(e)}var r=null,i=!1;t&&t.className=="i_dropdownarrow"&&(r=document.getElementById(t.id.replace("_arrow","")),i=!0),r==null&&(r=findClassUp(t,"dropdownInput textbox"));if(r!=null){if(i)try{setTimeout(function(){getDropdown(r).inpt.focus(),getDropdown(r).inpt.select()},1),getDropdown(r).inpt.focus()}catch(s){}return getDropdown(r).handleMouseDown(e)}}function dropdownOnMouseUp(e){var t=getEventTarget(e);if(t.tagName!=null&&t.tagName.toLowerCase()=="scrollbar")return;if(currentMultiDropdown!=null&&currentMultiDropdown.onMouseMoveIdx!=-1)currentMultiDropdown.onMouseMoveIdx=-1,currentMultiDropdown=null;else if(currentDropdown!=null){var n=findClassUp(t,"dropdownInput textbox");if(n==null&&currentDropdown.seenMouseMove){if(t.className=="dropdownDiv")return;if(typeof currentDropdown!="undefined"&&currentDropdown!=null){var r=findClassUp(t,"dropdownSelected");r!=null&&currentDropdown.setAndClose(r.nlrow),typeof currentDropdown!="undefined"&&currentDropdown!=null&&currentDropdown.close(),currentDropdown=null}}}}var lastX=0,lastY=0;function dropdownOnMouseMove(e){isIE&&(e=event);var t=e.clientY;if(e.clientX==lastX&&t==lastY)return;lastX=e.clientX,lastY=t;var n=getEventTarget(e);currentMultiDropdown!=null&&currentMultiDropdown.handleMouseMove(e),currentDropdown!=null&&currentDropdown.handleMouseMove(e)}function dropdownOnKeyDown(e){var t=getEventTarget(e),n=findClassUp(t,"dropdownInput textbox");if(isNLMultiDropDown(t)){var r=t.getAttribute("nlmultidropdown");return getMultiDropdownFromNameC(r).handleKeydown(e)}return!0}function getButtonId(e){return isIE?event.button:isNS?e.button:null}function dumpObj(e){for(var t in e){var n=t+": "+e[t];document.body.appendChild(document.createTextNode(n)),document.body.appendChild(document.createElement("BR"))}}NLDropdown.prototype.handleOnFocus=function(t){this.hddn.onfocus&&this.hddn.onfocus(t),this.inpt.select(),this.doOnChangeWhenBlur=!1},NLDropdown.prototype.handleOnBlur=function(t){this.hddn.onblur&&this.hddn.onblur(t),this.doOnChangeWhenBlur&&this.hddn.onchange&&this.hddn.onchange()},NLDropdown.prototype.setMandatoryBackgroundColor=function(t){this.sMandatoryBgColor=t},NLDropdown.prototype.hasAttribute=function(t){return(this.flags&t)!=0};function NLDropdown(e,t,n,r,i,s,o,u,a){if(e==null)throw"cannot create dropdown with null name";if(n==null)throw"cannot create dropdown with null values";this.name=e,this.nameC=t,this.textArray=new Array(n.length/2),this.valueArray=new Array(n.length/2),this.valueToIndexMap={},this.defaultIndex=r,this.indexAtRenderTime=r,this.isOpen=!1,this.divWidthHasBeenSet=!1,this.disabled=!1,this.div=null,this.currentCell=null,this.searchString="",this.typeAhead=!1,this.cancelEventOnEnterKey=!1,this.width=null,this.minimumWidth=u||0,this.flags=0,this.sMandatoryBgColor="#FFFFFF",this.bRequired=!1,this.initializeElements(i),this.bInitialize=!0;for(var f=0,l=0;f<n.length;f+=2,l++){var c=n[f],h=n[f+1];this.textArray[l]=c,this.valueArray[l]=h,this.valueToIndexMap[String(h)]=l}this.setIndex(r,!0),window.dropdowns[t]==null&&(window.dropdowns[t]=this),this.setWidth(o==-1?null:o,u==-1?null:u,a),this.flags=s,this.bRequired=this.hasAttribute(128),this.disabled=this.hasAttribute(2048),this.typeAhead=this.hasAttribute(2147483648),this.hasAttribute(2048)&&this.setDisabled(!0),this.hasAttribute(1073741824)&&this.setArrowImage("")}NLDropdown.prototype.initializeElements=function(t){if(t==null){var n=window.parentAccesible&&typeof parent!="undefined"&&typeof parent.Ext!="undefined";if(n&&parent.Ext.WindowMgr.getActive()!=null){var r=parent.Ext.WindowMgr.getActive(),i=r.body.dom.contentWindow?r.body.dom.contentWindow:window.frames[r.getId()+"_frame"];typeof i!="undefined"&&i!=null?t=i.document:t=document}else t=document}this.inpt=t.getElementById("inpt_"+this.nameC),this.ddbtn=this.inpt,this.hddn=t.getElementById("hddn_"+this.nameC),this.indx=t.getElementById("indx_"+this.nameC),this.span=this.inpt.parentNode;while("span"!==this.span.nodeName.toLocaleLowerCase())this.span=this.span.parentNode;this.isSelectable()||(this.inpt.unselectable="on"),this.elementsAreInitialized=!0,this.bInitialize=!1};function getDropdownArrowSpacing(){return 10}NLDropdown.prototype.setWidth=function(t,n,r){var i;if(t!=null)this.width=t,i=t;else if(r!=null){var s=getTextWidth(r);i=Math.max(s+getDropdownArrowSpacing(),n==null?0:n),i+=26}else{this.div==null&&this.buildDiv();var o=this.div;document.body.insertBefore(o,document.body.firstChild),o.offsetHeight<200?(i=o.offsetWidth+5+getDropdownArrowSpacing(),i<40&&(i=40)):i=o.offsetWidth+15+getDropdownArrowSpacing(),document.body.removeChild(o)}if(this.inptWidth!==i||this.inptText!==this.getText())this.setWidthDirect(i),this.setText(null,!0)},NLDropdown.prototype.scheduleSetWidth=function(){if(this.width==null&&!this.dirty){this.dirty=!0;var t=this;setTimeout(function(){t.setWidth(),t.dirty=!1},0)}},NLDropdown.prototype.setWidthDirect=function(t){t=Math.max(this.minimumWidth,Math.min(t,300)),this.inpt.style.width=t+"px",this.inptWidth=t},NLDropdown.prototype.buildDiv=function(){var t=document.createElement("div");this.div=t,t.className="dropdownDiv",t.unselectable=this.inpt.unselectable,t.style.zIndex=1001,this.divWidthHasBeenSet=!1;var n=new Array(this.textArray.length);this.divArray=n;var r,i;for(r=0;r<this.textArray.length;r++){var s=this.textArray[r];if(s==null||s.length==0)s="&nbsp;";i=document.createElement("div"),n[r]=i,s!="&nbsp;"&&(s=s.escapeHTML()),i.innerHTML=s,i.unselectable=t.unselectable,i.id="nl"+ ++tdCounter,i.nlrow=r,i.className="dropdownNotSelected",t.appendChild(i)}var o=this;t.onkeydown=function(e){o.handleKeyDown(e)},t.onkeypress=function(e){o.handleKeypress(e)},t.onmousedown=function(){return!1}},NLDropdown.prototype.adjustDivForScrollbar=function(t,n){isIE?t.style.width=t.offsetWidth+18+"px":isNS&&(t.style.width=t.offsetWidth-12+"px")},NLDropdown.prototype.sizeDiv=function(){var t=this.div,n;if(!this.divWidthHasBeenSet){var r=t.offsetWidth,i=this.inpt.offsetWidth;n=i-r,t.style.overflow="hidden",r<i?t.style.width=i+"px":t.style.width=r+4+"px"}var s=findPosY(this.inpt),o=s-document.body.scrollTop,u=getDocumentHeight()-(s-document.body.scrollTop+this.inpt.offsetHeight),a=Math.max(o,u);if(t.offsetHeight<Math.min(200,a)){if(isNS){var f=t.offsetHeight;t.style.height=f+"px",t.offsetHeight>f&&(t.style.height=(f*2<t.offsetHeight?0:f*2-t.offsetHeight)+"px")}}else{var l=Math.min(a,200);t.style.height=l-2+"px",t.style.overflow="auto",this.divWidthHasBeenSet||this.adjustDivForScrollbar(t,a,n)}this.divWidthHasBeenSet=!0},NLDropdown.prototype.getForm=function(){var t=null;try{t=this.elementsAreInitialized?this.hddn.form:null}catch(n){this.elementsAreInitialized=!1,this.bInitialize=!0}return t},NLDropdown.prototype.open=function(){this.bInitialize&&this.initializeElements();if(this.disabled||this.textArray.length==0)return;this.div==null&&this.buildDiv(),this.div.style.visibility="hidden";var t=window.parentAccesible&&typeof parent!="undefined"&&typeof parent.Ext!="undefined",n=t?parent.Ext.WindowMgr.getActive():null,r=n!=null?n.body.dom.contentWindow?n.body.dom.contentWindow:window.frames[n.getId()+"_frame"]:null,i=!1;if(n!=null&&r==null&&n.body.dom!=null&&n.body.dom.id.indexOf("popup")>0){i=!0;var s=this.inpt.parentNode.insertBefore(this.div,this.inpt.nextSibling)}else{var o=r!=null?r.document:document;o.body.insertBefore(this.div,o.body.firstChild)}this.sizeDiv(),this.hasAttribute(256)?this.positionRelativeDiv():i||this.positionDiv(this.inpt,this.div),this.isOpen=!0,this.seenMouseMove=!1,this.setCurrentCellInMenu(null),isIE&&this.currentCell!=null&&(this.div.scrollTop=this.currentCell.offsetTop),this.hasAttribute(256)||isIE&&nlInsertCanvas(this.div),this.div.style.visibility="visible"},NLDropdown.prototype.positionRelativeDiv=function(){this.span.style.zIndex=1,this.span.insertBefore(this.div,this.span.firstChild);var t=findPosX(this.span),n=findPosY(this.span);this.div.style.left=0,n+this.inpt.offsetHeight+this.div.offsetHeight-document.body.scrollTop>getDocumentHeight()?this.div.style.top=3-this.div.offsetHeight+"px":this.div.style.top=this.inpt.offsetHeight-1+"px"},NLDropdown.prototype.positionDiv=function(t,n){var r=getWindowPageXOffset(),i=getWindowPageYOffset(),s=findAbsolutePosX(t),o=n.offsetWidth,u=document.body.scrollLeft,a=getDocumentClientWidth();s-r+o-u<=a?n.style.left=s+"px":n.style.left=a-o+u+"px";var f=findAbsolutePosY(t),l=n.offsetHeight,c=t.offsetHeight,h=getDocumentClientHeight();f-i+c+l>h?n.style.top=Math.max(f-l,0)+"px":isIE?n.style.top=f+c-1+"px":isNS&&(n.style.top=f+c-2+"px")},NLDropdown.prototype.close=function(){if(!this.isOpen)return;this.indexOnDeck!=null&&(this.setIndex(this.indexOnDeck),this.indexOnDeck=null),this.currentCell!=null&&(this.currentCell.className="dropdownNotSelected",this.currentCell=null),this.span.style.zIndex="",this.hasAttribute(256)||nlRemoveCanvas(this.div),this.div.parentNode.removeChild(this.div),this.isOpen=!1},NLDropdown.prototype.isSelectable=function(){return this.span.unselectable=="on"?!1:!0},NLDropdown.prototype.setFocus=function(){try{this.inpt.focus(),this.isSelectable()&&this.inpt.select()}catch(t){console&&console.log(t.message)}};function getDropdownPadding(){return 17}NLDropdown.prototype.setText=function(t,n){t==null&&(t=this.getText()),this.inptText=t,this.inpt.title=t;if(t==null||t=="")t=" ";t=elideTxt(t,this.inptWidth-getDropdownPadding()),this.inpt.value=t;if(!n||this==currentDropdown)try{this.inpt.focus(),!this.isOpen&&this.isSelectable()&&this.inpt.select()}catch(r){console&&console.log(r.message)}},NLDropdown.prototype.getText=function(t){return t==null&&(t=this.getIndex()),t==null||t<0||t>this.textArray.length?"":this.textArray[t]},NLDropdown.prototype.getValue=function(){var e=this.hddn.value;return e},NLDropdown.prototype.getTexts=function(){return this.textArray},NLDropdown.prototype.getValues=function(){return this.valueArray},NLDropdown.prototype.setAndClose=function(t){this.indexOnDeck=null,this.close(),this.setIndex(t)};function getNext(e){var t=e.firstChild;return t==null&&(t=e.nextSibling,t==null&&t.parentNode!=null&&(t=e.parentNode.nextSibling)),t}NLDropdown.prototype.setCurrentCellInMenu=function(t){if(!this.isOpen)return;var n=t;if(t==null){var r=this.getIndex();if(r<0||r>this.divArray.length||r===undefined)r=0;t=this.divArray[r]}this.currentCell!=null&&(this.currentCell.className="dropdownNotSelected"),t!=null&&(t.className="dropdownSelected"),this.currentCell=t},NLDropdown.prototype.getIndex=function(){return Number(this.indx.value)},NLDropdown.prototype.setIndex=function(t,n){if(t==null)return;t=Number(t);if(t<0||t>=this.valueArray.length)return;var r=this.getIndex();this.indx.value=t,this.hddn.value=this.valueArray[t],this.setText(this.textArray[t],n);if(r==t)return;if(!n&&this.hddn.onchange!=null){var i=this.hddn.onchange();if(i==0){this.indx.value=r,this.hddn.value=this.valueArray[r],this.setText(this.textArray[r],n);return}}},NLDropdown.prototype.setValue=function(t,n){var r=this.getIndexForValue(t);if(r==null)return;this.setIndex(r,n)},NLDropdown.prototype.getValueAtIndex=function(t){return this.valueArray[t]},NLDropdown.prototype.getTextAtIndex=function(t){return this.textArray[t]},NLDropdown.prototype.respondToArrow=function(t){var n;this.matchTimeout!=null&&(clearTimeout(this.matchTimeout),this.matchTimeout=null),this.currentCell==null?this.arrowIndex==null?n=this.getIndex():n=this.arrowIndex:n=this.currentCell.nlrow,n+=t,n<0&&(n=0),n>=this.valueArray.length&&(n=this.valueArray.length-1);if(this.isOpen){var r=this.textArray[n];this.setText(r),this.setCurrentCellInMenu(this.divArray[n]);var i=this.currentCell.parentNode.scrollTop,s=this.currentCell.offsetTop,o=getElementContentHeight(this.currentCell.parentNode),u=this.currentCell.offsetHeight;i>s?this.currentCell.scrollIntoView(!0):i+o<s+u&&this.currentCell.scrollIntoView(!1),this.indexOnDeck=n}else{var a=this.valueArray[n];if(a==-1&&t>0)n+1<this.valueArray.length&&this.respondToArrow(t+1);else{this.arrowIndex=n;var f=this;this.matchTimeout=setTimeout(function(){f.arrowIndex=null,f.setIndex(n)},0)}}},NLDropdown.prototype.gotoNext=function(t){this.searchStringTimeout!=null&&(clearTimeout(this.searchStringTimeout),this.searchStringTimeout=null),this.matchTimeout!=null&&(clearTimeout(this.matchTimeout),this.matchTimeout=null,this.arrowIndex==null);var n=this.getIndex();this.currentCell!=null&&(n=this.currentCell.nlrow);var r=n,i,s=this.textArray.length;this.searchString+=String.fromCharCode(t).toUpperCase(),this.searchString.length==1&&++r;var o=!1;for(var u=0;u<s;u++){i=r%s;var a=this.textArray[i].substr(getTypeAheadStartIndex(this.textArray[i]),this.searchString.length).toUpperCase();if(a==this.searchString){o=!0;break}++r}if(o)if(this.isOpen)this.setText(this.textArray[i]),this.setCurrentCellInMenu(this.divArray[i]),this.div.scrollTop=this.currentCell.offsetTop,this.indexOnDeck=i;else{var f=this;this.doOnChangeWhenBlur=!0,this.matchTimeout=setTimeout(function(){f.setIndex(i,!0)},0)}if(this.typeAhead==1){var l=this;this.searchStringTimeout=setTimeout(function(){l.searchString=""},2e3)}else this.searchString=""};function getTypeAheadStartIndex(e){for(var t=0;t<e.length;t++)if(e.charCodeAt(t)!=32&&e.charCodeAt(t)!=160)return t;return 0}NLDropdown.prototype.getTextForValue=function(t){var n=this.getIndexForValue(t);return n!=null?this.textArray[n]:""},NLDropdown.prototype.getIndexForText=function(t){for(var n=0;n<this.textArray.length;n++)if(trim(this.textArray[n])==trim(t))return n;return-1},NLDropdown.prototype.getIndexForValue=function(t){return this.valueToIndexMap[String(t)]},NLDropdown.prototype.restoreToOriginalValue=function(){this.setIndex(this.indexAtRenderTime,!0)},NLDropdown.prototype.gotoDefault=function(){this.setIndex(this.defaultIndex,!0)},NLDropdown.prototype.resetDropDown=function(){this.gotoDefault()},NLDropdown.prototype.setDefaultIndex=function(t){if(t==null)return;this.bInitialize&&this.initializeElements(),this.defaultIndex=Number(t)},NLDropdown.prototype.handleMouseDown=function(t){this.becomeCurrent(),this.isOpen?this.close():this.open()},NLDropdown.prototype.handleKeydown=function(t){if(this.disabled)return!0;this.bInitialize&&this.initializeElements();var n=getEventKeypress(t);switch(n){case 8:case 16:case 17:case 18:case 20:case 46:case 93:return}this.becomeCurrent();switch(n){case 9:this.handleOnBlur(t),this.close(),currentDropdown=null;break;case 13:if(this.currentCell!=null){var r=this.currentCell.nlrow;this.setIndex(r)}else this.handleOnBlur(t),this.doOnChangeWhenBlur=!1;this.isOpen&&(this.indexOnDeck=null,this.close(),currentDropdown=null,this.cancelEventOnEnterKey||(setEventCancelBubble(t),setEventPreventDefault(t)));break;case 38:getEventAltKey(t)?this.isOpen&&this.close():(this.respondToArrow(-1),setEventCancelBubble(t),setEventPreventDefault(t));break;case 40:getEventAltKey(t)?this.isOpen||this.open():(this.respondToArrow(1),setEventCancelBubble(t),setEventPreventDefault(t));break;case 37:case 39:return!0;case 33:this.respondToArrow(-14),this.isOpen&&(this.div.scrollTop=this.currentCell.offsetTop),setEventCancelBubble(t),setEventPreventDefault(t);break;case 34:this.respondToArrow(14),this.isOpen&&(this.div.scrollTop=this.currentCell.offsetTop),setEventCancelBubble(t),setEventPreventDefault(t);break;case 35:this.respondToArrow(this.valueArray.length),this.isOpen&&(this.div.scrollTop=this.currentCell.offsetTop),setEventCancelBubble(t),setEventPreventDefault(t);break;case 36:this.respondToArrow(-this.valueArray.length),this.isOpen&&(this.div.scrollTop=this.currentCell.offsetTop),setEventCancelBubble(t),setEventPreventDefault(t);break;default:}},NLDropdown.prototype.handleKeypress=function(t){if(this.disabled)return!0;this.bInitialize&&this.initializeElements(),this.becomeCurrent();var n=getEventKeypress(t);switch(n){case 9:break;case 13:this.isOpen&&(setEventCancelBubble(t),setEventPreventDefault(t));break;default:this.gotoNext(n),setEventPreventDefault(t)}},NLDropdown.prototype.handleMouseMove=function(t){if(!this.isOpen)return!0;this.seenMouseMove=!0;var n=getEventTarget(t);while(n!=null){if(n.className!=null&&n.className=="dropdownNotSelected"){this.setCurrentCellInMenu(n);break}n=n.parentNode}},NLDropdown.prototype.becomeCurrent=function(){currentDropdown!=null&&currentDropdown!=this&&currentDropdown.close(),currentDropdown!=this&&(currentDropdown=this,this.indexOnDeck=null)},NLDropdown.prototype.setDisabled=function(t){this.disabled=t,this.inpt.disabled=t,this.hddn.disabled=t,this.disabled?(this.close(),this.span.className&&this.span.className.indexOf("effectDisabled")<0&&(this.span.className=this.span.className+" effectDisabled")):this.span.className&&this.span.className.indexOf("effectStatic")<0?this.span.className=this.span.className.replace(" effectDisabled"," effectStatic"):this.span.className=this.span.className.replace(" effectDisabled","")},NLDropdown.prototype.setHidden=function(t){this.span.style.display=t?"none":""},NLDropdown.prototype.addOption=function(t,n,r){if(n==null)throw"cannot create an option with null value";if(t==null)throw"cannot create an option with null text";var i=this.textArray.length==0;t=String(t),t.indexOf("&")>-1&&(t=unEscapeHtml(t)),n=String(n);if(typeof r=="undefined"||r>this.valueArray.length)r=this.valueArray.length;for(var s=r;s<this.valueArray.length;++s)this.valueToIndexMap[this.valueArray[s]]=s+1;this.valueToIndexMap[n]=r,this.textArray.splice(r,0,t),this.valueArray.splice(r,0,n),this.defaultIndex>=r&&++this.defaultIndex,this.getIndex()>=r&&this.setIndex(this.getIndex()+1,!0),this.div=null,i&&(this.defaultIndex=0,this.setIndex(0,!0)),this.scheduleSetWidth()},NLDropdown.prototype.cloneDropdownValues=function(t){if(t==null)return;this.textArray=t.textArray,this.valueArray=t.valueArray,this.valueToIndexMap=t.valueToIndexMap,this.inpt.style.width=t.inpt.style.width,this.inptWidth=t.inptWidth,this.setText(null,!0)},NLDropdown.prototype.deleteAllOptions=function(){this.close(),this.valueArray.length=0,this.textArray.length=0,this.valueToIndexMap=new Array,this.div=null,this.defaultIndex=0,this.setText("",!0),this.hddn.value="",this.indx.value="-1"},NLDropdown.prototype.deleteOneOption=function(t,n){t=String(t);var r=this.valueToIndexMap[t];if(r==null)return;this.close();for(var i=r+1;i<this.valueArray.length;++i)this.valueToIndexMap[this.valueArray[i]]=i-1;delete this.valueToIndexMap[t],this.valueArray.splice(r,1),this.textArray.splice(r,1),this.div=null,n||this.scheduleSetWidth(),r==this.defaultIndex?this.defaultIndex=0:this.defaultIndex>r&&--this.defaultIndex,this.getIndex()>r&&this.setIndex(this.getIndex()-1,!0),t==this.getValue()&&this.gotoDefault()},NLDropdown.prototype.setOptionText=function(t,n){t=String(t);var r=this.valueToIndexMap[t];if(r==null)return;this.close(),this.textArray[r]=n,t==this.getValue()&&this.setText(n,!0),this.div=null,this.scheduleSetWidth()},NLDropdown.prototype.setArrowImage=function(t){if(!this.overrideImage){if(t=="/images/forms/ddarrow.gif"||t=="/images/forms/ddarrowPress.gif"||t=="/images/forms/ddarrowDisabled.gif")t=getZoomFile(t);t?this.ddbtn.style.backgroundImage="url("+t+")":this.ddbtn.style.backgroundImage=""}},NLDropdown.prototype.overrideArrowImage=function(t){this.ddbtn.style.backgroundImage="url("+t+")",this.overrideImage=!0},NLDropdown.prototype.setBackgroundColor=function(t){this.inpt.style.backgroundColor=t},NLDropdown.prototype.setRequired=function(t){this.bRequired=t,t?this.setBackgroundColor(this.sMandatoryBgColor):this.setBackgroundColor(""),setFieldLabelRequired(this.name,t,this.getForm())},NLDropdown.prototype.setDefaultOrNotRequired=function(t){this.setRequired(t?this.hasAttribute(128):!1)},NLDropdown.prototype.getRequired=function(t){return this.bRequired},NLDropdown.prototype.getInput=function(){return this.inpt},NLDropdown.prototype.getHiddenInput=function(){return this.hddn},NLDropdown.prototype.getContainer=function(){return this.span};var dropdowns={};function getDropdownFromNameC(e,t){if(typeof t=="undefined"||t==null)t=window;var n=t.dropdowns[e];return n==null&&t.parent!=null&&t.parent.dropdowns!=null&&(n=t.parent.dropdowns[e]),n}function getDropdown(e,t){if(e.tagName=="SPAN"){var n=e.getElementsByTagName("INPUT");for(var r=0;r<n.length;r++)if(n[r].type=="hidden"&&n[r].id!=null&&n[r].id.indexOf("hddn_")==0){e=n[r];break}}if(e.id)return getDropdownFromNameC(e.id.substring(5),t)}function getTextWidthDiv(){var e=document.createElement("div");return e.className="dropdownDiv",e.style.position="absolute",e.style.padding=0,e.style.margin=0,e.style.border=0,e.style.fontSize="13px",e}var textWidthDiv=getTextWidthDiv(),widthCache={};function getTextWidth(e){var t=widthCache[e];if(t!=null)return t;textWidthDiv.innerHTML=e==" "?"&nbsp;":e,document.body.appendChild(textWidthDiv);var n=textWidthDiv.offsetWidth;return document.body.removeChild(textWidthDiv),widthCache[e]=n,n}function elideTxt(e,t){if(t<=0)return e;if(getTextWidth(e)<t)return e;e=e.replace(/^(\s|\u00A0)*/,"").replace(/(\s|\u00A0)*$/,"");if(getTextWidth(e)<t)return e;var n="...",r=getTextWidth(n);if(r>=t)return n;var i=0,s=e.length,o=Math.round((i+s)/2),u=e.substr(0,Math.round(o/2)),a=e.substr(e.length-Math.floor(o/2)),f;while(i!==s)f=getTextWidth(u+a)+r,f<=t?i=o:s=o-1,o=Math.round((i+s)/2),u=e.substr(0,Math.round(o/2)),a=e.substr(e.length-Math.floor(o/2));return u+n+a}var multidropdowns=new Object,currentMultiDropdown=null;function getMultiDropdownFromNameC(e,t){t==null&&(t=window);var n=t.multidropdowns[e];return n==null&&t.parent!=null&&t.parent.multidropdowns!=null&&(n=t.parent.multidropdowns[e]),n}function getMultiDropdown(e,t){if(e.tagName=="SPAN"&&isValEmpty(e.getAttribute("nlmultidropdown"))){var n=e.getElementsByTagName("INPUT");for(var r=0;r<n.length;r++)if(!isValEmpty(n[r].getAttribute("nlmultidropdown")))return getMultiDropdownFromNameC(n[r].getAttribute("nlmultidropdown"),t)}return getMultiDropdownFromNameC(e.getAttribute("nlmultidropdown"),t)}NLMultiDropdown.prototype.setMandatoryBackgroundColor=function(t){this.sMandatoryBgColor=t},NLMultiDropdown.prototype.setRequired=function(t){this.bRequired=t,t?this.setBackgroundColor(this.sMandatoryBgColor):this.setBackgroundColor(""),setFieldLabelRequired(this.name,t,this.getForm())},NLMultiDropdown.prototype.getRequired=function(){return this.bRequired},NLMultiDropdown.prototype.hasAttribute=function(t){return(this.flags&t)!=0},NLMultiDropdown.prototype.getForm=function(){var t=null;try{t=this.hiddenField.form}catch(n){}return t};function NLMultiDropdown(e,t,n,r,i,s,o,u){if(e==null)throw"cannot create multi-select dropdown with null name";if(n==null)throw"cannot create multi-select dropdown with null values";this.renderDocument=u,this.name=e,this.nameC=t,this.textArray=new Array(n.length/2),this.valueArray=new Array(n.length/2),this.valueToIndexMap=new Array,this.defaultValues=r,this.selectedVals=isValEmpty(this.defaultValues)?new Array:this.defaultValues.split(String.fromCharCode(5)),this.sMandatoryBgColor="#FFFFFF",this.bRequired=!1,this.staticWidth=s,this.numRows=parseInt(o)+(isIE?0:1),this.disabled=!1,this.span=null,this.table=null,this.width=null,this.flags=0,this.hiddenField=u.getElementById("hddn_"+this.nameC),this.parentSpan=this.getParentSpan(),this.parentSpan.setAttribute("nlmultidropdown",this.nameC),this.parentSpan.onmousedown=new Function("return false;"),this.parentSpan.onmousemove=new Function("return false;"),this.currentIdx=-1,this.previousIdx=-1,this.onMouseMoveIdx=-1;for(var a=0,f=0;a<n.length;a+=2,f++){var l=n[a],c=n[a+1];this.textArray[f]=l,this.valueArray[f]=c,this.valueToIndexMap[String(c)]=f}this.setWidth(),this.defaultBorderColor=this.table.style.borderColor,attachEventHandler("mouseup",document,function(e){this.handleMouseUp(e)}.bind(this)),window.multidropdowns[t]==null&&(window.multidropdowns[t]=this),this.flags=i,this.hasAttribute(2048)&&this.setDisabled(!0)}NLMultiDropdown.prototype.getParentSpan=function(){var t=this.hiddenField.parentNode;while(t!=null){if(t.tagName=="SPAN"&&t.id!=null&&t.id.indexOf(this.name)!=-1)return t;t=t.parentNode}return t},NLMultiDropdown.prototype.buildSpan=function(){this.span=this.renderDocument.createElement(isIE?"span":"div"),this.parentSpan.insertBefore(this.span,this.hiddenField),this.span.className="dropdownDiv",this.span.style.position="relative",this.span.style.display="inline-block",this.span.style.height=(parseInt(this.numRows)*15).toString()+"px",this.span.style.width="100%",this.span.style.overflow="auto",this.span.setAttribute("nlmultidropdown",this.nameC),this.table=this.renderDocument.createElement("table"),this.span.appendChild(this.table),this.table.cellSpacing=0,this.table.width="100%",this.table.cellPadding=0,this.table.style.borderCollapse="collapse",this.table.style.textAlign="left",this.table.setAttribute("nlmultidropdown",this.nameC);var t=this.renderDocument.createElement("tbody"),n=this.textArray.length,r=this;for(var i=0;i<n;i++){var s=this.renderDocument.createElement("td");s.className=this.contains(i)?"dropdownSelected":"dropdownNotSelected",s.style.whiteSpace="nowrap",s.style.borderWidth="0px",s.style.borderStyle="solid",s.style.borderColor="#FFFFFF",s.nlrow=i,s.setAttribute("nlmultidropdown",this.nameC);var o=this.textArray[i];isValEmpty(o)&&(o="&nbsp;");if(isIE)s.innerHTML=o,s.onclick=function(){r.setFocus()};else{var u=this.renderDocument.createElement("a");s.appendChild(u),u.onclick=function(){r.setFocus()},u.innerHTML=o,u.nlrow=i,u.setAttribute("nlmultidropdown",this.nameC)}s.onkeypress=function(e){r.handleKeypress(e)};var a=this.renderDocument.createElement("tr");t.appendChild(a),a.appendChild(s)}this.table.appendChild(t),this.span.onkeypress=function(e){r.handleKeypress(e)},NS.UI&&NS.UI.Helpers&&NS.UI.Helpers.uir_dropdownHelper&&NS.UI.Helpers.uir_dropdownHelper.onSpanBuilt(this)},NLMultiDropdown.prototype.positionHelperIconsForNonIE=function(){try{if(isIE)return;var t=document.getElementById(this.name+"_helperwidgets");if(t){var n=parseInt(Math.floor(this.span.offsetHeight/2))-parseInt(Math.floor(t.offsetHeight/2))+4,r=parseInt(this.span.offsetWidth)+10;t.style.position="relative",t.style.left=r+"px",t.style.top=n+"px"}}catch(i){console&&console.log(i.message)}};function getFocusElement(e){if(!e)return null;if(e.focus)return e;var t=e.firstChild;e=null;while(t&&!e)e=getFocusElement(t),t=t.nextSibling;return e}NLMultiDropdown.prototype.setFocus=function(){var t=getFocusElement(this.span);try{t.focus(),this.selectedVals.length==0&&this.highLightBorder(0)}catch(n){console&&console.log(n.message)}},NLMultiDropdown.prototype.setWidth=function(){this.span==null&&this.buildSpan();if(this.staticWidth!=null)this.span.style.width=this.staticWidth+"px";else{var t=this.table.offsetWidth;t<40&&(t=40),t=Math.min(t,300),this.table.style.width=t+"px",this.span.style.width=(t+21).toString()+"px",this.width=t}this.positionHelperIconsForNonIE()},NLMultiDropdown.prototype.becomeCurrent=function(){currentMultiDropdown!=this&&(currentMultiDropdown=this)},NLMultiDropdown.prototype.resetDropDown=function(){this.removeAll(),this.previousIdx=-1,this.currentIdx=-1,this.selectedVals=isValEmpty(this.defaultValues)?new Array:this.defaultValues.split(String.fromCharCode(5));var t=this.selectedVals.length,n=0;while(n<t)this.add(this.valueToIndexMap[this.selectedVals[n++]],!0);this.width==null&&this.setWidth(),this.setHiddenField()},NLMultiDropdown.prototype.getTextForValue=function(t){var n=this.getIndexForValue(t);return n!=null?this.textArray[n]:""},NLMultiDropdown.prototype.getIndexForValue=function(t){return this.valueToIndexMap[String(t)]},NLMultiDropdown.prototype.setValue=function(t){this.setIndex(valueToIndexMap[t])},NLMultiDropdown.prototype.setIndex=function(t,n){if(this.disabled)return;getEventShiftKey(n)?this.handleShiftKey(Math.min(this.currentIdx,t),Math.max(this.currentIdx,t)):getEventCtrlKey(n)||getEventMacCommandKey(n)?this.contains(t)?this.remove(t,!0):this.add(t,!0):(this.removeAll(),this.add(t,!0)),this.highLightBorder(t),this.previousIdx=t},NLMultiDropdown.prototype.addIndex=function(t){if(this.disabled)return;this.add(t,!0),this.highLightBorder(t),this.previousIdx=t,this.setHiddenField(!0)},NLMultiDropdown.prototype.setValues=function(t,n){this.removeAll(),this.previousIdx=-1;var r=t.split(String.fromCharCode(5)),i=0;for(i=0;i<r.length;i++)this.add(this.getIndexForValue(r[i]),!0);this.setHiddenField(!n)},NLMultiDropdown.prototype.getValues=function(){return this.valueArray},NLMultiDropdown.prototype.highLightBorder=function(t){this.previousIdx!=-1&&(this.getCell(this.previousIdx).style.borderStyle="solid",this.getCell(this.previousIdx).style.borderColor="#FFFFFF"),this.getCell(t).style.borderStyle="dotted",this.getCell(t).style.borderColor=this.defaultBorderColor},NLMultiDropdown.prototype.handleScrolling=function(t){if(this.span!=null){var n=this.span.scrollTop,r=this.span.scrollTop+this.getCell(t).offsetHeight*Math.max(1,this.numRows-1);this.getCell(t).offsetTop>r+this.getCell(t).offsetHeight||this.getCell(t).offsetTop<n-this.getCell(t).offsetHeight?this.span.scrollTop=this.getCell(t).offsetTop:this.getCell(t).offsetTop>r?this.span.scrollTop+=this.getCell(t).offsetHeight:this.getCell(t).offsetTop<n&&(this.span.scrollTop-=this.getCell(t).offsetHeight)}},NLMultiDropdown.prototype.getSelectedValues=function(){return this.selectedVals.join(String.fromCharCode(5))},NLMultiDropdown.prototype.getSelectedText=function(t){var n="";isValEmpty(t)&&(t=",");if(this.selectedVals.length>0)for(var r=0;r<this.selectedVals.length;r++)n+=(r==0?"":t)+this.getText(this.valueToIndexMap[this.selectedVals[r]]);return n},NLMultiDropdown.prototype.getSelectedTextFromValues=function(t,n){var r="";isValEmpty(n)&&(n=",");if(!isValEmpty(t)){var i=t.split(String.fromCharCode(5));for(var s=0;s<i.length;s++)r+=(s==0?"":n)+this.getText(this.valueToIndexMap[i[s]])}return r},NLMultiDropdown.prototype.setHiddenField=function(t){this.hiddenField.value=this.getSelectedValues(),t&&this.hiddenField.onchange()},NLMultiDropdown.prototype.removeAll=function(){var t=this.selectedVals;for(var n=0;n<t.length;n++){var r=this.valueToIndexMap[t[n]];this.remove(r,!0),this.getCell(r).style.borderStyle="solid",this.getCell(r).style.borderColor="#FFFFFF"}},NLMultiDropdown.prototype.add=function(t,n){if(t==null)return;this.currentIdx=t,arrayAdd(this.selectedVals,this.getValue(t)),n&&(this.getCell(t).className="dropdownSelected")},NLMultiDropdown.prototype.remove=function(t,n){if(t==null)return;this.selectedVals=arrayRemove(this.selectedVals,this.getValue(t)),n&&(this.getCell(t).className="dropdownNotSelected")},NLMultiDropdown.prototype.contains=function(t){return arrayContains(this.selectedVals,this.valueArray[t])},NLMultiDropdown.prototype.getCell=function(t){return this.table.rows[t].cells[0]},NLMultiDropdown.prototype.getValue=function(t){return this.valueArray[t]},NLMultiDropdown.prototype.getText=function(t){return this.textArray[t]},NLMultiDropdown.prototype.setBackgroundColor=function(t){this.defaultBorderColor=t,this.table.style.backgroundColor=t,this.span.style.backgroundColor=t},NLMultiDropdown.prototype.handleShiftKey=function(t,n){if(t>n||t<0||n>=this.valueArray.length)return;var r=0;while(r<this.valueArray.length)r>=t&&r<=n?this.add(r,!0):this.remove(r,!0),r++},NLMultiDropdown.prototype.handleMoveSelection=function(t,n){var r=this.valueArray.length,i=this.currentIdx;i+=n,i=Math.min(i,r-1),i=Math.max(i,0),getEventShiftKey(t)?this.handleShiftKey(Math.min(this.previousIdx,i),Math.max(this.previousIdx,i)):this.removeAll(),this.add(i,!0),this.highLightBorder(i),getEventShiftKey(t)||(this.previousIdx=i),this.handleScrolling(i),this.setHiddenField(!0)},NLMultiDropdown.prototype.handleTypeAhead=function(t){var n=Math.max(this.currentIdx,0)+1,r,i=this.textArray.length,s=String.fromCharCode(t).toUpperCase(),o=!1;for(var u=0;u<i;u++){r=n%i;var a=this.textArray[r].substr(0,s.length).toUpperCase();if(a==s){o=!0;break}++n}o&&(this.removeAll(),this.add(r,!0),this.highLightBorder(r),this.previousIdx=r,this.handleScrolling(r),this.setHiddenField(!0))},NLMultiDropdown.prototype.handleMouseMove=function(t){if(this.disabled)return;if(this.onMouseMoveIdx==-1)return;if(isIE&&getEvent(t).button==0){this.onMouseMoveIdx=-1,currentMultiDropdown==this&&(currentMultiDropdown=null);return}var n=getEventTarget(t);while(n!=null){if(n.className!=null&&!isNaN(n.nlrow)&&n.nlrow!="undefined"&&n.getAttribute("nlmultidropdown")==this.nameC){var r=n.nlrow,i=this.onMouseMoveIdx!=this.previousIdx&&this.contains(this.onMouseMoveIdx)&&Math.abs(this.previousIdx-this.onMouseMoveIdx)>Math.abs(this.previousIdx-r);if(i)this.remove(this.onMouseMoveIdx,!0);else{var s=Math.min(this.previousIdx,r),o=Math.max(this.previousIdx,r);for(var u=s;u<=o;u++)this.contains(u)||this.add(u,!0)}this.handleScrolling(r),this.onMouseMoveIdx=r;break}n=n.parentNode}},NLMultiDropdown.prototype.handleMouseDown=function(t){if(this.disabled)return;this.becomeCurrent();var n=getEventTarget(t);n!=null&&!isNaN(n.nlrow)&&n.nlrow!="undefined"&&(this.onMouseMoveIdx=n.nlrow,this.setIndex(n.nlrow,t),this.handleScrolling(n.nlrow),this.dragBegan=!0)},NLMultiDropdown.prototype.handleMouseUp=function(t){if(!this.dragBegan)return;if(this.disabled)return;this.dragBegan=!1,this.becomeCurrent(),this.setHiddenField(!0)},NLMultiDropdown.prototype.handleKeydown=function(t){if(this.disabled)return;this.becomeCurrent();var n=!1,r=getEventKeypress(t);switch(r){case 33:this.handleMoveSelection(t,-this.numRows);break;case 34:this.handleMoveSelection(t,+this.numRows);break;case 35:this.handleMoveSelection(t,this.valueArray.length-this.currentIdx);break;case 36:this.handleMoveSelection(t,-this.currentIdx);break;case 38:this.handleMoveSelection(t,-1);break;case 40:this.handleMoveSelection(t,1);break;default:n=!0}return n},NLMultiDropdown.prototype.handleKeypress=function(t){if(this.disabled)return!0;this.becomeCurrent();var n=getEventKeypress(t);this.handleTypeAhead(n)},NLMultiDropdown.prototype.setDisabled=function(t){this.disabled=t,this.hiddenField.disabled=t;if(this.table!=null){this.table.disabled=t;if(!isIE){var n=this.table.getElementsByTagName("A");for(var r=0;r<n.length;r++)n[r].style.color=t?"#AAAAAA":""}}!this.disabled&&this.span==null&&this.width==null&&(this.setWidth(),this.setBackgroundColor(this.defaultBorderColor))},NLMultiDropdown.prototype.setHidden=function(t){this.span!=null&&(this.span.style.display=t?"none":"")},NLMultiDropdown.prototype.addOption=function(t,n,r,i){if(n==null)throw"cannot create an option with null value";if(t==null)throw"cannot create an option with null text";t=String(t),n=String(n),typeof i=="undefined"&&(i=this.valueArray.length),this.textArray.splice(i,0,t),this.valueArray.splice(i,0,n),this.valueToIndexMap[n]=i,r&&this.add(i,!1),this.span!=null&&this.parentSpan.removeChild(this.span),this.span=null,this.width=null,this.setWidth(),this.setBackgroundColor(this.defaultBorderColor),this.setHiddenField(),this.disabled||this.handleScrolling(i)},NLMultiDropdown.prototype.deleteAllOptions=function(){this.valueArray.length=0,this.textArray.length=0,this.valueToIndexMap={},this.previousIdx=-1,this.currentIdx=-1,this.selectedVals=[],this.span!=null&&this.parentSpan.removeChild(this.span),this.span=null,this.width=null,this.setWidth(),this.setBackgroundColor(this.defaultBorderColor),this.setHiddenField()},NLMultiDropdown.prototype.deleteOneOption=function(t){t=String(t);var n=this.valueToIndexMap[t];if(n==null)return;this.valueArray.splice(n,1),this.textArray.splice(n,1),delete this.valueToIndexMap[t],this.selectedVals=arrayRemove(this.selectedVals,t),this.span!=null&&this.parentSpan.removeChild(this.span),this.span=null,this.width=null,this.setWidth(),this.setBackgroundColor(this.defaultBorderColor),this.setHiddenField()},NLMultiDropdown.prototype.getContainer=function(){return this.span};function resetNLDropDowns(e){if(window.dropdowns!=null)for(i in window.dropdowns){var t=window.dropdowns[String(i)];t.elementsAreInitialized&&(e==null||t.getForm()==e)&&t.resetDropDown()}if(window.multidropdowns!=null)for(i in window.multidropdowns){var t=window.multidropdowns[String(i)];(e==null||t.hiddenField.form==e)&&t.resetDropDown()}}var _popup_help="<Enter first few letters then tab>",_short_popup_help="<Type then tab>",_mult_popup_help="<Type & tab for single value>",_popup_help_search="Type & tab...";function getStyleForClass(e,t){var n=document.styleSheets;for(var r=0;r<n.length;r++){var i=n[r].rules?n[r].rules:n[r].cssRules;for(var s=0;s<i.length;s++){var o=i[s];if(!o.hasOwnProperty("style"))continue;var u=o.style,a=o.selectorText;if(!isValEmpty(u[t])&&a!=null&&a.replace(".","")==e)return u[t]}}return null}var dragger=null,mouseX=0,mouseY=0,currentPortlet=null,bar=null,EVENT_PORTLET_MAX=0,EVENT_PORTLET_MIN=1,EVENT_PORTLET_MOVE=2,EVENT_PORTLET_DROP=3,EVENT_PORTLET_DRAG=4;function NLPortletDragger(){this.trToBeMoved=null,this.divContainer=null,this.headerTR=null,this.width=null,this.originalColumn=null,this.originalNext=null,this.originalContainer=null,this.widthPlaceHolder=null,this.portletID=null}function movedToDifferentWidthColumn(e,t){return(e==1||e==3)&&t==2||(t==1||t==3)&&e==2}NLPortletDragger.prototype.putDownPortlet=function(){bar&&bar.parentNode&&bar.parentNode.removeChild(bar);var t=currentPortlet;isNS||this.divContainer.parentNode.removeChild(this.divContainer);if(t!=null){var n=getCellIndex(t.parentNode.parentNode.parentNode)+1,r=NLHighChartManager_Instance.getChartObject("portletHC_child_portlet_"+this.portletID);typeof r!="undefined"&&movedToDifferentWidthColumn(this.originalColumn,n)&&r.setSize(0,0),t.parentNode.insertBefore(this.trToBeMoved,t),typeof this.updateLayoutInDatabase!="undefined"?this.updateLayoutInDatabase(this.portletID,t.portletID,n,this.originalColumn,this.trToBeMoved.id):updateLayoutInDatabase(this.portletID,t.portletID,n,this.originalColumn),movedToDifferentWidthColumn(this.originalColumn,n)==1&&this.headerTR.setAttribute("ptlt_hasdisplayed","F")}else this.widthPlaceHolder&&this.originalContainer.insertBefore(this.trToBeMoved,this.originalNext);this.widthPlaceHolder&&this.originalContainer.removeChild(this.widthPlaceHolder),clearTimeout(chartResizingTimeout),chartResizingTimeout=setTimeout(reflowAllCharts,300),currentPortlet=null},NLPortletDragger.prototype.putDownRow=function NLPortletDragger_putDownRow(){bar&&bar.parentNode&&bar.parentNode.removeChild(bar);var moveTo=currentPortlet;this.divContainer!=null&&(this.divContainer.parentNode.removeChild(this.divContainer),this.originalContainer.insertBefore(this.trToBeMoved,this.originalNext));if(moveTo==null)return;OrderedListMarkRowNavigation&&OrderedListMarkRowNavigation(moveTo,!1);if(moveTo.isOrderedList&&OrderedListMoveLineTo)OrderedListMoveLineTo(moveTo.machineName,moveTo.rowIndex);else if(moveTo.machineName!=null){var newRowIdx=moveTo.rowIndex,currentRowIdx=eval(moveTo.machineName+"_machine.getMachineIndex()"),isInlineEdit=eval(moveTo.machineName+"_machine.isinline"),machine=getMachineByName(moveTo.machineName);isInlineEdit&&currentRowIdx<moveTo.rowIndex&&machine.moveButtons&&newRowIdx--,eval(moveTo.machineName+"_machine.movelineto("+newRowIdx+")")}currentPortlet=null};function getCellIndex(e){var t=e.parentNode;for(var n=0;n<t.cells.length;n++)if(t.cells[n]==e)return n;return 0}function movePortlet(e,t){try{var n=getEventTarget(t);if(n.nodeName=="A"||n.nodeName=="SPAN")return!0;var r=findClassUp(e,"portletHandle");dragger=new NLPortletDragger,dragger.portletID=getPortletId(e.id),dragger.headerTR=e,dragger.trToBeMoved=r,dragger.originalColumn=getCellIndex(r.parentNode.parentNode.parentNode)+1,dragger.originalContainer=r.parentNode,dragger.originalNext=r.nextSibling,dragger.width=r.offsetWidth,dragger.divContainer=document.createElement("div"),dragger.divContainer.style.position="absolute",dragger.divContainer.style.width=dragger.width,dragger.divContainer.style.background=document.body.bgColor,isIE?dragger.divContainer.style.filter="alpha(opacity=92)":(dragger.divContainer.style.opacity=.92,dragger.divContainer.style.MozOpacity=.92),dragger.widthPlaceHolder=document.createElement("tr");var i=document.createElement("td"),s=document.createElement("img");i.appendChild(s),dragger.widthPlaceHolder.appendChild(i),s.src="/images/nav/stretch.gif",s.width=dragger.width,s.height="0",dragger.widthPlaceHolder&&dragger.originalContainer.appendChild(dragger.widthPlaceHolder),dragger.originalContainer.removeChild(r);var o=document.createElement("table");o.style.borderWidth=0,o.width="100%";var u=document.createElement("tbody");o.appendChild(u),u.appendChild(r),dragger.divContainer.appendChild(o),isNS||(document.body.appendChild(dragger.divContainer),positionFloatingPortlet(dragger.divContainer,4))}catch(a){dragger=null}}function portletDraggerOnMouseMove(e){updateMousePosition(e);if(dragger){document.body.scrollHeight>getDocumentHeight()&&getDocumentHeight()-mouseY<10?document.body.scrollTop=document.body.scrollHeight-getDocumentHeight():mouseY<15&&document.body.scrollTop>0&&(document.body.scrollTop=0),isNS||positionFloatingPortlet(dragger.divContainer,4);var t=getEventTarget(e);t=findClassUp(t,"portletHandle"),t!=null&&t!=currentPortlet&&t!=dragger.trToBeMoved&&(currentPortlet=t,bar!=null&&bar.parentNode!=null&&bar.parentNode.removeChild(bar),bar=getPositionUpdateBar(),currentPortlet.portletID=getPortletId(currentPortlet.id),currentPortlet.parentNode.insertBefore(bar,currentPortlet)),notifyPortlet(dragger.portletID,EVENT_PORTLET_MOVE)}}function updateMousePosition(e){mouseX=getMouseX(e),mouseY=getMouseY(e)}function getPositionUpdateBar(e){var t=document.createElement("tr"),n=document.createElement("td");t.appendChild(n);var r=document.createElement("hr");return r.style.width="100%",r.className="portletDragDropBar",n.appendChild(r),e&&e.cells.length>0&&(n.colSpan=e.cells.length,r.style.width="95%"),t}function positionFloatingPortlet(e,t){var n=8,r=10,i=t,s=getDocumentClientWidth();mouseX<15?e.style.left=n+"px":mouseX+e.offsetWidth>s-r?e.style.left=s-r-e.offsetWidth+"px":e.style.left=mouseX-10+"px";if(mouseY<getDocumentHeight()){var o=mouseY+document.body.scrollTop+i;mouseY+e.offsetHeight<getDocumentHeight()||(o=o-e.offsetHeight-15),o=o>0&&o||0,e.style.top=o+"px"}}function portletDraggerOnMouseDown(e){if(dragger||getButtonId(e)>1)return;var t=getEventTarget(e),n=findClassUp(t,"portletlabelDragDrop");if(n!=null&&n.id!=null){movePortlet(n,e);var r=getPortletId(n.id);notifyPortlet(r,EVENT_PORTLET_DRAG)}}function portletDraggerOnMouseUp(){if(dragger)return dragger.putDownPortlet(),notifyPortlet(dragger.portletID,EVENT_PORTLET_DROP),dragger=null,!1}function getPortletId(e){return e==null?-1:e.substring(e.lastIndexOf("_")+1,e.length)}function updateLayoutInDatabase(e,t,n,r){if(typeof NLHighChartManager_Instance.getChartObject("portletHC_child_portlet_"+e)!="undefined"&&!Ext.isIE)var i="/app/center/portletlayout.nl?movedid="+e+"&replacedid="+t+"&sectionid=-29&newcolumn="+n+"&oldcolumn="+r+"&chartMoved=true";else var i="/app/center/portletlayout.nl?movedid="+e+"&replacedid="+t+"&sectionid=-29&newcolumn="+n+"&oldcolumn="+r+"&chartMoved=false";var s=getParameter("entityid",document);s!=null&&(i+="&entityid="+s);var o=getParameter("project",document);o&&(i+="&project="+o),sendRequestToFrame(i,"server_commands")}function hidePortlet(e,t,n){var r=document.getElementById(n);r=findClassUp(r,"portletHandle");if(r!=null){var i="/app/center/setup/dashboard.nl?portletid="+t+"&sectionid="+e+"&dynamic=T&elementid="+n;i+="&method=hideportlet",window.editDashboard&&(i+="&e=T"),sendRequestToFrame(i,"server_commands")}clearTimeout(chartResizingTimeout),chartResizingTimeout=setTimeout(reflowAllCharts,300)}function doHidePortlet(e){var t=document.getElementById(e);t=findClassUp(t,"portletHandle"),t!=null&&t.parentNode.removeChild(t),clearTimeout(chartResizingTimeout),chartResizingTimeout=setTimeout(reflowAllCharts,300)}var portletMaxControlImgUrl="/images/forms/maximize.gif",portletMaxControlHighLightImgUrl="/images/forms/maximize.gif",portletMinControlImgUrl="/images/forms/minimize.gif",portletMinControlHighLightImgUrl="/images/forms/minimize.gif";function minimizePortlet(e,t,n,r,i,s){var o=document.getElementById(n);if(o!=null&&o.nodeName=="TR"){var u=o.getAttribute("ptlt_hasdisplayed")=="T",a=document.getElementById(n+"_content"),f=a.style.display=="none",l=f?"":"none";if(!f||u||!s){var c=document.getElementById("table_"+n);for(var h=a.rowIndex;h<c.rows.length;h++)c.rows[h].style.display=l;var p=document.getElementById(n+"_maxmin");f?p.className=p.className.replace("portletIconMaximize","portletIconMinimize"):p.className=p.className.replace("portletIconMinimize","portletIconMaximize")}o.setAttribute("ptlt_hasdisplayed","T");var d="/app/center/setup/minimizeportlet.nl?portletid="+t+"&sectionid="+e;d=addParamToURL(d,"elemid",r),d=addParamToURL(d,"sticky",i),d=addParamToURL(d,"_minimize",f?"F":"T"),d=addParamToURL(d,"_reload",f&&!u&&s?"T":"F"),sendRequestToFrame(d,"server_commands"),notifyPortlet(t,f?EVENT_PORTLET_MAX:EVENT_PORTLET_MIN),clearTimeout(chartResizingTimeout),chartResizingTimeout=setTimeout(reflowAllCharts,300)}}function minimizeProjectDashboardPortlet(e,t,n,r,i,s,o){var u=document.getElementById(n);if(u!=null&&u.nodeName=="TR"){var a=u.getAttribute("ptlt_hasdisplayed")=="T",f=document.getElementById(n+"_content"),l=f.style.display=="none",c=l?"":"none";if(!l||a||!s){var h=document.getElementById("table_"+n);for(var p=f.rowIndex;p<h.rows.length;p++)h.rows[p].style.display=c;var d=document.getElementById(n+"_maxmin");l?d.className=d.className.replace("portletIconMaximize","portletIconMinimize"):d.className=d.className.replace("portletIconMinimize","portletIconMaximize")}u.setAttribute("ptlt_hasdisplayed","T");var v="/app/accounting/project/minimizeprojectdashboardportlet.nl?portletid="+t+"&sectionid="+e;v=addParamToURL(v,"elemid",r),v=addParamToURL(v,"sticky",i),v=addParamToURL(v,"_minimize",l?"F":"T"),v=addParamToURL(v,"_reload",l&&!a&&s?"T":"F"),v=addParamToURL(v,"project",o),sendRequestToFrame(v,"server_commands"),notifyPortlet(t,l?EVENT_PORTLET_MAX:EVENT_PORTLET_MIN),clearTimeout(chartResizingTimeout),chartResizingTimeout=setTimeout(reflowAllCharts,300)}}function refreshPortlet(e,t,n,r,i,s,o,u,a,f){if(NS.Dashboard)return refreshPortletCompat(e,n,i,u,a,f);setPortletToUpdating(e);var l="/app/center/setup/portletrefresher.nl?elemid="+e+"&sticky="+t;n!=null&&(l+="&noreload="+(n?"T":"F")),r!=null&&(l+="&sc="+r),i!=null&&(l+="&portletid="+i),s!=null&&(l+="&entityid="+s+"&haschild="+(o?"T":"F")),u!=null&&(l+="&searchid="+u),f!=null&&(l+="&lineid="+f),l+="&nsts="+(new Date).getTime(),a!=null&&a.length>0&&(a.charAt(0)=="?"&&(a=a.substring(1)),l+="&addparams="+escape(a)),sendRequestToFrame(l,"server_commands")}function refreshPortletCompat(e,t,n,r,i,s){var o={noreload:t?"T":"F",searchid:r,lineid:s},u=/([\w]+)=([^&]*)/g,a;while((a=u.exec(i))!==null)o[a[1]]=a[2];if(!n&&e){var f=/[0-9]+/.exec(e),l=/neg/.test(e);n=l?-f[0]:f[0]}var c=decodeURIComponent(jQuery.param(o)),h=NS.Dashboard.getInstance().getPortlet(n);h.reload("refresh",c)}function refreshProjectPortlet(e,t,n,r,i,s,o,u,a,f,l){setPortletToUpdating(e);var c="/app/center/setup/portletrefresher.nl?elemid="+e+"&sticky="+t;n&&(c+="&noreload="+(n?"T":"F")),r&&(c+="&sc="+r),s&&(c+="&portletid="+s),o&&(c+="&entityid="+o+"&haschild="+(u?"T":"F")),a&&(c+="&searchid="+a),l&&(c+="&lineid="+l),i&&(c+="&project="+i),c+="&nsts="+(new Date).getTime(),f!=null&&f.length>0&&(f.charAt(0)=="?"&&(f=f.substring(1)),c+="&addparams="+escape(f)),sendRequestToFrame(c,"server_commands")}function disablePortletLinks(e){for(var t=0;;t++){var n=document.getElementById(e+t);if(n==null)break;n.disabled=!0}return!0}function sendRequestToFrame(e,t){try{document.getElementById(t).src=e}catch(n){console&&console.log(n.message)}}function getFrame(e){try{return document.getElementById(e)}catch(t){console&&console.log(t.message)}}var quickAddDragger=null;function quickaddDraggerOnMouseDown(e){if(quickAddDragger||getButtonId(e)>1)return;var t=getEventTarget(e),n=findClassUp(t,"quickaddDragDropIcon");n!=null&&n.id!=null&&(quickAddDragger=findClassUp(n,"quickadddragger"))}function quickaddDraggerOnMouseMove(e){quickAddDragger!=null&&positionFloatingPortlet(quickAddDragger,0)}function quickaddDraggerOnMouseUp(){return quickAddDragger=null,!1}function setPortletToUpdating(e){var t="rfsh_"+e,n=document.getElementById(t);if(n!=null){var r=n.parentNode.previousSibling!=null?n.parentNode.previousSibling.firstChild:null;r!=null&&r.nodeName=="IMG"&&(r.src="/images/nav/dingbats/btn_cl_refresh.gif");while(n.firstChild!=null)n.removeChild(n.firstChild);var i=document.createElement("font");i.color="#999999";var s=document.createTextNode("Refreshing");i.appendChild(s),n.appendChild(i);var o=document.createElement("img");o.src="/images/setup/updating.gif",o.border=0,n.appendChild(o)}else{var u=e+"_refresh",a=document.getElementById(u);a&&a.className.indexOf("portletIconRefreshing")<0&&(a.className=a.className.replace("portletIconRefresh","portletIconRefreshing"))}}var ExtFontNames=[["Verdana","Verdana"],["Arial","Arial"],["Courier New","Courier New"],["Times New Roman","Times New Roman"],["Comic Sans MS","Comic Sans"],["Georgia","Georgia"],["Tahoma","Tahoma"],["Trebuchet MS","Trebuchet"]],fontNames={Font:"",Verdana:"Verdana",Arial:"Arial","Courier New":"Courier New","Times New Roman":"Times New Roman","Comic Sans":"Comic Sans MS",Georgia:"Georgia",Tahoma:"Tahoma",Trebuchet:"Trebuchet MS"},fontColors={Color:"",Black:"#000000",Red:"#FF0000",Blue:"#0000FF","Dark Blue":"#00008B","Navy Blue":"#000080",Brown:"#A52A2A",Green:"#008000",Orange:"#FFA500","Light Grey":"#D3D3D3",Silver:"#C0C0C0"},fontSizes={Size:"",8:"1",10:"2",12:"3",14:"4",18:"5",24:"6",36:"7"};function _getFontSizePts(e){for(var t in fontSizes)if(fontSizes[t]==e)return t;return null}var fontSizeInPixel={10:"1",12:"2",13:"2",16:"3",18:"4",24:"5",32:"6",48:"7"};function getFontSizeFromPixel(e){return fontSizeInPixel[e]?fontSizeInPixel[e]:""}function makeHtmlEditor(e,t,n,r,i,s,o,u,a){if(document.getElementById(e+"_fs")==null)return null;isNaN(i)||(i=Math.min(i*20,500)),isNaN(r)||(r=Math.min(r*6,800));var f=new NLHtmlEditor(e,t,n,r,i,s,o);return window.htmleditors[e]=f,u!=null&&(f.defaultFont=u),a!=null&&(f.defaultFontSize=a),f.launchEditor(),f.hasAttribute(128)&&f.setMandatory(!0),f.hasAttribute(2048)&&f.setDisabled(!0),f}var NLHTMLEDITOR_FORMATTED_LABEL="Formatted Text",NLHTMLEDITOR_SOURCECODE_LABEL="HTML Source Code",NLHTMLEDITOR_FORMATTED_HELPER_TEXT="Type text and format it using the toolbar.",NLHTMLEDITOR_FORMATTED_HELPER_TEXT_WITH_STYLE='<font color="#666666">'+NLHTMLEDITOR_FORMATTED_HELPER_TEXT+"</font>",NLHTMLEDITOR_SOURCECODE_HELPER_TEXT="<!-- Type or paste HTML code -->",NLHTMLEDITOR_STYLE_SMALL_TEXT="smalltext";function NLHtmlEditor(e,t,n,r,i,s,o){this.name=e,this.span=document.getElementById(e+"_fs"),this.value=t,this.defaultValue=t,this.main=null,this.editor=null,this.toggleHeader=null,this.toolbar=null,this.hddn=null,this.defaultTextMode=s,this.textMode=s,this.width=r!=null?r:400,this.height=i!=null?i:200,this.onChangeFunc=n,this.flags=o?o:0,this.toggleSpan=null,this.disabled=!1,this.mandatory=!1,this.mandatoryBgColor="#FFFFE5",this.defaultFont=null,this.defaultFontSize=null,this.responseLock=!1,this.responseQueue=0}NLHtmlEditor.prototype.launchEditor=function(){this.main=document.createElement("DIV"),this.main.id=this.name+"_main",this.main.unselectable="on",this.main.style.border="solid 1px #999999",this.main.style.backgroundColor="#ECEFF6",this.main.className="htmleditormain",this.span.appendChild(this.main),this.buildToggleHeader(),this.buildToolBar(),this.buildEditor(),this.setEditorMode(this.textMode)},NLHtmlEditor.prototype.buildEditor=function(){this.editor=document.createElement("DIV"),this.editor.id=this.name+"_editor",this.editor.unselectable="on",this.editor.style.width="100%",this.editor.style.borderWidth="1px 0 0px 0",this.editor.style.borderStyle="solid",this.editor.style.borderColor="#999999",this.editor.style.marginTop="8px",this.main.appendChild(this.editor),this.editorHtml=document.createElement("IFRAME"),this.editorHtml.id=this.name+"_html",this.editorHtml.src="javascript:false",this.editorHtml.style.height=this.height,this.editorHtml.style.width="100%",this.editorHtml.frameBorder="0",this.editorText=document.createElement("TEXTAREA"),this.editorText.id=this.name+"_text",this.editorText.className="input"+(this.mandatory?"req":""),this.editorText.onkeypress=new Function("event","setEventCancelBubble(event); return true"),this.editorText.style.height=this.height,this.editorText.style.width="100%",this.editorText.style.borderWidth="0px"},NLHtmlEditor.prototype.buildToggleHeader=function(){this.toggleHeader=document.createElement("DIV"),this.toggleHeader.id=this.name+"_footer",this.toggleHeader.unselectable="on",this.toggleHeader.style.padding="5px 2px 3px 5px",this.toggleHeader.style.width=this.width,this.toggleSpan=document.createElement("SPAN"),this.toggleSpan.className="tinytext";var t=document.createElement("A");t.className="tinytextnolink";var n=document.createElement("A");n.className="tinytextnolink",this.setToggleLinks(t,n),this.toggleSpan.appendChild(t),this.toggleSpan.appendChild(n),this.toggleHeader.appendChild(this.toggleSpan),this.hddn=document.createElement("INPUT"),this.hddn.type="hidden",this.hddn.value=this.value,this.hddn.name=this.name,this.hddn.id=this.name,this.onChangeFunc!=null&&(this.hddn.onchange=new Function(this.onChangeFunc)),this.toggleHeader.appendChild(this.hddn),this.main.appendChild(this.toggleHeader),this.span.parentNode.style.paddingBottom="5px"},NLHtmlEditor.prototype.buildToolBar=function(){this.toolbar=document.createElement("DIV"),this.toolbar.id=this.name+"_toolbar",this.toolbar.style.padding="4px 4px 2px 4px",this.toolbar.style.height="22px",this.toolbar.unselectable="on",this.toolbar.style.backgroundColor="#ECEFF6",this.toolbar.style.borderWidth="0px",this.main.appendChild(this.toolbar),this.buildToolBarIcon("fontname","Font","FontName"),this.buildToolBarIcon("fontsize","Size","FontSize"),this.buildToolBarIcon("fontcolor","Color","ForeColor"),isNaN(this.width)||parseInt(this.width)>425?this.buildToolBarLiner():this.buildToolBarLineBreak(),this.buildToolBarIcon("bold","Bold","Bold"),this.buildToolBarIcon("italic","Italic","Italic"),this.buildToolBarIcon("underline","Underline","Underline"),this.buildToolBarLiner(),this.buildToolBarIcon("justifyleft","Justify Left","JustifyLeft"),this.buildToolBarIcon("justifycenter","Justify Center","JustifyCenter"),this.buildToolBarIcon("justifyright","Justify Right","JustifyRight")},NLHtmlEditor.prototype.buildToolBarIcon=function(t,n,r){var i=this.name+"_toolbar_"+t;if(r=="FontName"||r=="FontSize"||r=="ForeColor"){var s=new Array,o;r=="FontName"?o=fontNames:r=="FontSize"?o=fontSizes:o=fontColors;for(var u in o)s[s.length]=u,s[s.length]=o[u];var a=document.createElement("SELECT");a.name=i,a.id=i+"_fs",a.className="input",a.unselectable="on",a.tabIndex=-1,a.onchange=new Function('getHtmlEditor("'+this.name+'").setFocus(); getHtmlEditor("'+this.name+'").handleToolBarEvent("'+r+'", getSelectValue(this)); NS.form.setChanged(true);');for(var f=0;f<s.length;f+=2){var l=document.createElement("OPTION");l.text=s[f],l.value=s[f+1],l.unselectable="on";var c=f>0?a.options[f/2-1]:null;a.add(l,c)}this.toolbar.appendChild(a)}else{var h=document.createElement("BUTTON");h.id=i,h.btnCommand=r,h.tabIndex=-1,h.className="editorbutton",h.unselectable="on",h.title=n,h.style.padding="1px",h.style.margin=0,h.style.marginTop="3px",h.style.backgroundColor="#ECEFF6",h.style.verticalAlign="bottom",h.onmouseover=new Function("if (this.className =='editorbutton') this.className='editorbuttonhover'"),h.onmousedown=new Function("this.className='editorbuttondown';"),h.onmouseout=new Function("if (this.className =='editorbuttonhover') this.className='editorbutton'"),h.onclick=new Function("getHtmlEditor('"+this.name+"').handleToolBarEvent('"+r+"'); return false;");var p=document.createElement("IMG");p.src="/images/nav/editor/"+t+".gif",p.unselectable="on",p.padding=0,p.margin=0,p.border=0,p.style.height="18px",p.style.width="18px",h.appendChild(p),this.toolbar.appendChild(h)}},NLHtmlEditor.prototype.buildToolBarLineBreak=function(){var t=document.createElement("BR");t.unselectable="on",this.toolbar.appendChild(t)},NLHtmlEditor.prototype.buildToolBarLiner=function(){var t=document.createElement("SPAN");t.style.width="1px",t.style.height="16px",t.style.border="1px inset",t.style.margin="0 3px 0 3px",t.unselectable="on",t.style.display="inline",t.style.padding=0,this.toolbar.appendChild(t)},NLHtmlEditor.prototype.hasAttribute=function(t){return(this.flags&t)!=0},NLHtmlEditor.prototype.getValue=function(){return this.value},NLHtmlEditor.prototype.getDisplayValue=function(){var t=null;return this.textMode?t=this.editorText.value:t=this.editorHtml.contentWindow.document.body.innerHTML,t=this.handleEscaping(t,!1),t};var NLExtHtmlEditor={};NLExtHtmlEditor.createEditor=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d=NS.jQuery("#exthtmlfield-"+e),v=d.data("font-family"),m=d.data("font-size"),g="'background-color:"+u+";'",y=p?Ext.form.WholeHtmlEditor:Ext.form.HtmlEditor;Ext.onReady(function(){Ext.QuickTips.init(),NetSuite.RTEManager.initialize();var u=new Ext.Panel({renderTo:"exthtmlfield-"+e,layout:"fit",style:"border-color: #D5DEE7;",hideMode:"offsets",id:"html-editor-container-"+t,name:"html-editor-container-"+t,bodyStyle:g,items:[new y({id:"html-editor-"+t,name:"html-editor-"+t,disabled:!a,renderWidth:c,renderHeight:h,width:c,height:h,readOnly:!0,defaultFont:v,customFontSize:m,emptyText:NLHTMLEDITOR_SOURCECODE_HELPER_TEXT,plugins:Ext.ux.form.HtmlEditor.plugins(),hideLabel:!0,labelSeparator:"",listeners:{editmodechange:function(e,t){if(Ext.isChrome){var n=e.onChangeFunc.match(/validate_html\(this, '(.*)'\);};/),r=n&&n[1]||null;validate_html(e.hddn,r)}else t&&(e.el.dom.blur(),e.el.dom.focus());e.setSize(e.wrap.getSize()),NetSuite.RTEManager.resyncSizeAll(!0)},initialize:function(e){e.toggleSourceEdit(r,!0),NS.form.setChanged(!1),e.lastEditMadeInSourceMode=r,e.setReadOnly(!1);var t=new Ext.Resizable(e.wrap,{handles:"e,s,se",minWidth:c,minHeight:h});t.on("resize",function(t,n,r,i){e.setSize(e.wrap.getSize()),NetSuite.RTEManager.resyncSizeAll(!0)});var n=NetSuite.RTEManager.getDeferredInitializationInstance(e.getName());n!=null&&(n(),NetSuite.RTEManager.unregisterDeferredRTEInitialization(e.getName())),NetSuite.RTEManager.finalizeIfLastInitialized(e.getName())}}})]}),p=Ext.getCmp("html-editor-"+t);this.textModeHasFocus=!1,p.mandatory=!1,p.finalized=!1,p.defaultFontSize=m,p.flags=s?s:0,p.hddn=o,p.hddn||(p.hddn=document.createElement("INPUT"),p.hddn.type="hidden",p.hddn.value=n,p.hddn.name=t,p.hddn.id=t),p.value=n,p.defaultTextMode=r,p.defaultValue=n,p.onChangeFunc=i,i!=null&&typeof p.hddn.onchange!="function"&&(p.hddn.onchange=new Function(i)),Ext.get(e).appendChild(p.hddn),p.el.dom.onblur=function(e){e=e||window.event;var t=e.target||e.srcElement,n=getHtmlEditor(t.id);n.hddn.ignoreValidation=!0,n.textareaOnblur(),n.hddn.ignoreValidation=!1;var r=n.onChangeFunc.match(/validate_html\(this, '(.*)'\);};/),i=r&&r[1]||null;validate_html(n.hddn,i)},Ext.isIE||(p.el.dom.onkeyup=new Function("var editor = getHtmlEditor('html-editor-"+t+"'); NetSuite.RTEManager.saveSelection(document); editor.setValue( editor.getDisplayValue() ); editor.pushValue(); NetSuite.RTEManager.restoreSelection();")),p.el.dom.onfocus=new Function("getHtmlEditor('html-editor-"+t+"').textareaOnfocus()"),NetSuite.RTEManager.registerRTE({widgetID:"html-editor-"+t,widgetComponentInstance:p,widgetHiddenElementID:t}),p.lastEditMadeInSourceMode=p.defaultTextMode,NS.form.setChanged(!1),f&&p.setMandatory(!0,'"+nl.getNLUser().getLook().getColors().m_bgrequiredfld+"'),l&&p.setDisabled(!0)})},NLExtHtmlEditor.setValue=function(e,t,n){var r=typeof n=="undefined"?!1:n,i=NetSuite.RTEManager.getInstance(e);if(i){i.hddn.value!=t&&NS.form.setChanged(!0);var s=i.value?i.value:"";i.value=t,i.hddn.value=i.value;if(i.onChangeFunc!=null){var o=i.hddn.onchange();o!=null&&!o&&(i.value=i.hddn.truncatedValue?i.hddn.value:s,i.hddn.value=i.value,i.setDisplayValue(i.value))}r&&i.setDisplayValue(i.value)}},NLExtHtmlEditor.resetEditor=function(e){var t=NetSuite.RTEManager.getInstance(e);t.reset(),t.setDesignMode(!1),t.setDesignMode(!0),t.lastEditMadeInSourceMode=this.defaultTextMode},NLHtmlEditor.prototype.setValue=function(t,n){var r=this.value;this.value=t,this.hddn.value=this.value;if(this.onChangeFunc!=null){var i=this.hddn.onchange();i!=null&&!i&&(this.value=this.hddn.truncatedValue?this.hddn.value:r,this.hddn.value=this.value,this.setDisplayValue(this.value))}n&&this.setDisplayValue(this.value)},NLHtmlEditor.prototype.setDisplayValue=function(t){var n=this.handleEscaping(t,!0),r=isValEmpty(n);if(this.textMode)r?(this.editorText.value=NLHTMLEDITOR_SOURCECODE_HELPER_TEXT,this.editorText.style.fontFamily="courier",this.editorText.style.color="#666666"):(this.editorText.value=n,this.editorText.style.fontFamily="",this.editorText.style.color="");else{r&&(n="<font color='#666666'>"+NLHTMLEDITOR_FORMATTED_HELPER_TEXT+"</font>"),this.editorHtml.contentWindow.document.open();var i=getStyleForClass("smalltext","fontSize"),s=getCascadedStyle(document.body,"fontFamily","font-family");this.editorHtml.contentWindow.document.write("<html><body contenteditable='true' width=100%; height=100%; topmargin=1 leftmargin=1 style='font-size: "+i+"; font-family: "+s+"'>");var o=(this.defaultFontSize!=null||this.defaultFont!=null)&&this.value==this.defaultValue;if(o){var u=this.defaultFontSize!=null?"size="+fontSizes[this.defaultFontSize]:"",a=this.defaultFont!=null?"face='"+this.defaultFont+"'":"";this.editorHtml.contentWindow.document.write("<FONT "+u+" "+a+">")}var f=/\s*<div>(.*)<\/div>\s*$/i;f.test(n.split("\n").join("\r"))||(n="<DIV>"+n+"</DIV>"),this.editorHtml.contentWindow.document.write(n),o&&this.editorHtml.contentWindow.document.write("</FONT>"),this.editorHtml.contentWindow.document.write("</body></html>"),this.editorHtml.contentWindow.document.close(),this.mandatory?this.editorHtml.contentWindow.document.body.style.backgroundColor=this.mandatoryBgColor:this.editorHtml.contentWindow.document.body.style.backgroundColor=getRuntimeStyle(this.editorText,"backgroundColor"),setTimeout(this.setupEventHandlers.bind(this),500)}},NLHtmlEditor.prototype.stripExtraDivs=function(t){var n=/<div/i,r=/<\/div>/i,i=/^>/,s=/^>.*<BR(>| .*>)\s*$/i,o=/<BR(>| .*>)\s*$/i,u=(" "+t+" ").split(n),a=new Array;a.push(u[0]);for(var f=1;f<u.length;f++){var l=u[f].split(r);a.push(l[0]);for(var c=1;c<l.length;c++){var h=a.pop();s.test(h)?h=h.substring(1):i.test(h)?h=h.substring(1)+"<BR>":i.test(h)||(h="<div"+h+"</div>"),a.push(a.pop()+h+l[c])}}var p=a.pop();p=p.substring(0,p.length-1);while(o.test(p))p=p.replace(o,"");return a.push(p),t=a.join("<div"),t=t.substring(1),t},NLHtmlEditor.prototype.handleEscaping=function(t,n){return!isValEmpty(t)&&!this.textMode&&(t=this.stripExtraDivs(t),t=t.replace(/<STRONG>/gi,"<B>").replace(/<\/STRONG>/gi,"</B>").replace(/<EM>/gi,"<I>").replace(/<\/EM>/gi,"</I>"),t=n?t.replace(/<NL([^>]{2,})>/g,"&lt;NL$1&gt;"):t.replace(/&lt;NL([^&\]]{2,})(&gt;|>)/g,"<NL$1>"),t=n?t.replace(/<(SCRIPT)\b/gi,"<!--NLHIDE:$1").replace(/(<\/SCRIPT\s*)>/gi,"$1:NLHIDE-->"):t.replace(/<\!--NLHIDE:/g,"<").replace(/:NLHIDE-->/g,">")),t},NLHtmlEditor.prototype.insertValue=function(t,n){if(isValEmpty(t))return;if(this.disabled)return;if(!n){this.setFocus(),setTimeout(new Function("getHtmlEditor('"+this.name+"').insertValue('"+t+"',true)"),200);return}var r=this.handleEscaping(t,!0),i,s,o=this.textMode?document:this.editorHtml.contentWindow.document;if(this.textMode&&this.editorText.value==NLHTMLEDITOR_SOURCECODE_HELPER_TEXT||!this.textMode&&this.getValue()!=null&&this.getDisplayValue().indexOf(NLHTMLEDITOR_FORMATTED_HELPER_TEXT)!=-1)this.setDisplayValue(r);else if(window.getSelection){i=this.textMode?window.getSelection():this.editorHtml.contentWindow.getSelection(),s=i.getRangeAt(0);var u=o.createTextNode(this.textMode?r:t);if(s.startContainer.tagName=="DIV"&&s.startContainer.firstChild.tagName=="TEXTAREA"){var a=s.startContainer.firstChild,f=a.selectionEnd+r.length;a.value=a.value.substring(0,a.selectionEnd)+r+a.value.substring(a.selectionEnd),a.selectionStart=a.selectionEnd=f}else{if(s.collapsed)s.insertNode(u);else{var l=o.createDocumentFragment();l.appendChild(s.extractContents()),l.appendChild(u),s.insertNode(l)}s.selectNodeContents(u),s.collapse(!1),s.commonAncestorContainer.normalize()}}else o.selection&&(i=o.selection,s=i.createRange(),this.textMode?s.text=s.text+r:s.pasteHTML(s.htmlText+r),s.collapse(!1),s.select());this.setValue(this.getDisplayValue())},NLHtmlEditor.prototype.setMandatory=function(t,n){this.mandatory=t,this.mandatoryBgColor=n!=null?n:"#FFFFE5",this.mandatoryBgColor.charAt(0)!="#"&&(this.mandatoryBgColor="#"+this.mandatoryBgColor),this.editorText.className="input"+(this.mandatory?"req":""),this.editorHtml.contentWindow.document.body.style.backgroundColor=this.mandatory?this.mandatoryBgColor:"#FFFFFF"},NLHtmlEditor.prototype.getMandatory=function(){return this.mandatory},NLHtmlEditor.prototype.handleToolBarEvent=function(t,n){this.editorHtml.contentWindow.document.body.focus();if(this.range){var r=this.editorHtml.contentWindow.getSelection();r.empty(),r.setBaseAndExtent(this.range.baseNode,this.range.baseOffset,this.range.extentNode,this.range.extentOffset)}if(this.disabled)return;if(this.textMode)return;if(t=="FontName"||t=="FontSize"||t=="ForeColor"){if(!isValEmpty(n)){t=="FontSize"&&(n=getSelectTextForValue(document.getElementById(this.name+"_toolbar_fontsize_fs"),n)+"pt"),this.editorHtml.contentWindow.document.execCommand(t,!1,n);var i=this.editorHtml.contentWindow.document.body.firstChild;isValEmpty(i.innerHTML)&&i.nodeType!=3&&(t=="FontName"?i.style.fontFamily=n:t=="FontSize"?i.style.fontSize=_getFontSizePts(n)+"pt":t=="ForeColor"&&(i.style.color=n))}}else this.editorHtml.contentWindow.document.execCommand(t,!1,null);this.setValue(this.getDisplayValue()),this.bookmarkSelection(),this.syncToolBarWithEditor(t,n)},NLHtmlEditor.prototype.scheduleEditorEventHandler=function(t,n){if(this.disabled)return;setTimeout(new Function("getHtmlEditor('"+this.name+"').handleEditorEvent('"+t+"')"),n)},NLHtmlEditor.prototype.handleEditorEvent=function(t,n){if(this.disabled)return!0;if(this.responseLock)return t!="mouseup"&&this.responseQueue++,!0;this.responseLock=!0;var r=new Function("var editor = getHtmlEditor('"+this.name+"'); editor.responseLock = false; if ( editor.responseQueue > 0 ) { editor.responseQueue = 0; editor.handleEditorEvent('"+t+"'); }");return setTimeout(r,333),this.getValue()!=null&&this.getDisplayValue().indexOf(NLHTMLEDITOR_FORMATTED_HELPER_TEXT)==-1&&this.getDisplayValue()!=this.getValue()&&this.setValue(this.getDisplayValue()),t=="mousedown"&&this.iFrameOnfocus(),this.bookmarkSelection(),this.ToolbarUpdateTimer&&clearTimeout(this.ToolbarUpdateTimer),this.ToolbarUpdateTimer=setTimeout(function(){this.syncToolBarWithEditor()}.bind(this),100),!0},NLHtmlEditor.prototype.bookmarkSelection=function(){var t=this.editorHtml.contentWindow.getSelection();t&&t.anchorNode&&t.focusNode&&(range=new Object,range.baseNode=t.baseNode,range.baseOffset=t.baseOffset,range.extentNode=t.extentNode,range.extentOffset=t.extentOffset,this.range=range)},NLHtmlEditor.prototype.resetEditor=function(){this.setValue(this.defaultValue);var t=this.toggleHeader.firstChild;t!=null&&(this.defaultTextMode&&!t.checked||!this.defaultTextMode&&t.checked)&&setFormValue(this.toggleHeader.firstChild,this.defaultTextMode),this.setEditorMode(this.defaultTextMode)},NLHtmlEditor.prototype.setDisabled=function(t){this.disableToolBar(t),this.editor.disabled=t,this.textMode?this.editorText.disabled=t:this.editorHtml.contentWindow.document.body.disabled=t,this.toggleHeader.disabled=t,this.toggleHeader.firstChild.disabled=t,this.disabled=t},NLHtmlEditor.prototype.disableToolBar=function(t){this.toolbar.disabled=t;var n=this.toolbar.getElementsByTagName("BUTTON");for(var r=0;r<n.length;r++)n[r].disabled=t,t&&n[r].className=="editorbuttondown"&&(n[r].className="editorbutton");n=this.toolbar.getElementsByTagName("SPAN");for(var r=0;r<n.length;r++)n[r].disabled=t;n=this.toolbar.getElementsByTagName("IMG");for(var r=0;r<n.length;r++)n[r].disabled=t;var n=this.toolbar.getElementsByTagName("SELECT");for(var r=0;r<n.length;r++)disableSelect(n[r],t)},NLHtmlEditor.prototype.syncToolBarWithEditor=function(t,n){if(this.disabled)return;if(this.textMode)return;var r=this.editorHtml.contentWindow.document,i=this.toolbar.getElementsByTagName("BUTTON");for(var s=0;s<i.length;s++){var t=i[s].btnCommand;try{r.queryCommandState(t)?i[s].className="editorbuttondown":i[s].className="editorbutton"}catch(o){i[s].className="editorbutton"}}var n=r.queryCommandValue("fontsize");if(!n||n.length==0)n="";else if(n.indexOf("px")>0||n.indexOf("pt")>0)n=n.substr(0,n.length-2),n=getFontSizeFromPixel(n);setSelectValue(document.getElementById(this.name+"_toolbar_fontsize_fs"),n),n=r.queryCommandValue("fontname");var u=document.getElementById(this.name+"_toolbar_fontname_fs"),a=getSelectValueArray(u);if(n)for(var s=0;s<a.length;s++)if(a[s].length>0&&n.indexOf(a[s])>=0){setSelectIndex(u,s);break}s==a.length&&setSelectValue(document.getElementById(this.name+"_toolbar_fontname_fs"),""),n=r.queryCommandValue("forecolor");var f="";n&&(f=String(n).charAt(0)=="#"?n:getHexColorValue(n)),setSelectValue(document.getElementById(this.name+"_toolbar_fontcolor_fs"),f)};function getHexColorValue(e){if(typeof e=="number")return getHexValueFromDecimal(e);if(e.indexOf("rgb(")==0){var t=e.substring(4,e.length-1).split(",");return"#"+getTwoDigitHexString(t[0])+getTwoDigitHexString(t[1])+getTwoDigitHexString(t[2])}}NLHtmlEditor.prototype.setToggleLinks=function(t,n){this.setActiveToggleLink(t,this.textMode?NLHTMLEDITOR_SOURCECODE_LABEL:NLHTMLEDITOR_FORMATTED_LABEL),this.setInactiveToggleLink(n,this.textMode?NLHTMLEDITOR_FORMATTED_LABEL:NLHTMLEDITOR_SOURCECODE_LABEL,!this.textMode)},NLHtmlEditor.prototype.setActiveToggleLink=function(t,n){t.onclick=new Function("return false;"),t.removeAttribute("href"),t.innerHTML="<b>"+n+"</b>&nbsp;",t.className="textnolink"},NLHtmlEditor.prototype.setInactiveToggleLink=function(t,n,r){t.onclick=new Function("getHtmlEditor('"+this.name+"').setEditorMode("+r+"); return false;"),t.href="javascript:void('"+n+"')",t.innerHTML="("+n+")",t.className="dottedlink"},NLHtmlEditor.prototype.setEditorMode=function(t){if(this.disabled)return;this.textMode=t;if(t){if(this.editorText==null)return;document.getElementById(this.editorHtml.id)!=null&&(this.editor.removeChild(this.editorHtml),this.editorText.style.width=="100%"&&(this.editorText.style.width=document.getElementById(this.name+"_main").offsetWidth)),this.setDisplayValue(this.value),this.editor.appendChild(this.editorText),this.toolbar.style.display="none",this.setupEventHandlers()}else{if(this.editorHtml==null)return;document.getElementById(this.editorText.id)!=null&&this.editor.removeChild(this.editorText),this.editor.appendChild(this.editorHtml),this.setDisplayValue(this.value),this.toolbar.style.display="inline"}this.setToggleLinks(this.toggleSpan.childNodes[0],this.toggleSpan.childNodes[1])},NLHtmlEditor.prototype.getFieldId=function(){return this.textMode?this.editorText.id:this.editorHtml.id},NLHtmlEditor.prototype.getField=function(){return this.textMode?this.editorText:this.editorHtml.contentWindow.document.body},NLHtmlEditor.prototype.setupEventHandlers=function(){this.textMode?(this.editorText.onblur=new Function("var editor = getHtmlEditor('"+this.name+"'); editor.setValue( editor.getDisplayValue() )"),this.editorText.onfocus=new Function("getHtmlEditor('"+this.name+"').textareaOnfocus()")):document.addEventListener?(this.editorHtml.contentWindow.document.onkeydown=null,this.editorHtml.contentWindow.document.onkeypress=null,this.editorHtml.contentWindow.document.onkeyup=null,this.editorHtml.contentWindow.document.onmousedown=null,this.editorHtml.contentWindow.document.onmouseup=null,this.editorHtml.contentWindow.document.body.oncut=null,this.editorHtml.contentWindow.document.body.onpaste=null,this.editorHtml.contentWindow.document.onfocus=null,this.editorHtml.contentWindow.document.addEventListener("keydown",function(e){return this.handleEditorEvent("keydown",e)}.bind(this),!1),this.editorHtml.contentWindow.document.addEventListener("keypress",function(e){return this.handleEditorEvent("keypress",e)}.bind(this),!1),this.editorHtml.contentWindow.document.addEventListener("mouseup",function(e){return this.handleEditorEvent("mouseup",e)}.bind(this),!1),this.editorHtml.contentWindow.document.addEventListener("mousedown",function(e){return this.handleEditorEvent("mousedown",e)}.bind(this),!1),this.editorHtml.contentWindow.document.addEventListener("cut",function(e){this.scheduleEditorEventHandler("cut",100,e)}.bind(this),!1),this.editorHtml.contentWindow.document.addEventListener("paste",function(e){this.scheduleEditorEventHandler("paste",100,e)}.bind(this),!1),this.editorHtml.contentWindow.document.addEventListener("focus",function(e){this.iFrameOnfocus()}.bind(this),!0)):(this.editorHtml.contentWindow.document.onkeydown=new Function("getHtmlEditor('"+this.name+"').handleEditorEvent('keydown')"),this.editorHtml.contentWindow.document.onkeypress=new Function("getHtmlEditor('"+this.name+"').handleEditorEvent('keypress')"),this.editorHtml.contentWindow.document.onkeyup=new Function("getHtmlEditor('"+this.name+"').handleEditorEvent('keyup')"),this.editorHtml.contentWindow.document.onmousedown=new Function("getHtmlEditor('"+this.name+"').handleEditorEvent('mousedown')"),this.editorHtml.contentWindow.document.onmouseup=new Function("getHtmlEditor('"+this.name+"').handleEditorEvent('mouseup')"),this.editorHtml.contentWindow.document.body.oncut=new Function("getHtmlEditor('"+this.name+"').scheduleEditorEventHandler( 'cut', 100 )"),this.editorHtml.contentWindow.document.body.onpaste=new Function("getHtmlEditor('"+this.name+"').scheduleEditorEventHandler( 'paste', 100 )"),this.editorHtml.onfocus=new Function("getHtmlEditor('"+this.name+"').iFrameOnfocus()"),this.editorHtml.onblur=new Function("getHtmlEditor('"+this.name+"').iFrameOnblur();"))},NLHtmlEditor.prototype.iFrameOnfocus=function(){var t=this.editorHtml.contentWindow.document;t.body.innerHTML.indexOf(NLHTMLEDITOR_FORMATTED_HELPER_TEXT)>-1&&(t.body.innerHTML="<div><br></div>",t.body.focus())},NLHtmlEditor.prototype.iFrameOnblur=function(){var t=this.editorHtml.contentWindow.document;return t.body.contentEditable=!1,!0},NLHtmlEditor.prototype.textareaOnfocus=function(){this.editorText.value==NLHTMLEDITOR_SOURCECODE_HELPER_TEXT&&(this.editorText.style.fontFamily="",this.editorText.style.color="",this.editorText.value="")},NLHtmlEditor.prototype.setFocus=function(){if(this.disabled)return;this.textMode?setTimeout(new Function("getHtmlEditor('"+this.name+"').editorText.focus()"),100):setTimeout(new Function("getHtmlEditor('"+this.name+"').editorHtml.contentWindow.document.body.focus()"),100)};function insertHtmlValue(e,t){var n=getHtmlEditor(e);if(n!=null){n.insertValue(t,!1);return}var r=document.getElementById(e);if(r){var i=r.textLength,s=r.selectionStart,o=r.selectionEnd;if(o==1||o==2)o=i;r.value=r.value.substring(0,s)+t+r.value.substr(o,i)}}function setHtmlFieldValue(e,t,n){if(e==null)return;n==null&&(n=window);var r=n.getHtmlEditor(e.name);r!=null?r.setValue(t,!0,!0):e.value=t}function disableHtmlField(e,t){if(t==null)return;var n=getHtmlEditor(t.name);n!=null?n.setDisabled(e):t.disabled=e}function resetHtmlEditors(e){typeof NetSuite=="object"&&typeof NetSuite.RTEManager=="object"&&NetSuite.RTEManager.getMap().eachKey(function(t,n){var r=n.obj;(e==null||r.hddn.form==e)&&NLExtHtmlEditor.resetEditor(t)})}function getHtmlEditor(e){return typeof Ext!="object"||typeof NetSuite!="object"?null:typeof e=="undefined"||e==null?null:(e.indexOf("html-editor-")!=0&&(e="html-editor-"+e),NetSuite.RTEManager.getInstance(e))}function getSelectedElement(e){var t=null;if(e.document.selection){selection=e.document.selection,range=selection.createRange();try{t=range.parentElement()}catch(n){return null}}else{try{selection=e.getSelection(),range=selection.getRangeAt(0)}catch(n){return null}t=range.commonAncestorContainer}return t}function updateQuickDateSelector(e){var t=document.getElementById("quickdateselector");if(t!=null){var n=t.onchange;t.onchange=null;var r=getDropdown(t);if(r!=null){var i=r.getIndexForValue(e);r.setIndex(i)}t.onchange=n}}function statusMessage(e,t){e==null&&(e=2e3),window.status=t,setTimeout("window.status = ''",e)}function NLAccelMenu_cancelCurrentTimer(){var e=window.accelMenuDiv;e&&e.nTimerId&&(clearTimeout(e.nTimerId),e.nTimerId=0)}function NLAccelMenu_closeCurrentMenu(){var e=window.accelMenuDiv;if(e){var t=e.getAttribute("bMachine")=="T";NLAccelMenu_cancelCurrentTimer(),e.style.display="none",e.img.src="/images/nav/popupselectup"+(t?"":"2")+".gif",e.img.className=e.img.className.replace("_focus","")}window.accelMenuDiv=null}function NLAccelMenu_onMouseOut(e){var t=window.accelMenuDiv;t&&(t.nTimerId=setTimeout(function(){NLAccelMenu_closeCurrentMenu()},200))}function NLAccelMenu_onMouseOver(e){NLAccelMenu_cancelCurrentTimer()}function NLAccelMenu_onButtonClick(e,t,n,r){var i=document.getElementById(t);i.setAttribute("bMachine",n?"T":"F"),r.src="/images/nav/popupselectdown"+(n?"":"2")+".gif",i.img=r,r!=null&&(r.className=r.className+"_focus"),NLAccelMenu_closeCurrentMenu(),window.accelMenuDiv=i,i.parentNode.style.display="inline",i.style.display="";var s=i.firstChild.offsetWidth;s!=undefined&&(i.style.width=s),i.style.display="block",i.parentNode.style.zIndex="9000",NLAccelMenu_positionDIV(i)}function NLAccelMenu_positionDIV(e){var t=findPosY(e.img),n=t+22,r=getDocumentHeight(),i=parseInt(e.offsetHeight);n+i>r?t=-i:t=22,e.style.top=t+"px"}function NLAccelMenuButton_onMouseDown(e){e.firstChild.onclick()}function NLAccelMenuButton_onMouseOver(e){e.className="dropdownSelected"}function NLAccelMenuButton_onMouseOut(e){e.className="dropdownNotSelected"}var burstTimer=0,bursting=-1,newBGImageMap=new Array;newBGImageMap[0]="/images/icons/dashboard/top_bkg.gif",newBGImageMap[1]="/images/icons/dashboard/left_edge_bkg.gif",newBGImageMap[2]="/images/icons/dashboard/right_edge_bkg.gif",newBGImageMap[3]="/images/icons/dashboard/bottom_edge_bkg.gif";function showBurstRollover(e,t,n,r){try{clearTimeout(burstTimer);if(bursting==n+"_"+r)return;if(e!=null&&t!=null&&t.length>0){var i=findPosY(e),s=findPosX(e),o=document.getElementById("rptsnap"+r);o!=null&&(i-=o.scrollTop);var u=document.getElementById("burst_div_"+r);if(u!=null){if(u.getAttribute("_setBG")!="T"){var a=u.firstChild.getElementsByTagName("TD");for(var f=0;f<a.length;f++)if(a[f].getAttribute("_resbg")!=null){var l=Number(a[f].getAttribute("_resbg"));a[f].style.backgroundImage="url("+newBGImageMap[l]+")"}u.setAttribute("_setBG","T")}dateSpan=document.getElementById("date_span_"+r),dateSpan.removeChild(dateSpan.firstChild);var c=document.createTextNode(t);dateSpan.appendChild(c),u.style.display="block",u.style.position="absolute",u.style.top=i+8+"px",u.style.left=s-32+"px",bursting=n+"_"+r}}}catch(h){console&&console.log(h.message)}}function removeBurst(e){burstTimer=setTimeout(new Function("removeBurstNow('"+e+"');"),200)}function removeBurstNow(e){var t=document.getElementById("burst_div_"+e);t!=null&&(t.style.display="none",bursting=-1)}function expandCollapseNode(e,t){var n=document.getElementById(e+"_top"),r=document.getElementById(e+"_total");if(n==null||r==null)return;var i=findClassUp(n,"enhtable"),s=n.getAttribute("_nototals")=="T",o=i.rows[n.rowIndex+1],u=o.style.display==""||o.style.display=="block"?"none":"";setHrefToggleLabel(u,t),s||(u!="none"?expandNodeRestoreData(n):collapseNodeCopyData(n,r));var a=null,f=0;for(var l=n.rowIndex+1;l<=r.rowIndex;l++){a=i.rows[l];if(f>0&&a.id==null)continue;var c=f;if(u!="none"&&a.id!=null){a.id.substring(a.id.length-4)=="_top"&&a.firstChild.firstChild.getAttribute("_state")=="plus"?f++:a.id.substring(a.id.length-6)=="_total"&&document.getElementById(a.id.substring(0,a.id.length-6)+"_top").firstChild.firstChild.getAttribute("_state")=="plus"&&(f=Math.max(f-1,0));if(c>0)continue}if(u=="none"||!s||a.id.substring(a.id.length-6)!="_total")a.style.display=u}}function setHrefToggleLabel(e,t){e!="none"?(t.firstChild.src="/images/nav/reporting/tree_minus.gif",t.setAttribute("_state","minus")):(t.firstChild.src="/images/nav/reporting/tree_plus.gif",t.setAttribute("_state","plus"))}function expandNodeRestoreData(e){if(e!=null)for(var t=1;t<e.cells.length;t++)e.cells[t].getAttribute("_orightml")!=null&&e.cells[t].getAttribute("_orightml").length>1?(e.cells[t].innerHTML=e.cells[t].getAttribute("_orightml"),e.cells[t].className=e.cells[t].getAttribute("_origclass"),e.cells[t].align=e.cells[t].getAttribute("_origalign")):e.cells[t].innerHTML="&nbsp;"}function collapseNodeCopyData(e,t){if(t!=null&&e!=null)for(var n=1;n<t.cells.length;n++)e.cells[n].setAttribute("_orightml",e.cells[n].innerHTML),e.cells[n].setAttribute("_origclass",e.cells[n].className),e.cells[n].setAttribute("_origalign",e.cells[n].align),e.cells[n].align=t.cells[n].align,e.cells[n].className=t.cells[n].className,e.cells[n].innerHTML=t.cells[n].innerHTML}function manageScrollDiv(e,t){var n=document.getElementById(e);if(n!=null){if(n.className=="scrollarea"&&n.scrollHeight>325)return;var r=!1;n.offsetHeight>325?(n.className="scrollarea",n.style.height="325px",document.getElementById("scrl_line_"+e).style.display="",r=!0):(n.className="",n.style.height="",document.getElementById("scrl_line_"+e).style.display="none"),t!=null&&t!=-1&&resetLabelRowCellSizes(document.getElementById("enhlabel"+t),n.firstChild,r)}}function resetLabelRowCellSizes(e,t,n){if(e!=null&&t!=null){clearAllWidths(t);var r=t.rows[0];r.style.display="";var i=t.rows[1];if(i==null||i.cells.length<=1){r.style.display="none";return}var s=t.offsetWidth-(n?17:0),o=e.parentNode.parentNode.offsetWidth,u=new Array;for(var a=0;a<i.cells.length;a++)u[a]=i.cells[a].offsetWidth;for(var f=e.cells.length-1;f>=0;f--){var l=null,c=f==e.cells.length-1,h=e.cells.length<=2||f>1;c&&(n?e.cells[f].style.paddingRight="16px":e.cells[f].style.paddingRight="");var p=(u[f]+(c&&n?17:0))/o*100,d=u[f]/s*100;e.cells[f].style.width=h?p+"%":u[f]+(c&&n?17:0)+"px";for(var v=0;v<t.rows.length;v++){l=t.rows[v];if(l.cells[f]==null||l.id=="_totallinerow")continue;l.cells[f].style.width=h?d+"%":u[f]+"px"}}r.style.display="none"}}function clearAllWidths(e){for(var t=0;t<e.rows.length;t++)for(var n=0;n<e.rows[t].cells.length;n++)e.rows[t].cells[n].style.width=""}var iMAX_SUGGESTIONS=25,popupsuggesttimer=0,hidesuggesttimer=0,loadingimagetimer=0,hideloadingimagetimer=0,popupAutoSuggest=null,autoSuggestSeqNum=0,highestSeqNumReturned=0;function NLPopupAutoSuggest(){this.inputfield,this.mapkey,this.uniqueuserkey,this.asheep,this.initialLastUserVal,this.fieldname,this.fieldname_hidden,this.fieldvalue,this.optionmasterfield,this.xPos,this.yPos,this.suggestiondiv,this.visible=!1,this.currentcell,this.bUbersearch=!1,this.bmultiselect=!1,this.bautoselectsingleresult=!0,this.bOnlyOneResult=!1}NLPopupAutoSuggest.prototype.setAttributes=function(t,n,r,i){this.inputfield=t,this.mapkey=n,this.fieldname=t.name,this.fieldname_hidden=this.fieldname.indexOf("_display")>0?this.fieldname.substring(0,this.fieldname.indexOf("_display")):this.fieldname,this.fieldvalue=t.value,this.optionmasterfields=i,this.bautoselectsingleresult=r,this.xPos=findPosX(t),this.yPos=findPosY(t),this.currentcell=-1,this.bUbersearch=n=="uberautosuggest",this.bmultiselect=NLPopupAutoSuggest_isMultiSelect(t),isValEmpty(this.uniqueuserkey)&&(this.asheep=t.getAttribute("asheep"),this.uniqueuserkey=t.getAttribute("asuuk"),this.initialLastUserVal=GetCookie("lastUser")+"_"+GetCookie("JSESSIONID"))};function constructSuggestionBoxFromResponse(response){if(popupAutoSuggest!=null){hideAutoSuggestLoadingImage();var objJSON,autoFillResults;try{objJSON=eval("("+response.getBody()+")");var seqNum=parseInt(objJSON.circid);if(highestSeqNumReturned>seqNum)return;highestSeqNumReturned=seqNum,autoFillResults=objJSON.autofill}catch(e){return}if(autoFillResults.length>0){var i,sHtml=new StringBuffer;sHtml.append("<table cellpadding=0 cellspacing=0 border=0><tbody>");for(i=0;i<autoFillResults.length;i++)sHtml.append("<tr>"),popupAutoSuggest.constructCell(sHtml,autoFillResults[i],popupAutoSuggest.fieldname_hidden),sHtml.append("</tr>");i==iMAX_SUGGESTIONS&&(sHtml.append("<tr>"),popupAutoSuggest.constructMoreCell(sHtml,popupAutoSuggest.fieldname_hidden,popupAutoSuggest.fieldvalue),sHtml.append("</tr>")),sHtml.append("</tbody></table>"),popupAutoSuggest.showSuggestionBox(sHtml.toString()),popupAutoSuggest.bautoselectsingleresult&&i==1&&(popupAutoSuggest.selectNextCell(),popupAutoSuggest.bOnlyOneResult=!0)}else popupAutoSuggest.showSuggestionBox(getAutoSuggestMessageHTML("No results found")),hidesuggesttimer=setTimeout("popupAutoSuggest.hideSuggestionBox()",2e3)}}function logAutoSuggestSessionError(e,t){var n=e.uniqueuserkey+"%20|%20"+e.initialLastUserVal,r=t+"%20|%20"+GetCookie("lastUser")+"_"+GetCookie("JSESSIONID");parent.document.location="/core/pages/logAutoSuggestSessionError.nl?olduserkey="+n+"&newuserkey="+r}function getAutoSuggestMessageHTML(e){var t=new StringBuffer;return t.append("<table cellpadding=0 cellspacing=0 border=0><tbody>"),t.append("<tr><td style='padding:2' class=tinygraytext>"+e+"</td></tr>"),t.append("</tbody></table>"),t.toString()}function hideAutoSuggestLoadingImage(){clearTimeout(loadingimagetimer),clearTimeout(hideloadingimagetimer),popupAutoSuggest!=null&&(popupAutoSuggest.inputfield.style.backgroundImage="")}function showAutoSuggestRefineSearchMessage(){popupAutoSuggest!=null&&(popupAutoSuggest.showSuggestionBox(getAutoSuggestMessageHTML("Please enter more characters or click Go")),hidesuggesttimer=setTimeout("popupAutoSuggest.hideSuggestionBox()",4e3))}function showAutoSuggestLoadingImage(){clearTimeout(hideloadingimagetimer),popupAutoSuggest!=null&&(popupAutoSuggest.inputfield.style.backgroundImage="url(/images/help/animated_loading.gif)",popupAutoSuggest.inputfield.style.backgroundRepeat="no-repeat",popupAutoSuggest.inputfield.style.backgroundPosition="100% 1px",hideloadingimagetimer=setTimeout("hideAutoSuggestLoadingImage(); showAutoSuggestRefineSearchMessage();",1e4))}NLPopupAutoSuggest.prototype.constructSuggestionBox=function(){if(this.fieldvalue!=null&&trim(this.fieldvalue).length>0)try{var t="cur_val="+encode(this.bmultiselect?getCurrentMultiSelectUserInputValue(this.inputfield):this.fieldvalue);if(this.optionmasterfields!=null)for(var n in this.optionmasterfields)t+="&si_"+n+"="+encode(getSelectValue(this.optionmasterfields[n]));var r="/app/common/autosuggest.nl?mapkey="+this.mapkey+"&circid="+ ++autoSuggestSeqNum+"&"+t;loadingimagetimer=setTimeout("showAutoSuggestLoadingImage()",1e3),nlXMLRequestURL(r,null,null,new Function("response","constructSuggestionBoxFromResponse(response);"),!0)}catch(i){}},NLPopupAutoSuggest.prototype.constructCell=function(t,n,r){if(this.bUbersearch){var i=n.bedit=="T";t.append("<td nowrap style='padding:1 3 2 3;' class='autosuggcell text'>"),t.append("<table cellpadding=0 cellspacing=0 border=0 width='100%'><tr>"),t.append("<td nowrap>"),t.append('<a class=smalltextnolink href="'+n.key+"\" onclick='popupAutoSuggest.hideSuggestionBox(true); return true;'>"),isValEmpty(n.descr)?t.append(n.sname):t.append("<span></span><span style='color:#666666'><i>"+n.descr+":&nbsp;</i></span><span>"+n.sname+"</span>"),t.append("</a>"),t.append("</td>"),t.append("<td style='padding-left:7; padding-right:2' class=text align=right valign=bottom>"),t.append("<span style='visibility:hidden'>"),isValEmpty(n.dashurl)||(t.append("<a"+(i?" style='position:relative; top:2'":"")+" href='"+n.dashurl+"' onclick='popupAutoSuggest.hideSuggestionBox(true); return true;' class=text title='View Dashboard'>"),t.append("<img class='i_dashboard_white' border=0 src='/images/nav/ns_x.gif' width=14 height=12>"),t.append("</a>"),i&&t.append("&nbsp;&nbsp;")),t.append('<a href="'+n.key+"&e=T\" onclick='popupAutoSuggest.hideSuggestionBox(true); return true;' class=textwhite"+(i?"":" style='display:none'")+">Edit</a>"),t.append("</span>"),t.append("</td>"),t.append("</tr>"),t.append("</table>"),t.append("</td>")}else t.append("<td nowrap style='padding:1 3 2 3; cursor:hand;' class='autosuggcell text' "),t.append(" onmousedown='popupAutoSuggest.setValueFromSuggestion(\""+r+'", "'+n.key+"\", this, event); return false;'>"),t.append(n.sname),t.append("</td>")},NLPopupAutoSuggest.prototype.constructMoreCell=function(t,n,r){t.append("<td nowrap style='cursor:pointer; padding:1 3 2 3; font-style:italic;' class='autosuggcell text' "),t.append('onmousedown="NLPopupAutoSuggest_hidePopupSuggestion(); ');if(this.bUbersearch)t.append("popupAutoSuggest.runMoreUbersearch();");else{var i=r.replace(/\'/g,"\\'").replace(/\"/g,"\\\\&quot;");t.append("NLPopupSelect_runMoreSearch('"+n+"', '"+i+"');")}t.append(' return false;">'),t.append("More..."),t.append("</td>")},NLPopupAutoSuggest.prototype.runMoreUbersearch=function(){document.getElementById("_searchSubmitter").onclick()},NLPopupAutoSuggest.prototype.selectCell=function(t){t!=null&&(this.unSelectCurrentCell(),t.className="dropdownSelected",this.bUbersearch&&t.firstChild&&t.firstChild.rows?setAutoSuggestCellProperties(t,!0):t.childNodes.length>1&&(t.childNodes[1].style.color="#EEEEEE"),this.currentcell=Number(t.parentNode.rowIndex))},NLPopupAutoSuggest.prototype.unSelectCell=function(t){t!=null&&(t.className="autosuggcell text",this.bUbersearch&&t.firstChild&&t.firstChild.rows?setAutoSuggestCellProperties(t,!1):t.childNodes.length>1&&(t.childNodes[1].style.color="#666666"),this.currentcell=-1)};function setAutoSuggestCellProperties(e,t){var n=e.firstChild.rows[0].cells[0],r=e.firstChild.rows[0].cells[1];n.firstChild.className=t?"textwhitenolink":"smalltextnolink",n.firstChild.childNodes.length>1&&(n.firstChild.childNodes[1].style.color=t?"#EEEEEE":"#666666"),r.firstChild.style.visibility=t?"visible":"hidden"}NLPopupAutoSuggest.prototype.selectCellByIndex=function(t){var n=this.getCell(t);this.selectCell(n)},NLPopupAutoSuggest.prototype.unSelectCurrentCell=function(){if(this.currentcell>=0){var t=this.getCell(this.currentcell);this.unSelectCell(t)}},NLPopupAutoSuggest.prototype.doUberSearchClick=function(){var t=this.getCell(this.currentcell);if(t!=null&&t.firstChild&&t.firstChild.rows){var n=t.firstChild.rows[0].cells[0];n.firstChild.onclick();var r=n.firstChild.href;if(this.bOnlyOneResult&&!isValEmpty(this.fieldvalue)){if(this.fieldvalue.toUpperCase().indexOf("E ")==0||isUpperCase(this.fieldvalue.charAt(0)))r=addParamToURL(r,"e","T",!0);this.fieldvalue.indexOf("::")>0||this.fieldvalue.indexOf("^")>0?nlOpenWindow(r,"uberres2"):document.location=r}else document.location=r}else t.onmousedown()},NLPopupAutoSuggest.prototype.getTableRows=function(){return this.suggestiondiv.firstChild.firstChild.childNodes},NLPopupAutoSuggest.prototype.getCell=function(t){return t>=0&&t<this.getTableRows().length?this.getTableRows()[t].firstChild:null},NLPopupAutoSuggest.prototype.selectNextCell=function(){var t=this.currentcell;this.unSelectCurrentCell(),t>=0?(++t>this.getTableRows().length-1&&(t=0),this.selectCellByIndex(t)):this.selectCellByIndex(0)},NLPopupAutoSuggest.prototype.selectPreviousCell=function(){var t=this.currentcell;this.unSelectCurrentCell(),t>=1?this.selectCellByIndex(t-1):this.selectCellByIndex(this.getTableRows().length-1)},NLPopupAutoSuggest.prototype.getSuggestionBoxDiv=function(){return this.suggestiondiv==null&&(this.suggestiondiv=document.createElement("DIV"),this.suggestiondiv.style.position="absolute",this.suggestiondiv.style.backgroundColor="#FFFFFF",this.suggestiondiv.className="popupsuggest",this.suggestiondiv.style.borderColor="#999999",this.suggestiondiv.style.borderStyle="solid",this.suggestiondiv.style.borderWidth="1px 1px 1px 1px",this.suggestiondiv.style.display="none",this.suggestiondiv.style.zIndex="20",document.body.appendChild(this.suggestiondiv)),this.suggestiondiv},NLPopupAutoSuggest.prototype.showSuggestionBox=function(t){clearTimeout(hidesuggesttimer);var n=this.getSuggestionBoxDiv();n.innerHTML=t,n.style.display="",this.visible=!0,this.positionSuggestionBox()},NLPopupAutoSuggest.prototype.positionSuggestionBox=function(){var t=this.getSuggestionBoxDiv();t.style.overflow="",t.style.width="",t.firstChild.style.width="";var n=t.firstChild.offsetWidth;n>400&&(getDocumentClientWidth()-100<t.firstChild.offsetWidth&&(t.style.overflow="hidden"),n=Math.min(getDocumentClientWidth()-100,t.firstChild.offsetWidth),t.style.width=n);var r=this.xPos+(this.bmultiselect?1:0),i=this.yPos+this.inputfield.offsetHeight-1;i+=0,t.offsetWidth<this.inputfield.offsetWidth&&(t.firstChild.style.width=this.inputfield.offsetWidth-2+"px"),this.yPos+this.inputfield.offsetHeight-1+t.offsetHeight>getDocumentHeight()&&this.yPos>getDocumentHeight()-this.yPos&&(i=this.yPos-t.offsetHeight+(this.bmultiselect?1:0)),this.xPos+n+10>getDocumentWidth()&&(r=this.xPos-(n-this.inputfield.offsetWidth)),t.style.top=i+"px",t.style.left=r+"px"},NLPopupAutoSuggest.prototype.hideSuggestionBox=function(t){this.visible&&(clearTimeout(popupsuggesttimer),this.suggestiondiv.style.display="none",this.suggestiondiv.style.width="",this.suggestiondiv.style.overflow="",this.visible=!1,t&&(this.inputfield.value=""),this.suggestiondiv=null)},NLPopupAutoSuggest.prototype.addMultipleSelectValue=function(t,n){var r=getFormElement(this.inputfield.form,this.fieldname),i=getFormElement(this.inputfield.form,this.fieldname_hidden);addMultiSelectValue(i,t,n),r.value+="\n",setSelectionRange(r,r.value.length,r.value.length)},NLPopupAutoSuggest.prototype.setValueFromSuggestion=function(t,n,r,i){setEventPreventDefault(i),setEventCancelBubble(i),NLPopupAutoSuggest_hidePopupSuggestion();if(this.bUbersearch)this.fieldvalue.indexOf("::")>0||this.fieldvalue.indexOf("^")>0?nlOpenWindow(n,"uberres2"):(document.location=n,this.inputfield.value="");else{var s=getFormElement(this.inputfield.form,this.fieldname);if(s!=null){var o=r.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">"),u=getFormElement(this.inputfield.form,this.fieldname_hidden);if(this.bmultiselect)this.addMultipleSelectValue(n,o),s.haschanged=!0,s.isvalid=!0,u.onchange&&u.onchange();else{s.value=o;var a=u.value;u.value=n,u.onchange&&(u.onchange()==0?(u.value=a,s.value=s.getAttribute("previousvalue")):(s.haschanged=!0,s.isvalid=!0,s.setAttribute("previousvalue",s.value),NS&&NS.form&&NS.form.setValid(!0)))}NLPopupSelect_removeLoadingMessage()}}};function NLPopupAutoSuggest_makePopupSuggestion(e,t,n,r){popupAutoSuggest==null&&(popupAutoSuggest=new NLPopupAutoSuggest),popupAutoSuggest.setAttributes(e,t,n,r),clearTimeout(popupsuggesttimer),popupsuggesttimer=setTimeout("popupAutoSuggest.constructSuggestionBox()",popupAutoSuggest.bUbersearch?250:200)}function autoSuggestOnMouseMove(e){if(popupAutoSuggest!=null){var t=findClassUp(getEventTarget(e),"autosuggcell text");t!=null&&popupAutoSuggest.selectCell(t)}}function NLPopupAutoSuggest_onMouseDown(e){if(popupAutoSuggest!=null){clearTimeout(popupsuggesttimer);if(popupAutoSuggest.visible){var t=findClassUp(getEventTarget(e),"popupsuggest");t==null&&popupAutoSuggest.hideSuggestionBox()}}}function NLPopupAutoSuggest_onKeyDown(e){try{if(popupAutoSuggest!=null&&popupAutoSuggest.visible){var t=getEventKeypress(e);t==40?popupAutoSuggest.selectNextCell():t==38?popupAutoSuggest.selectPreviousCell():(t==13||t==9)&&popupAutoSuggest.currentcell>=0&&(popupAutoSuggest.bUbersearch?popupAutoSuggest.doUberSearchClick():popupAutoSuggest.getCell(popupAutoSuggest.currentcell).onmousedown())}}catch(n){console&&console.log(n.message)}}function NLPopupAutoSuggest_ignoreKeyStrokes(e){if(popupAutoSuggest!=null&&popupAutoSuggest.visible){var t=getEventKeypress(e);if(t==40||t==38||popupAutoSuggest.currentcell>=0&&(t==13||t==9))return!0}return!1}function NLPopupAutoSuggest_isMultiSelect(e){return e.getAttribute("bmultiautosuggest")=="T"}function NLPopupAutoSuggest_handleKeyStroke(e,t,n,r,i){var s=NLPopupAutoSuggest_isMultiSelect(e)?getCurrentMultiSelectUserInputValue(e):e.value,o=getEventKeypress(n);if(o==37||o==39||o==16)return!1;var u=trim(s),a=u.length,f=t=="uberautosuggest";if(f){var l=u.indexOf(":");l>0&&(a-=l+1)}a<=2&&u.charCodeAt(0)<2048&&(s!="%"||f)||o==13||o==9?NLPopupAutoSuggest_hidePopupSuggestion():NLPopupAutoSuggest_makePopupSuggestion(e,t,r,i)}function NLPopupAutoSuggest_hidePopupSuggestion(){clearTimeout(popupsuggesttimer),popupAutoSuggest!=null&&popupAutoSuggest.hideSuggestionBox()}function NLPopupSelect_runMoreSearch(fieldname,sValue){eval("Search"+fieldname+'("'+sValue+'")')}function NLPopupSelect_positionDIV(){var BORDER_SPACE=75,div=window.popupDIV,bListOnly=div.getAttribute("bListOnly")=="T",bActualMultiSelect=div.getAttribute("bMultiselect")=="T"&&!bListOnly,bIsMultiButton=div.getAttribute("bIsMultiButton")=="T",btn=div.getAttribute("displayField")!=null?NLPopupSelect_getDisplayField(div.getAttribute("displayField")):NLPopupSelect_getLaunchButton(div.getAttribute("launchbutton"),bIsMultiButton,bListOnly),x,y;if(div.getAttribute("bPositionWithMachine")=="T"&&div.getAttribute("machineName")!=null)try{var table=eval(div.getAttribute("machineName")+"_machine.tableobj;"),machine=table.machine,column=0;for(var i=0;i<machine.countFormElements();i++){var elem=machine.getFormElement(i);if(elem!=null&&(elem.name==window.popupDIV.getAttribute("fieldName")||elem.name==window.popupDIV.getAttribute("fieldName")+"_display"))break;elem.type!="hidden"&&machine.getFormElementLabel(i)!=null&&column++}var cell=table.rows[machine.currentRowNum].cells[column];x=findAbsolutePosX(cell),y=findAbsolutePosY(cell)+5}catch(err){x=btn==null?Math.max(lastX,10):findAbsolutePosX(btn)+(bIsMultiButton?1:0),y=btn==null?Math.max(lastY,10):findAbsolutePosY(btn)+(bIsMultiButton?1:0)}else x=btn==null?Math.max(lastX,10):findAbsolutePosX(btn)+(bIsMultiButton?1:0),y=btn==null?Math.max(lastY,10):findAbsolutePosY(btn)+(bIsMultiButton?1:0);var scrollTopOffset=0,scrollLeftOffset=0;if(btn!=null){var scrollDiv=findClassUp(btn,"scrollarea");scrollDiv!=null&&(scrollTopOffset=scrollDiv.scrollTop,scrollLeftOffset=scrollDiv.scrollLeft)}var fx=x-scrollLeftOffset,fy=y+15-scrollTopOffset,iDocHeight=getDocumentHeight(),iDocWidth=getDocumentWidth()-BORDER_SPACE;window.opener&&(iDocHeight<=250||iDocWidth<=510)&&(window.resizeTo(Math.max(600,iDocWidth),Math.max(350,iDocHeight)),iDocHeight=getDocumentHeight(),iDocWidth=getDocumentWidth()-BORDER_SPACE);var innerDiv=document.getElementById("inner_popup_div"),innerDivSelectList=document.getElementById("popup_select_list"),innerTable=innerDiv.firstChild,iDivHeight=parseInt(div.offsetHeight),iMaxDivHeight=325;if(iDivHeight>iMaxDivHeight||iDivHeight>=iDocHeight){var surroundElementsHeight=iDivHeight-innerDiv.offsetHeight+25,InnerListDefaultHeight=350,iSelectListHeight=Math.min(InnerListDefaultHeight,Math.abs(iDocHeight-surroundElementsHeight));innerDiv.style.height=iSelectListHeight+"px",bActualMultiSelect&&(innerDivSelectList.style.height=iSelectListHeight+"px")}iDivHeight=parseInt(div.offsetHeight);var bMultiColumn=innerTable.rows[0].cells.length>2;if(bMultiColumn)if(bActualMultiSelect){var listWidth=600,selectionWidth=250;if(iDocWidth<listWidth+selectionWidth){var wFactor=Math.floor(iDocWidth/3);listWidth=2*wFactor,selectionWidth=wFactor}innerDiv.style.width=listWidth+"px",document.getElementById("lower_header_label").style.width=listWidth+"px",innerDivSelectList.style.width=selectionWidth+"px"}else innerDiv.style.width=Math.min(650,iDocWidth)+"px";else if(bActualMultiSelect){var listWidth=Math.floor(Math.min(600,Math.floor(iDocWidth))/2);innerDiv.style.width=listWidth+"px",innerDivSelectList.style.width=listWidth+"px"}else div.style.width=Math.min(350,iDocWidth)+"px";var iDivWidth=parseInt(div.offsetWidth);fy+iDivHeight>iDocHeight&&(y-scrollTopOffset-document.body.scrollTop-iDivHeight>0?fy=y-scrollTopOffset-iDivHeight+1:fy=parseInt((iDocHeight-iDivHeight)/2)+document.body.scrollTop,div.getAttribute("bPositionWithMachine")=="T"&&(fy-=5)),fx+iDivWidth>iDocWidth&&(fx=getDocumentWidth()-iDivWidth),fx+iDivWidth>iDocWidth&&(fx=getDocumentWidth()-iDivWidth-40),fx<document.body.scrollLeft&&(fx=document.body.scrollLeft),NLPopupSelect_removeLoadingMessage(),div.style.left=fx+"px",div.style.top=fy+"px"}function NLPopupSelect_isLoadingOrSearching(){return window.popupDIV!=null||window.popupDivLoadingMessage!=null&&document.getElementById(window.popupDivLoadingMessage.id)!=null}function NLPopupSelect_removeLoadingMessage(){window.popupDivLoadingMessage!=null&&document.getElementById(window.popupDivLoadingMessage.id)!=null&&document.body.removeChild(window.popupDivLoadingMessage),NLPopupAutoSuggest_hidePopupSuggestion()}function NLPopupSelect_init(e,t,n,r,i){NLPopupSelect_close();var s=document.createElement("DIV");s.style.zIndex=1e3,s.id="popup_outerdiv",s.className="popupouter",s.setAttribute("bIsMultiButton",t?"T":"F"),s.setAttribute("bListOnly",n?"T":"F"),s.setAttribute("bMultiselect",e?"T":"F"),s.setAttribute("bPositionWithMachine",r?"T":"F"),s.setAttribute("bShowQuantities",i?"T":"F"),document.body.appendChild(s),window.popupDIV=s,isIE&&(window.addEventListener?window.addEventListener("onresize",new Function("NLPopupSelect_reposition();")):window.attachEvent("onresize",new Function("NLPopupSelect_reposition();")))}function NLPopupSelect_reposition(){window.popupDIV!=null&&NLPopupSelect_positionDIV()}function NLPopupSelect_open(e,t){if(window.popupDIV!=null){var n=window.popupDIV.getAttribute("bIsMultiButton")=="T",r=window.popupDIV.getAttribute("bListOnly")=="T",i=window.popupDIV.getAttribute("bMultiselect")=="T";window.popupDIV.setAttribute("fieldName",e),t!=null&&window.popupDIV.setAttribute("machineName",t);var s=e+(r?"_popup_listonly":n?"_popup_multi":"_popup_list"),o=NLPopupSelect_getLaunchButton(s,n,r);o!=null&&o.nodeName=="IMG"&&window.popupDIV.setAttribute("launchbutton",s),i&&typeof top.popupAnchorId!="undefined"&&top.popupAnchorId!=null&&document.getElementById(top.popupAnchorId)!=null&&window.popupDIV.setAttribute("displayField",top.popupAnchorId),!i&&document.getElementById(e+"_display")!=null&&window.popupDIV.setAttribute("displayField",e+"_display"),NLPopupSelect_positionDIV(),window.popup_onClickHandler=NLPopupSelect_onClick,isIE&&nlInsertCanvas(window.popupDIV)}}function NLPopupSelect_getLaunchButton(e,t,n){var r=document.getElementById(e);return r!=null&&!t&&!n&&(r=r.firstChild),r}function NLPopupSelect_getDisplayField(e,t){var n=t?t:document;return n.getElementById(e)}function NLPopupSelect_getDisplayFieldByValueInput(e){var t=e.name+"_display",n=getFormElement(e.form,t);return n||(n=NLPopupSelect_getDisplayField(t,e.ownerDocument)),n}function NLPopupSelect_displayLoadingDiv(e,t,n){if(window.popupDivLoadingMessage==null){var r=document.createElement("DIV");r.id="popup_load_message",r.style.backgroundColor="white",r.style.position="absolute",r.style.borderWidth="1px",r.style.borderStyle="solid",r.style.borderColor="black",r.style.width="150px",window.popupDivLoadingMessage=r}var i=n==null?"Loading":n;window.popupDivLoadingMessage.innerHTML="<table width='100%'><tr><td valign='middle' class='texttablectr'>"+i+"</td></tr></table>",document.body.appendChild(window.popupDivLoadingMessage);var s=document.getElementById(e+"_display"),o=0,u=0,a=findClassUp(s,"scrollarea"),f=0,l=0;a!=null&&(f=a.scrollTop,l=a.scrollLeft),s!=null&&!t?(o=findAbsolutePosY(s)+s.offsetHeight-1-f,u=findAbsolutePosX(s)-l,window.popupDivLoadingMessage.style.width=Math.max(75,s.offsetWidth)+"px"):(o=Math.max(lastY,10)+document.body.scrollTop,u=Math.max(lastX,10)+document.body.scrollLeft),o+30>getDocumentHeight()+document.body.scrollTop-10&&(o=getDocumentHeight()+document.body.scrollTop-30),u+150>getDocumentWidth()+document.body.scrollLeft-10&&(u=getDocumentWidth()+document.body.scrollLeft-175),window.popupDivLoadingMessage.style.left=u+"px",window.popupDivLoadingMessage.style.top=o+"px",window.popupDivLoadingMessage.style.zIndex=10}function NLPopupSelect_onClick(e){}function NLPopupSelect_close(e){var t=window;while((t.popupDIV==null||typeof t.popupDIV=="undefined")&&t!=window.parent)t=window.parent;var n=t.popupDIV;if(t.popupDIV==null||typeof t.popupDIV=="undefined")return;isIE&&nlRemoveCanvas(n);if(n.getAttribute("launchbutton")!=null&&n.getAttribute("bIsMultiButton")=="F")var r=NLPopupSelect_getLaunchButton(n.getAttribute("launchbutton"),n.getAttribute("bIsMultiButton")=="T",n.getAttribute("bListOnly")=="T");jQuery("#"+n.id).remove();if(e){var i=t.document.getElementById(n.getAttribute("fieldName")+"_display");i!=null&&NLPopupSelect_focusNextInputField(i.name,i.form,!0)}t.popupDIV=null}function NLPopupSelect_getElementOrFromParent(e){var t=document.getElementById(e);return t==null&&(t=parent.document.getElementById(e)),t}function NLPopupSelect_addSelection(e,t){var n=NLPopupSelect_getElementOrFromParent("popup_select_list"),r=n.firstChild;NLPopupSelect_addSelectionRow(e,t,r,n)}function NLPopupSelect_addSelectionRow(e,t,n,r){var i=window.popupDIV.getAttribute("bShowQuantities")=="T",s=document.createElement("tr");s.className="multiselecttr";var o=document.createElement("td");o.className="text",o.style.width="14px",o.style.whitespace="nowrap",o.style.verticalAlign=i?"top":"middle",o.style.align="right";var u=document.createElement("a");u.href="javascript:void(0)",e=e.replace(/'/g,"\\'"),u.onclick=new Function("NLPopupSelect_updateSelection('"+e+"','', false, this); return false;");var a=document.createElement("img");a.className="uir-popup-x-icon",a.border="0",a.height=13,a.width=13,a.src="/images/x.gif",u.appendChild(a),o.appendChild(u),s.appendChild(o),o=document.createElement("td"),o.className="text",i&&(o.style.verticalAlign="top");var f=null;if(window.popupDIV.getAttribute("bShowQuantities")=="T"){var l=NLPopupSelect_getQuantityArray(t);l!=null&&(t=l[0],f=l[1])}o.innerHTML=t,s.appendChild(o);if(window.popupDIV.getAttribute("bShowQuantities")=="T"){var c=document.createElement("td");c.className="text",c.style.whitespace="nowrap",c.style.verticalAlign="top",c.style.align="right",c.innerHTML="<input class=input type=text name='quantity_"+e+"' size=4 value='"+(f!=null?f:"")+"' onChange='NLPopupSelect_updateQuantity(\""+e+"\",this.value)'>",s.appendChild(c)}return n.rows.length==(i?2:1)&&n.rows[i?1:0].className=="noselections"&&n.deleteRow(i?1:0),n.firstChild.appendChild(s),r!=null&&r.scrollHeight>r.offsetHeight&&(r.scrollTop=r.scrollHeight-r.offsetHeight),s}function NLPopupSelect_getQuantityArray(e){var t=new RegExp("^\\s*(\\S+)\\s*\\(\\s*(-?\\d+\\.?\\d*)\\s*\\)\\s*$"),n=t.exec(e);return n!=null?new Array(n[1],n[2]):new Array(e,"")}function NLPopupSelect_getQuantityText(e,t){return t=NLStringToNumber(t),isNaN(t)?e:e+"("+t+")"}function NLPopupSelect_updateQuantity(e,t){var n=NLPopupSelect_getElementOrFromParent("multisel_complete"),r=n.elements._mdata,i=n.elements._mlabels,s=trim(r.value),o=trim(i.value),u=s.split(String.fromCharCode(5)),a=o.split(String.fromCharCode(5)),f=!1;for(var l=0;l<u.length;l++){var c=NLPopupSelect_getQuantityArray(u[l]);c[0]==e&&(f=!0,u[l]=NLPopupSelect_getQuantityText(e,t),a[l]=u[l])}f&&(r.value=u.join(String.fromCharCode(5)),i.value=a.join(String.fromCharCode(5)))}var nlpopupselect_removerow=null;function NLPopupSelect_removeSelection(e,t){var n=NLPopupSelect_getElementOrFromParent("popup_select_list").firstChild,r=findClassUp(t,"multiselecttr");nlpopupselect_removerow=r,setTimeout("NLPopupSelect_removeRowAfterTimeout()",1)}function NLPopupSelect_removeRowAfterTimeout(){var e=nlpopupselect_removerow.parentNode.parentNode;nlpopupselect_removerow.parentNode.deleteRow(nlpopupselect_removerow.rowIndex),NLPopupSelect_insertNoSelectionRow(e.firstChild),nlpopupselect_removerow=null}function NLPopupSelect_insertNoSelectionRow(e){var t=window.popupDIV.getAttribute("bShowQuantities")=="T",n=e.rows.length==(t?1:0);if(n){var r=document.createElement("tr"),i=document.createElement("td");r.className="noselections",i.className="textctr",i.innerHTML="No Selections Made",t&&(i.colSpan=3),r.appendChild(i),e.appendChild(r);var s=NLPopupSelect_getElementOrFromParent("multisel_complete");s.elements._mdata.value="",s.elements._mlabels.value=""}}function NLPopupSelect_updateSelection(e,t,n,r){var s=NLPopupSelect_getElementOrFromParent("multisel_complete"),o=s.elements._mdata,u=s.elements._mlabels,a=trim(o.value),f=trim(u.value),l,c;isValEmpty(a)?(l=new Array,c=new Array):(l=a.split(String.fromCharCode(5)),c=f.split(String.fromCharCode(5)));var h=!1;if(n){var p=!0;for(i=0;i<l.length;i++){var d=null,v=l[i].indexOf("(");v>0?d=l[i].substring(0,v):d=l[i];if(d==e){p=!1;break}}var m=typeof NLPopupSelect_canAddSelection=="undefined"||NLPopupSelect_canAddSelection==null?!0:NLPopupSelect_canAddSelection(e,t,l);p&&m&&(a==""?(u.value=t,o.value=e):(o.value+=String.fromCharCode(5)+e,u.value+=String.fromCharCode(5)+t),h=!0,NLPopupSelect_addSelection(e,t))}else{var g=window.popupDIV.getAttribute("bShowQuantities")=="T";h=!0;var y=0;o.value="",u.value="";for(i=0;i<l.length;i++){if(l[i]==e||g&&NLPopupSelect_getQuantityArray(l[i])[0]==e){NLPopupSelect_removeSelection(e,r);continue}o.value+=(y==0?"":String.fromCharCode(5))+l[i],u.value+=(y==0?"":String.fromCharCode(5))+c[i],y++}}}function NLPopupSelect_focusNextInputField(e,t,n){try{if(e==null||t==null)return;var r=!1;for(var i=0;i<t.elements.length;i++){if(!r){t.elements[i].name==e&&(r=!0);continue}var s=t.elements[i];if(isFocusable(s)){isNLDropDown(s)?setSelectFocus(s):s.focus&&s.focus(),n&&s.select&&s.select();return}}}catch(o){}}function setSafeBlurValue(e,t){var n="document.getElementById('"+e+"').value='"+t+"'";setTimeout(n,0)}function setButtonDown(e,t,n){var r=n.parentNode.parentNode;e?r.className.indexOf("_sel")==-1&&(r.className=r.className.split(" ").join("_sel ")+"_sel"):r.className=r.className.replace(/_sel/g,"")}function onTristateClick(e){setTristate(e,e.nextSibling.value+1)}function onTristateHighlight(e,t){var n=e.nextSibling;return e.src="/images/icons/controls/checkbox_"+(n.value&3)+(t?"_hl.gif":".gif"),!0}function setTristate(e,t){var n=e.nextSibling;return n.value=4|t%3,e.src="/images/icons/controls/checkbox_"+(n.value&3)+".gif",!0}function disableLineRefresh(e){e.disabled=!0,e.firstChild.src="/images/icons/dashboard/refresh_line_disabled.gif"}function doNewbarAction(e){var t=document.getElementById(e);t!=null&&t.onclick&&t.onclick()}function nlQuickLooksPopup(e){var t="/images/guide/quicklooks.html?"+e,n=window.open(t,"popupguide","toolbar=no,statusbar=no,menubar=no,resizable=no,left=1,top=1,height=700,width=300");n.focus()}var Class={create:function(){return function(){this.initialize.apply(this,arguments)}}};NLProgressBar=Class.create(),NLProgressBar.prototype={initialize:function(e){this.hndDialogDiv=null,this.sId=e||"NLProgressBar"},show:function(e){var t=jQuery(document).width()/2,n=jQuery(document).height()/2;if(!this.hndDialogDiv){this.hndDialogDiv=document.createElement("div");var r='<table style="font-size:70%;" cellpadding=0 cellspacing=0 border=0 width=350>    <tr>        <td colspan=3><IMG SRC="/images/icons/progress/progress_waitBar_top.gif" ALT="" WIDTH=350 HEIGHT=10 BORDER=0></td>    </tr>    <tr>        <td background="/images/icons/progress/progress_waitBar_l.gif"><IMG SRC="/images/icons/progress/progress_x.gif" ALT="" WIDTH=4 HEIGHT=1 BORDER=0></td>        <td bgcolor="#F1F1F1" align=center>            <IMG SRC="/images/icons/progress/progress_x.gif" ALT="" WIDTH=342 HEIGHT=4 BORDER=0><br>            <table cellpadding=0 cellspacing=0 border=0>                <tr><td colspan=2  style="font-size:70%;">'+e+'</td></tr>                <tr><td colspan=2><IMG SRC="/images/icons/progress/progress_x.gif" ALT="" WIDTH=1 HEIGHT=3 BORDER=0></td></tr>                <tr>                    <td align=center><IMG SRC="/images/icons/progress/progress_waitBar.gif" ALT="" WIDTH=249 HEIGHT=20 BORDER=0></td>                    <td>&nbsp;</td>                </tr>                <tr><td colspan=2><IMG SRC="/images/icons/progress/progress_x.gif" ALT="" WIDTH=1 HEIGHT=10 BORDER=0></td></tr>            </table>        </td>        <td background="/images/icons/progress/progress_waitBar_r.gif"><IMG SRC="/images/icons/progress/progress_x.gif" ALT="" WIDTH=4 HEIGHT=1 BORDER=0></td>    </tr>    <tr>        <td background="/images/icons/progress/progress_waitBar_l.gif"><IMG SRC="/images/icons/progress/progress_x.gif" ALT="" WIDTH=4 HEIGHT=1 BORDER=0></td>        <td bgcolor="#F1F1F1" align=center>            <IMG SRC="/images/icons/progress/progress_x.gif" ALT="" WIDTH=342 HEIGHT=10 BORDER=0><br>        </td>        <td background="/images/icons/progress/progress_waitBar_r.gif"><IMG SRC="/images/icons/progress/progress_x.gif" ALT="" WIDTH=4 HEIGHT=1 BORDER=0></td>    </tr>    <tr>        <td colspan=3><IMG SRC="/images/icons/progress/progress_waitBar_bot.gif" ALT="" WIDTH=350 HEIGHT=10 BORDER=0></td>    </tr></table>';this.hndDialogDiv.innerHTML=r,this.hndDialogDiv.style.display="none",this.hndDialogDiv.style.zIndex="1000",this.hndDialogDiv.style.position="absolute",document.body.appendChild(this.hndDialogDiv)}if(this.hndDialogDiv.style.display=="block")return;this.hndDialogDiv.style.display="block",this.hndDialogDiv.style.top=n-this.hndDialogDiv.clientHeight/2+"px",this.hndDialogDiv.style.left=t-this.hndDialogDiv.clientWidth/2+"px"},hide:function(){this.hndDialogDiv!=null&&(this.hndDialogDiv.style.display="none")}};function getIFrameDocument(e){var t=null;return document.getElementById(e).contentDocument?t=document.getElementById(e).contentDocument:t=document.frames[e].document,t}function getIFrameWindow(e){var t=null;return document.getElementById(e).contentWindow?t=document.getElementById(e).contentWindow:t=document.frames[e].window,t}function notifyPortlet(e,t){e=="-10018"&&window.schedulersef!="undefiined"&&window.schedulersef!=null&&(t==EVENT_PORTLET_MIN?window.schedulersef.handlePortletMin():t==EVENT_PORTLET_MAX?window.schedulersef.handlePortletMax():t==EVENT_PORTLET_MOVE?window.schedulersef.handlePortletMove():t==EVENT_PORTLET_DROP?window.schedulersef.handlePortletDrop():t==EVENT_PORTLET_DRAG&&window.schedulersef.handlePortletDrag())}function setImageButtonState(e,t,n,r){var i=document;typeof r!="undefined"&&r!=null&&(i=r.document);var s=i.getElementById(e);if(s==null)return;s.disabled=!t;if(typeof n=="undefined"&&n==null)return;s=s.getElementsByTagName("img")[0],s&&(s.src=n)}function setMultiButtonState(e,t){var n=getNLMultiButtonByName(e);n!=null&&n.setState(t)}function setLabelState(e,t,n){var r=document;typeof n!="undefined"&&n!=null&&(r=n.document);var i=r.getElementById(e);if(i==null)return;i.className=t}function setNewbarGif(e){var t=document.getElementById("img_newbar_more");t!=null&&(e?t.className="ri_personalize":t.className="ri_personalize_hover")}var allSpinners=new Array,spinnerCounter=0,NLSpinner=Class.create();NLSpinner.prototype={initialize:function(e,t,n,r,i){this.sTagName=e,this.currentValue=t,this.step=n,this.lowerBound=parseFloat(r),this.upperBound=parseFloat(i),this.interval=parseInt(500),this.repeatInterval=parseInt(200),this.timer=null,this.direction=1},_step:function(){if(this.direction>=0)var e=parseFloat(parseFloat($(this.sTagName).value)+parseFloat(this.step));else var e=parseFloat(parseFloat($(this.sTagName).value)-parseFloat(this.step));e>this.upperBound?e=this.upperBound:e<this.lowerBound&&(e=this.lowerBound),$(this.sTagName).value=parseFloat(e)},_mousedown:function(e){this._step();var t=this._mousedown.bind(this,"F");this.timer=setTimeout(t,e=="T"?this.interval:this.repeatInterval)},_releasemouse:function(){this.timer&&(clearTimeout(this.timer),this.timer=null,$(this.sTagName).onchange()),this.direction>=0?$(this.sTagName+"_rarrow").setAttribute("src","/images/forms/rarrow.gif"):$(this.sTagName+"_larrow").setAttribute("src","/images/forms/larrow.gif")},_scrollUp:function(){this.direction=1,$(this.sTagName+"_rarrow").setAttribute("src","/images/forms/rarrow_down.gif"),this._mousedown("T")},_scrollDown:function(){this.direction=-1,$(this.sTagName+"_larrow").setAttribute("src","/images/forms/larrow_down.gif"),this._mousedown("T")}};function makeSpinner(e,t,n,r,i){var s=new NLSpinner(e,t,n,r,i);$(e).value=t;var o=document.createElement("img");o.setAttribute("id",e+"_larrow"),o.setAttribute("src","/images/forms/larrow.gif"),$(e+"_fs").appendChild(o),$(e+"_larrow").onmousedown=function(){s._scrollDown()},$(e+"_larrow").onmouseup=function(){s._releasemouse()},$(e+"_larrow").onmouseout=function(){s._releasemouse()};var u=document.createElement("img");u.setAttribute("id",e+"_rarrow"),u.setAttribute("src","/images/forms/rarrow.gif"),$(e+"_fs").appendChild(u),$(e+"_rarrow").onmousedown=function(){s._scrollUp()},$(e+"_rarrow").onmouseup=function(){s._releasemouse()},$(e+"_rarrow").onmouseout=function(){s._releasemouse()},spinnerCounter++;var a=e+spinnerCounter;return window.allSpinners[a]==null&&(window.allSpinners[a]=s),s}function NLDragDrop(e,t,n){this.doc=n?n:document,this.sourceElem=e,this.listener=t,this.eventSource=null,this.bInitDrag=!0,window.loadcomplete?this.attachEventHandlers(e):attachEventHandler("load",window,function(e){this.attachEventHandlers()}.bind(this))}NLDragDrop.prototype.attachEventHandlers=function(){typeof this.sourceElem=="string"&&(this.sourceElem=doc.getElementById(sourceElem));if(!this.sourceElem)return;attachEventHandler("mousedown",this.sourceElem,function(e){this.handleMouseDown(e)}.bind(this)),attachEventHandler("mousemove",this.doc,function(e){this.handleMouseMove(e)}.bind(this)),attachEventHandler("mouseup",this.doc,function(e){this.handleMouseUp(e)}.bind(this))},NLDragDrop.prototype.handleMouseDown=function(t){var t=getEvent(t);this.eventSource=getEvent(t);if(!this.onMouseDown(t))return!0;var t=getEvent(t);return this.mouseDown=!0,!0},NLDragDrop.prototype.handleMouseMove=function(t){if(!this.mouseDown)return!0;var t=getEvent(t),n=!0;return this.bInitDrag&&(n=this.onInitMouseMove(t)),n?(this.bInitDrag=!1,this.onMouseMove(t),t.cancelBubble=!0,t.returnValue=!1,!1):(this.clear(),t.cancelBubble=!0,t.returnValue=!1,!1)},NLDragDrop.prototype.handleMouseUp=function(t){if(!this.mouseDown)return!0;var t=getEvent(t);return this.onMouseUp(t),this.clear(),t.cancelBubble=!0,t.returnValue=!1,!1},NLDragDrop.prototype.clear=function(){this.mouseDown=!1,this.eventSource=null,this.bInitDrag=!0},NLDragDrop.prototype.onMouseDown=function(t){return this.listener&&this.listener.onMouseDown?this.listener.onMouseDown(t):!0},NLDragDrop.prototype.onInitMouseMove=function(t){return this.listener&&this.listener.onInitMouseMove?this.listener.onInitMouseMove(t):!0},NLDragDrop.prototype.onMouseMove=function(t){return this.listener&&this.listener.onMouseMove?this.listener.onMouseMove(t):!0},NLDragDrop.prototype.onMouseUp=function(t){return this.listener&&this.listener.onMouseUp?this.listener.onMouseUp(t):!0};var NLDRAG_LEFT=1,NLDRAG_RIGHT=2,NLDRAG_LEFT_RIGHT=3,NLDRAG_UP=4,NLDRAG_DOWN=8,NLDRAG_UP_DOWN=12;function NLAttachSimpleColumnResizer(e,t,n,r,i,s,o){return new NLSimpleColumnResizer(e,t,n,r,i,s,o)}function NLSimpleColumnResizer(e,t,n,r,i,s,o){o=o?o:document,this.triggerElem=typeof e=="string"?o.getElementById(e):e,this.targetElem=typeof t=="string"?o.getElementById(t):t,new NLDragDrop(this.triggerElem,this,o),this.direction=n==NLDRAG_UP_DOWN?NLDRAG_UP_DOWN:NLDRAG_LEFT_RIGHT,this.min=r>=0?r:0,this.max=i>=0&&i>r?i:Number.MAX_VALUE,this.listener=s,this.initVal=null,this.sCursor=this.direction==NLDRAG_UP_DOWN?"n-resize":"w-resize",this.setCursor(this.sCursor,this.triggerElem)}NLSimpleColumnResizer.prototype.getValue=function(t){return this.direction==NLDRAG_LEFT_RIGHT?getMouseX(t):this.direction==NLDRAG_UP_DOWN?getMouseY(t):null},NLSimpleColumnResizer.prototype.onMouseDown=function(t){var n=getEventTarget(t);return contains(this.triggerElem,n)?(this.initVal=this.getValue(t),this.canResize(t)?!0:!1):!1},NLSimpleColumnResizer.prototype.onInitMouseMove=function(t){var t=getEvent(t);return this.listener&&this.listener.onStartResize?this.dragDiv=this.listener.onStartResize(t,this):this.startResize(t,this),!0},NLSimpleColumnResizer.prototype.onMouseMove=function(t){var t=getEvent(t);return this.canResize(t)?(this.listener&&this.listener.onResize?this.listener.onResize(t,this):this.resize(t),!0):!1},NLSimpleColumnResizer.prototype.onMouseUp=function(t){var t=getEvent(t);this.listener&&this.listener.onEndResize?this.listener.onEndResize(t,this):this.endResize(t),this.resetCursor()},NLSimpleColumnResizer.prototype.canResize=function(t){if(this.listener&&this.listener.onCanResize)return this.listener.onCanResize(t,this);var n=this.getValue(t)-this.initVal,r=this.direction==NLDRAG_LEFT_RIGHT?this.targetElem.offsetWidth:this.targetElem.offsetHeight,i=r+n;return i>=this.min&&i<=this.max?!0:i<this.min&&n>0?!0:i>this.max&&n<0?!0:!1},NLSimpleColumnResizer.prototype.startResize=function(t){this.setCursor(this.sCursor),this.showDragDiv(t)},NLSimpleColumnResizer.prototype.resize=function(t){this.positionDragDiv(t)},NLSimpleColumnResizer.prototype.endResize=function(t){var n=null;this.direction==NLDRAG_LEFT_RIGHT?n=this.targetElem.offsetWidth+this.getValue(t)-this.initVal:n=this.targetElem.offsetHeight+this.getValue(t)-this.initVal,n>this.max?n=this.max:n<this.min&&(n=this.min),this.direction==NLDRAG_LEFT_RIGHT?this.targetElem.style.width=n+"px":this.targetElem.style.height=n+"px",this.cleanUp()},NLSimpleColumnResizer.prototype.showDragDiv=function(t){if(this.dragDiv==null){this.dragDiv=document.createElement("div"),this.dragDiv.style.position="absolute";var n=document.createElement("img");n.src="/images/nav/stretch.gif",n.width="3",this.dragDiv.appendChild(n),this.dragDiv.style.backgroundColor="#999999",setObjectOpacity(80,this.dragDiv),document.body.appendChild(this.dragDiv)}this.direction==NLDRAG_LEFT_RIGHT?(this.dragDiv.style.top=findPosY(this.targetElem)+"px",this.dragDiv.firstChild.height=this.targetElem.offsetHeight):(this.dragDiv.style.left=findPosX(this.targetElem)+"px",this.dragDiv.firstChild.width=this.targetElem.offsetWidth),this.dragDiv.style.display="",this.positionDragDiv(t)},NLSimpleColumnResizer.prototype.cleanUp=function(){this.hideDragDiv(),this.initVal=null},NLSimpleColumnResizer.prototype.hideDragDiv=function(){this.dragDiv.style.display="none"},NLSimpleColumnResizer.prototype.positionDragDiv=function(t){var n=this.getValue(t);this.direction==NLDRAG_LEFT_RIGHT?this.dragDiv.style.left=n+"px":this.dragDiv.style.top=n+"px"},NLSimpleColumnResizer.prototype.setCursor=function(t,n){n||(n=document.body),n.origCursor||(n.origCursor=n.style.cursor),n.style.cursor=t},NLSimpleColumnResizer.prototype.resetCursor=function(t){t||(t=document.body),t.origCursor&&t.origCursor.length>0?(t.style.cursor="default",t.origCursor=null):t.style.cursor="default"};function closeBanner(e){var t=document.getElementById(e);t&&(t.parentNode.removeChild(t),sendRequestToFrame("/core/pages/uibannerpref.nl?prefValue=F&prefName=SHOWCHILESUEBANNER","server_commands"))}window.NETSUITE_IS_LOADED=!0};