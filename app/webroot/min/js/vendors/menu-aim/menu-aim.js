(function(){define(["jquery"],function(){(function(e){function t(t){var n=e(this),r=null,i=[],s=null,o=null,u=null,a=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop,exitTimeout:0,afterExitMenu:e.noop},t),f=3,l=300,c=function(e){i.push({x:e.pageX,y:e.pageY}),i.length>f&&i.shift()},h=function(){o&&clearTimeout(o),a.exitMenu(this)&&(u=setTimeout(function(){r&&a.deactivate(r),r=null,a.afterExitMenu()},a.exitTimeout))},p=function(){o&&clearTimeout(o),u&&clearTimeout(u),a.enter(this),g(this)},d=function(){a.exit(this)},v=function(){m(this)},m=function(e){if(e==r)return;r&&a.deactivate(r),a.activate(e),r=e},g=function(e){var t=y();t?o=setTimeout(function(){g(e)},t):m(e)},y=function(){function d(e,t){return(t.y-e.y)/(t.x-e.x)}if(!r||!e(r).is(a.submenuSelector))return 0;var t=n.offset(),o={x:t.left,y:t.top-a.tolerance},u={x:t.left+n.outerWidth(),y:o.y},f={x:t.left,y:t.top+n.outerHeight()+a.tolerance},c={x:t.left+n.outerWidth(),y:f.y},h=i[i.length-1],p=i[0];if(!h)return 0;p||(p=h);if(p.x<t.left||p.x>c.x||p.y<t.top||p.y>c.y)return 0;if(s&&h.x==s.x&&h.y==s.y)return 0;var v=u,m=c;a.submenuDirection=="left"?(v=f,m=o):a.submenuDirection=="below"?(v=c,m=f):a.submenuDirection=="above"&&(v=o,m=u);var g=d(h,v),y=d(h,m),b=d(p,v),w=d(p,m);return g<b&&y>w?(s=h,l):(s=null,0)};n.on("mouseleave.menuaim",h).find(a.rowSelector).on("mouseenter.menuaim",p).on("mouseleave.menuaim",d).on("click.menuaim",v),e(document).mousemove(c)}e.fn.menuAim=function(e){return this.each(function(){t.call(this,e)}),this}})(jQuery)})})();