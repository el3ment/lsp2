(function(){define(["utilities/global","controllers/application","plugins/reveal","vendors/menu-aim/menu-aim"],function(){var e=window.LSP.utilities;e.register("controller","flyout",function(){var t={},n=window.LSP,r,i,s,o=!1,u,a=!1,f=!1,o=!1,l=!1,c=!1,h=!1,p,d=n.controllers.reveal,v=150,m=500,g=250;return t={name:"flyout",events:{application:{onContextChangeLeavePhone:function(e,n){t.attachMenu()},onContextChangeEnterPhone:function(e,n){t.detachMenu()},onAfterReady:function(e,r){n.controllers.application.getContext()!=="phone"&&t.attachMenu(),document.location.href.indexOf("netsuite")>0&&t.closeFlyout(!0)}}},assets:{},attachMenu:function(){var e;i=$("#flyoutControlButton"),r=$("#mainFlyout"),s=$("#mainFlyout .topLevel"),d&&d.unbindEvents(s),s.menuAim({activate:t.showRow,deactivate:t.hideRow,exitTimeout:m,exitMenu:function(){return!0},afterExitMenu:function(){o=!1,f=a,clearTimeout(p)}});var n,u;i.off(".flyout").on("mouseenter.lsp.flyout",function(e){!o&&!c&&(u=setTimeout(t.openFlyout,g))}).on("mouseleave.lsp.flyout",function(e){clearTimeout(u)}).on("click.lsp.flyout",function(e){l=!o,c=!l,h=!0,t.toggleFlyout(),c&&setTimeout(function(){c=!1},800)}),$(".topLevel").off(".flyout").on("click.lsp.flyout",function(e){i.click(),e.stopPropagation()}),$(".topLevel li").off(".flyout").on("click.lsp.flyout",function(e){e.stopPropagation()}),$(".container",r).on("mouseenter.lsp.flyout",function(e){clearTimeout(n)}),$(".wrapper",r).on("mouseleave.lsp.flyout",function(e){h||(n=setTimeout(t.closeFlyout,m),clearTimeout(p)),h=!1,e.stopPropagation()}),$(this).triggerHandler("onAfterAttach",{selector:r})},detachMenu:function(){r&&(t.closeFlyout(),$("*",r).off(".menuaim"),i.off(".flyout"),$(".wrapper",r).off(".flyout")),d&&d.bindEvents(s)},openFlyout:function(t){a=t||!1,f=a,o=!0,r&&(r.addClass("active"),i.addClass("active"),e.scrollTo($(".collection:first-child",r)))},closeFlyout:function(e){r?(clearTimeout(p),o=!1,e&&(a=!1,f=!1),a||(r.removeClass("active"),i.removeClass("active"),$("li.collection.active",r).removeClass("active"),u&&$(u.elem).stop(!0,!0),u=null,o=!1)):n.controllers.reveal.close($("#mainFlyout, #mainFlyout *[data-reveal-children]"),!1)},toggleFlyout:function(){o?t.closeFlyout():t.openFlyout()},showRow:function(e,n){if(a&&f&&!n)clearTimeout(p),p=setTimeout(function(){t.showRow(e,!0)},g);else{e=$(e),f=!1;if(!o){var i=$(".flyout",e);if(u)$(u.elem).removeAttr("style"),$(i[0]).css({width:u.now,overflow:"hidden"}),u.elem=i[0];else{var s=i.outerWidth();i.css({width:0}).animate({width:s},{duration:v,easing:"swing",step:function(e,t){u=t},always:function(e){$(".flyout[style]",r).css({width:""}),u=null,o=!0}})}}e.addClass("active"),e.unveil&&$("*[data-src]",e).unveil()}},hideRow:function(e){$(e).removeClass("active")}},t}())})})();