(function(){define(["utilities/global","controllers/application"],function(){var e=window.LSP.utilities;e.register("controller","netsuite",function(){var t={},n=window.LSP;return t={events:{application:{onReady:function(e,n){t.attachEnterKey(),t.fixSignInUrlForRedirection(document),t.injectRedirectInput(),t.fixLogoutUrl(document)},onAttachEvents:function(e,n){t.fixSignInUrlForRedirection(n.selector)}},netsuite:{onInit:function(e,n){t.handlePostSignInRedirection()}}},assets:{},injectRedirectInput:function(){var t=e.getURLParameters();t.lsppassthrough&&document.forms.login&&$(document.forms.login).prepend('<input type="hidden" name="redirect" value="'+t.lsppassthrough+'">')},fixLogoutUrl:function(e){var t=($('[href*="logoff=T"]',e).attr("href")||"").replace("sc=4","sc=30");$('[href*="logoff=T"]',e).attr("href",t)},fixSignInUrlForRedirection:function(t){var n=document.location.href.indexOf("lsppassthrough=")===-1?encodeURIComponent(document.location.href):e.findBetween("lsppassthrough=","&",document.location.href);n.indexOf("login=T")===-1&&$('a[href*="login=T"]:not([href*="'+n+'"], [href*="logoff=T"])',t).each(function(e,t){var r=$(t);r.attr("href",r.attr("href")+"&lsppassthrough="+n)})},handlePostSignInRedirection:function(){if(parseInt($(".page-generic").data("uid"),10)>0){var t=e.getURLParameters();t.lspredirectto&&(document.location=t.lspredirectto)}},attachEnterKey:function(){$(".page-generic table table table input").off(".submitter").on("keyup.lsp.submitter",function(e){var t=$(this);switch(e.which){case 13:$(this).data("isDirty")&&($(this).parents().each(function(t,n){var r=$(n).find('#tbl_recalc *[type="submit"], #tbl_submitter *[onclick]')[0];if(r)return $(r).attr("onclick")?r.click():($('input[name="redirect"]').val(""),r.form.submit()),!1;e.stopPropagation()}),$(this).data("isDirty",!1));break;case 40:case 38:$(this).data("isDirty",!1);break;default:$(this).data("isDirty",!0)}}).data("isDirty",!0)}},t}())})})();